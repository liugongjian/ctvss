/*! GoldPlay built @8/5/2020, 5:42:19 PM */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.GoldPlay=e():t.GoldPlay=e()}(window,(function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=162)}([function(t,e){t.exports=function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}},function(t,e){t.exports=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}},function(t,e){function n(e){return t.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},n(e)}t.exports=n},function(t,e){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},function(t,e){function n(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}t.exports=function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}},function(t,e,n){var r=n(48);t.exports=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&r(t,e)}},function(t,e,n){var r=n(11),i=n(1);t.exports=function(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?i(t):e}},,function(t,e){t.exports=function(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}},function(t,e,n){"use strict";n.d(e,"c",(function(){return r})),n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return a})),n.d(e,"d",(function(){return o}));var r={projectName:"GOLDPLAY",projectAbbreviation:"GP",mode:"production",basePath:"./",get distPath(){var t="";return("development"==this.mode||"test"==this.mode)&&(t="/dist/"),t},get libPath(){return this.distPath+"lib/"},hideBarBoxTime:300,speedList:[{name:"0.5X",value:.5},{name:"1.0X",value:1},{name:"1.5X",value:1.5},{name:"2.0X",value:2},{name:"3.0X",value:3}]},i={maxDuration:30,maxSize:1024e6,maxRetryCount:3},a=1/9e4,o={READYBUFFERLENGTH:1e3,MAXBUFFERLENGTH:5e3}},function(t,e,n){"use strict";var r=n(3),i=n.n(r),a=n(4),o=n.n(a),s=n(0),u=n.n(s),l=n(9),c=console||{};function h(t,e){if(c[t]){if(this.disabled||this.level<0)return;if("production"===l.c.mode&&("error"!==t||"warn"!==t))return;if(1===this.level&&["info"].includes(t))return;if(2===this.level&&["log","info"].includes(t))return;if(this.level>2&&"error"!==t)return;for(var n=(new Date).toLocaleString(),r=arguments.length,i=new Array(r>2?r-2:0),a=2;a<r;a++)i[a-2]=arguments[a];var o=["[32m".concat(e,"[39m")].concat(i,[n]);"error"!==t&&"warn"!==t||(o=[e].concat(i,[n])),"function"==typeof c[t]&&c[t].apply(c,o)}}var f=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};i()(this,t),u()(this,"prefix",l.c.projectName),u()(this,"joiner",">"),u()(this,"left","["),u()(this,"right","]"),u()(this,"disabled",!1),u()(this,"level",0),Object.assign(this,n),"string"==typeof e?this.file=e:e&&e.constructor&&(this.file=e.constructor.name)}return o()(t,[{key:"setDisabled",value:function(t){this.disabled=t}},{key:"setLevel",value:function(t){this.level=t}}],[{key:"get",value:function(e,n){return new t(e,n)}}]),t}();["info","log","debug","warn","error"].forEach((function(t){f.prototype[t]=function(e,n){n=void 0===n?"":this.joiner+n;for(var r=this.left+e+n+this.right,i=this.left+this.prefix+" "+this.file+this.right+r,a=arguments.length,o=new Array(a>2?a-2:0),s=2;s<a;s++)o[s-2]=arguments[s];h.apply(this,[t,i].concat(o))}})),e.a=f},function(t,e){function n(e){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?t.exports=n=function(t){return typeof t}:t.exports=n=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(e)}t.exports=n},,,,,,,function(t,e,n){t.exports=n(73)},,,,,function(t,e,n){"use strict";n.d(e,"a",(function(){return f}));var r=n(3),i=n.n(r),a=n(4),o=n.n(a),s=n(0),u=n.n(s),l=n(9),c={eval:EvalError,range:RangeError,reference:ReferenceError,syntax:SyntaxError,type:TypeError,uri:URIError,default:Error},h=null,f=(h||(h=new(function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1001;return i()(this,t),u()(this,"type",""),u()(this,"errorName","DefaultError"),u()(this,"code",null),u()(this,"message",""),u()(this,"stack",""),this.type=e,this.code=n,this.throws.bind(this)}return o()(t,[{key:"throws",value:function(t){for(var e="",n=Error,r=arguments.length,i=new Array(r>1?r-1:0),a=1;a<r;a++)i[a-1]=arguments[a];if(t instanceof Error){for(var o in c)if(t instanceof c[o]){this.errorName=c[o].name,n=t.constructor;break}this.stack=t.stack,i&&i.splice&&(e=i[0],i.splice(0,1))}else e=t.toString();this.message="[".concat(l.c.projectName," ERROR:")+this.type+"-"+this.code+"]"+e;try{throw new n(this.message,"[args]:",i)}catch(t){this.stack=this.stack||t.stack,console.error(t,"[message]:",e,"[args]:",i)}}}]),t}())),h)},function(t,e){t.exports=function(t,e){var n=e.get(t);if(!n)throw new TypeError("attempted to get private field on non-instance");return n.get?n.get.call(t):n.value}},,,function(t,e,n){var r=n(48),i=n(87);function a(e,n,o){return i()?t.exports=a=Reflect.construct:t.exports=a=function(t,e,n){var i=[null];i.push.apply(i,e);var a=new(Function.bind.apply(t,i));return n&&r(a,n.prototype),a},a.apply(null,arguments)}t.exports=a},function(t,e){function n(t,e,n,r,i,a,o){try{var s=t[a](o),u=s.value}catch(t){return void n(t)}s.done?e(u):Promise.resolve(u).then(r,i)}t.exports=function(t){return function(){var e=this,r=arguments;return new Promise((function(i,a){var o=t.apply(e,r);function s(t){n(o,i,a,s,u,"next",t)}function u(t){n(o,i,a,s,u,"throw",t)}s(void 0)}))}}},function(t,e){t.exports=function(t,e,n){var r=e.get(t);if(!r)throw new TypeError("attempted to set private field on non-instance");if(r.set)r.set.call(t,n);else{if(!r.writable)throw new TypeError("attempted to set read only private field");r.value=n}return n}},,,,,function(t,e,n){var r=n(2),i=n(48),a=n(88),o=n(27);function s(e){var n="function"==typeof Map?new Map:void 0;return t.exports=s=function(t){if(null===t||!a(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(t))return n.get(t);n.set(t,e)}function e(){return o(t,arguments,r(this).constructor)}return e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),i(e,t)},s(e)}t.exports=s},,,,,,,,,,function(t,e,n){function r(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.i=function(t){return t},n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:r})},n.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/",n.oe=function(t){throw console.error(t),t};var r=n(n.s=ENTRY_MODULE);return r.default||r}function i(t){return(t+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function a(t,e,r){var a={};a[r]=[];var o=e.toString(),s=o.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!s)return a;for(var u,l=s[1],c=new RegExp("(\\\\n|\\W)"+i(l)+"\\(\\s*(/\\*.*?\\*/)?\\s*.*?([\\.|\\-|\\+|\\w|/|@]+).*?\\)","g");u=c.exec(o);)"dll-reference"!==u[3]&&a[r].push(u[3]);for(c=new RegExp("\\("+i(l)+'\\("(dll-reference\\s([\\.|\\-|\\+|\\w|/|@]+))"\\)\\)\\(\\s*(/\\*.*?\\*/)?\\s*.*?([\\.|\\-|\\+|\\w|/|@]+).*?\\)',"g");u=c.exec(o);)t[u[2]]||(a[r].push(u[1]),t[u[2]]=n(u[1]).m),a[u[2]]=a[u[2]]||[],a[u[2]].push(u[4]);for(var h,f=Object.keys(a),d=0;d<f.length;d++)for(var p=0;p<a[f[d]].length;p++)h=a[f[d]][p],isNaN(1*h)||(a[f[d]][p]=1*a[f[d]][p]);return a}function o(t){return Object.keys(t).reduce((function(e,n){return e||t[n].length>0}),!1)}t.exports=function(t,e){e=e||{};var i={main:n.m},s=e.all?{main:Object.keys(i.main)}:function(t,e){for(var n={main:[e]},r={main:[]},i={main:{}};o(n);)for(var s=Object.keys(n),u=0;u<s.length;u++){var l=s[u],c=n[l].pop();if(i[l]=i[l]||{},!i[l][c]&&t[l][c]){i[l][c]=!0,r[l]=r[l]||[],r[l].push(c);for(var h=a(t,t[l][c],l),f=Object.keys(h),d=0;d<f.length;d++)n[f[d]]=n[f[d]]||[],n[f[d]]=n[f[d]].concat(h[f[d]])}}return r}(i,t),u="";Object.keys(s).filter((function(t){return"main"!==t})).forEach((function(t){for(var e=0;s[t][e];)e++;s[t].push(e),i[t][e]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",u=u+"var "+t+" = ("+r.toString().replace("ENTRY_MODULE",JSON.stringify(e))+")({"+s[t].map((function(e){return JSON.stringify(e)+": "+i[t][e].toString()})).join(",")+"});\n"})),u=u+"new (("+r.toString().replace("ENTRY_MODULE",JSON.stringify(t))+")({"+s.main.map((function(t){return JSON.stringify(t)+": "+i.main[t].toString()})).join(",")+"}))(self);";var l=new window.Blob([u],{type:"text/javascript"});if(e.bare)return l;var c=(window.URL||window.webkitURL||window.mozURL||window.msURL).createObjectURL(l),h=new window.Worker(c);return h.objectURL=c,h}},function(t,e,n){var r,i,a;i=[],void 0===(a="function"==typeof(r=function(){var t=function(){},e={},n={},r={};function i(t,e){if(t){var i=r[t];if(n[t]=e,i)for(;i.length;)i[0](t,e),i.splice(0,1)}}function a(e,n){e.call&&(e={success:e}),n.length?(e.error||t)(n):(e.success||t)(e)}function o(e,n,r,i){var a,s,u=document,l=r.async,c=(r.numRetries||0)+1,h=r.before||t,f=e.replace(/[\?|#].*$/,""),d=e.replace(/^(css|img)!/,"");i=i||0,/(^css!|\.css$)/.test(f)?((s=u.createElement("link")).rel="stylesheet",s.href=d,(a="hideFocus"in s)&&s.relList&&(a=0,s.rel="preload",s.as="style")):/(^img!|\.(png|gif|jpg|svg|webp)$)/.test(f)?(s=u.createElement("img")).src=d:((s=u.createElement("script")).src=e,s.async=void 0===l||l),s.onload=s.onerror=s.onbeforeload=function(t){var u=t.type[0];if(a)try{s.sheet.cssText.length||(u="e")}catch(t){18!=t.code&&(u="e")}if("e"==u){if((i+=1)<c)return o(e,n,r,i)}else if("preload"==s.rel&&"style"==s.as)return s.rel="stylesheet";n(e,u,t.defaultPrevented)},!1!==h(e,s)&&u.head.appendChild(s)}function s(t,n,r){var s,u;if(n&&n.trim&&(s=n),u=(s?r:n)||{},s){if(s in e)throw"LoadJS";e[s]=!0}function l(e,n){!function(t,e,n){var r,i,a=(t=t.push?t:[t]).length,s=a,u=[];for(r=function(t,n,r){if("e"==n&&u.push(t),"b"==n){if(!r)return;u.push(t)}--a||e(u)},i=0;i<s;i++)o(t[i],r,n)}(t,(function(t){a(u,t),e&&a({success:e,error:n},t),i(s,t)}),u)}if(u.returnPromise)return new Promise(l);l()}return s.ready=function(t,e){return function(t,e){t=t.push?t:[t];var i,a,o,s=[],u=t.length,l=u;for(i=function(t,n){n.length&&s.push(t),--l||e(s)};u--;)a=t[u],(o=n[a])?i(a,o):(r[a]=r[a]||[]).push(i)}(t,(function(t){a(e,t)})),s},s.done=function(t){i(t,[])},s.reset=function(){e={},n={},r={}},s.isDefined=function(t){return t in e},s})?r.apply(e,i):r)||(t.exports=a)},,,function(t,e){function n(e,r){return t.exports=n=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},n(e,r)}t.exports=n},function(t,e){!function(){"use strict";function e(t,e){throw new Error("abstract")}e.prototype.drawFrame=function(t){throw new Error("abstract")},e.prototype.clear=function(){throw new Error("abstract")},t.exports=e}()},,,,,,,,,,,function(t,e){var n={validateDimension:function(t){if(t<=0||t!==(0|t))throw"YUV plane dimensions must be a positive integer"},validateOffset:function(t){if(t<0||t!==(0|t))throw"YUV plane offsets must be a non-negative integer"},format:function(t){var e=t.width,n=t.height,r=t.chromaWidth||e,i=t.chromaHeight||n,a=t.cropLeft||0,o=t.cropTop||0,s=t.cropWidth||e-a,u=t.cropHeight||n-o,l=t.displayWidth||s,c=t.displayHeight||u;return this.validateDimension(e),this.validateDimension(n),this.validateDimension(r),this.validateDimension(i),this.validateOffset(a),this.validateOffset(o),this.validateDimension(s),this.validateDimension(u),this.validateDimension(l),this.validateDimension(c),{width:e,height:n,chromaWidth:r,chromaHeight:i,cropLeft:a,cropTop:o,cropWidth:s,cropHeight:u,displayWidth:l,displayHeight:c}},allocPlane:function(t,e){return n.validateDimension(t),n.validateDimension(e),{bytes:new Uint8Array(t*e),stride:t}},suitableStride:function(t){n.validateDimension(t);var e=t%4;return 0==e?t:t+(4-e)},allocPlane:function(t,e,n,r,i){var a,o;if(this.validateDimension(t),this.validateDimension(e),i=i||0,r=r||this.suitableStride(t),this.validateDimension(r),r<t)throw"Invalid input stride for YUV plane; must be larger than width";if(a=r*e,n){if(n.length-i<a)throw"Invalid input buffer for YUV plane; must be large enough for stride times height";o=n.slice(i,i+a)}else o=new Uint8Array(a),r=r||this.suitableStride(t);return{bytes:o,stride:r}},lumaPlane:function(t,e,n,r){return this.allocPlane(t.width,t.height,e,n,r)},chromaPlane:function(t,e,n,r){return this.allocPlane(t.chromaWidth,t.chromaHeight,e,n,r)},frame:function(t,e,n,r){return{format:t,y:e=e||this.lumaPlane(t),u:n=n||this.chromaPlane(t),v:r=r||this.chromaPlane(t)}},copyPlane:function(t){return{bytes:t.bytes.slice(),stride:t.stride}},copyFrame:function(t){return{format:t.format,y:this.copyPlane(t.y),u:this.copyPlane(t.u),v:this.copyPlane(t.v)}},transferables:function(t){return[t.y.bytes.buffer,t.u.bytes.buffer,t.v.bytes.buffer]}};t.exports=n},function(t,e,n){var r=n(95),i=n(96),a=n(97),o=n(99);t.exports=function(t,e){return r(t)||i(t,e)||a(t,e)||o()}},,,,,,,,,,,function(t,e,n){!function(){"use strict";var e=n(49),r=n(89),i=n(92),a={FrameSink:e,SoftwareFrameSink:r,WebGLFrameSink:i,attach:function(t,e){return("webGL"in(e=e||{})?e.webGL:i.isAvailable())?new i(t,e):new r(t,e)}};t.exports=a}()},function(t,e,n){var r=function(t){"use strict";var e=Object.prototype,n=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},i=r.iterator||"@@iterator",a=r.asyncIterator||"@@asyncIterator",o=r.toStringTag||"@@toStringTag";function s(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,n){return t[e]=n}}function u(t,e,n,r){var i=e&&e.prototype instanceof h?e:h,a=Object.create(i.prototype),o=new x(r||[]);return a._invoke=function(t,e,n){var r="suspendedStart";return function(i,a){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw a;return B()}for(n.method=i,n.arg=a;;){var o=n.delegate;if(o){var s=k(o,n);if(s){if(s===c)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=l(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===c)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}(t,n,o),a}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=u;var c={};function h(){}function f(){}function d(){}var p={};p[i]=function(){return this};var y=Object.getPrototypeOf,v=y&&y(y(_([])));v&&v!==e&&n.call(v,i)&&(p=v);var g=d.prototype=h.prototype=Object.create(p);function m(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){var r;this._invoke=function(i,a){function o(){return new e((function(r,o){!function r(i,a,o,s){var u=l(t[i],t,a);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==typeof h&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,o,s)}),(function(t){r("throw",t,o,s)})):e.resolve(h).then((function(t){c.value=t,o(c)}),(function(t){return r("throw",t,o,s)}))}s(u.arg)}(i,a,r,o)}))}return r=r?r.then(o,o):o()}}function k(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,k(t,e),"throw"===e.method))return c;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return c}var r=l(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,c;var i=r.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,c):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,c)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function w(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function x(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function _(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,a=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return a.next=a}}return{next:B}}function B(){return{value:void 0,done:!0}}return f.prototype=g.constructor=d,d.constructor=f,f.displayName=s(d,o,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,s(t,o,"GeneratorFunction")),t.prototype=Object.create(g),t},t.awrap=function(t){return{__await:t}},m(b.prototype),b.prototype[a]=function(){return this},t.AsyncIterator=b,t.async=function(e,n,r,i,a){void 0===a&&(a=Promise);var o=new b(u(e,n,r,i),a);return t.isGeneratorFunction(n)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},m(g),s(g,o,"Generator"),g[i]=function(){return this},g.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=_,x.prototype={constructor:x,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(w),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return o.type="throw",o.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],o=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=t,o.arg=e,a?(this.method="next",this.next=a.finallyLoc,c):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),c},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),w(n),c}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;w(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:_(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),c}},t}(t.exports);try{regeneratorRuntime=r}catch(t){Function("r","regeneratorRuntime = r")(r)}},,,,,,,,,,,,,function(t,e,n){"use strict";n.r(e);var r=n(3),i=n.n(r),a=n(4),o=n.n(a),s=n(1),u=n.n(s),l=n(5),c=n.n(l),h=n(6),f=n.n(h),d=n(2),p=n.n(d),y=n(0),v=n.n(y),g=n(24),m=n.n(g),b=n(29),k=n.n(b),P=n(10);function w(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return x(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return x(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function x(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var _=P.a.get("Events.js"),B=function(){function t(e){i()(this,t),v()(this,"eventsQueue",{}),v()(this,"target",{}),v()(this,"disallowRepeat",!1),this.target=e}return o()(t,[{key:"add",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0,i=w(e);try{for(i.s();!(t=i.n()).done;){var a=t.value;this.on(a,n,r)}}catch(t){i.e(t)}finally{i.f()}}},{key:"on",value:function(t,e,n){if(void 0===this.eventsQueue[t]&&(this.eventsQueue[t]={methods:[],once:!1}),"function"==typeof e){if(!this.disallowRepeat||!this.eventsQueue[t].methods.includes(e))return this.eventsQueue[t].methods.push(e),void 0!==n&&(this.eventsQueue[t].once=n),this.target}else _.error("on","the argument is not function.",e)}},{key:"once",value:function(t,e){this.on(t,e,!0)}},{key:"off",value:function(t,e){var n=this.eventsQueue[t];if(n){var r=n.methods;if(e)for(var i=r.length;i--;)r[i]===e&&r.splice(i,1);else delete this.eventsQueue[t];return this.target}}},{key:"emit",value:function(t){for(var e=this,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];var a=this.eventsQueue[t];if(a){var o=a.methods;return o.forEach((function(t){t.apply(e.target,r)})),a.once&&this.off(t),this.target}}},{key:"clear",value:function(t){delete this.eventsQueue[t]}},{key:"clearAll",value:function(){this.eventsQueue={}}}]),t}(),T=function(t){var e=new B(t);return function(t){return e.target=t,e}},E=n(11),S=n.n(E),R=P.a.get("Element.js"),L=function(){function t(){i()(this,t)}return o()(t,null,[{key:"createEl",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"div",e=arguments.length>1?arguments[1]:void 0;if("string"!=typeof t)return R.error("please input element name"),null;var n=document.createElement(t,e);return n}},{key:"registerElement",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:HTMLElement,n=arguments.length>2?arguments[2]:void 0,r=document.registerElement(t,{prototype:Object.create(e.prototype),extends:n});return r}},{key:"addEl",value:function(t,e){if(t&&e)try{e.appendChild(t)}catch(t){R.error(t)}}},{key:"removeEl",value:function(t){try{var e=t.parentNode;e&&e.removeChild(t)}catch(t){R.error(t)}}},{key:"addClass",value:function(t){try{for(var e,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];(e=t.classList).add.apply(e,r)}catch(t){R.error(t)}}},{key:"removeClass",value:function(){}},{key:"hasClass",value:function(){}},{key:"isElement",value:function(t){try{return t instanceof HTMLElement}catch(e){return"object"===S()(t)&&1===t.nodeType&&"object"===S()(t.style)&&"object"===S()(t.ownerDocument)}}},{key:"setAttributes",value:function(e,n){if(t.isElement(e))for(var r=0,i=n.length;r<i;r++){var a=n[r],o=a.name;o=a.name.replace(/["|']/g,""),e.setAttribute(o,a.value)}}},{key:"syncAttributes",value:function(e,n){var r=n.attributes;t.setAttributes(e,r);var i=e.attributes;t.setAttributes(n,i)}},{key:"getClientWidth",value:function(){return document.documentElement.clientWidth?document.documentElement.clientWidth:document.body.clientWidth}},{key:"getClientHeight",value:function(){return document.documentElement.clientHeight?document.documentElement.clientHeight:document.body.clientHeight}},{key:"adaptSizeElement",value:function(t,e,n,r){var i=n,a=r;a.width=t||a.width||i.offsetWidth,a.height=e||a.height||i.offsetHeight;var o=a.width,s=a.height,u=0;a.style.position="absolute",i.offsetWidth<=0&&(i.style.width=o+"px"),i.offsetHeight<=0&&(i.style.height=s+"px");var l=i.offsetWidth/o,c=i.offsetHeight/s;u=c>l?l:c,a.style.top=i.offsetTop+(i.offsetHeight-s*u)/2+"px",a.style.left=i.offsetLeft+(i.offsetWidth-o*u)/2+"px",a.style.transform="scale(".concat(u,", ").concat(u,")"),a.style["transform-origin"]="top left",a.style.display="inline-block"}}]),t}(),D=n(27),C=n.n(D),A=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i()(this,t),v()(this,"logger",null),v()(this,"__instance__",null),v()(this,"__singleton__",null),this.options=e,this.setLogger(this.constructor.name+".js")}return o()(t,[{key:"setLogger",value:function(t){this.logger=new P.a(t)}},{key:"getLogger",value:function(){return this.logger}},{key:"setOptions",value:function(t){Object.assign(this.options,t)}},{key:"toString",value:function(){return JSON.stringify(this)}},{key:"events",get:function(){return this.options&&this.options.events?this.options.events(this):T(this)}}],[{key:"getInstance",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.__instance__=C()(this,e),this.__instance__}},{key:"getSingleton",value:function(){if(!this.__singleton__){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.__singleton__=C()(this,e)}return this.__singleton__}}]),t}();function O(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p()(t);if(e){var i=p()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}var M=function(t){c()(n,t);var e=O(n);function n(t){var r;return i()(this,n),r=e.call(this),v()(u()(r),"component",null),r.component=t.component,r}return o()(n,[{key:"confirm",value:function(){}},{key:"show",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.component.data.content=t,"default"!==this.component.data.display&&""!==this.component.data.display||this.component.showBox(),"show"!==this.component.data.display&&this.component.show()}},{key:"hide",value:function(){this.component.hide()}}]),n}(A),I=n(23),U=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i()(this,t),v()(this,"logger",null),this.options=e,this.debug=e.debug||!1,this.setLogger(this.constructor.name+".js")}return o()(t,[{key:"setLogger",value:function(t){this.logger=new P.a(t)}},{key:"getLogger",value:function(){return this.logger}},{key:"setOptions",value:function(t){Object.assign(this.options,t)}},{key:"toString",value:function(){return JSON.stringify(this)}},{key:"events",get:function(){return this.options&&this.options.events?this.options.events(this):T(this)}},{key:"alert",get:function(){var t="";return this.options&&this.options.alertError&&(t=this.options.alertError),t}}]),t}(),N=n(9);function H(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p()(t);if(e){var i=p()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}var F=function(t){c()(n,t);var e=H(n);function n(){var t;return i()(this,n),t=e.call(this),v()(u()(t),"loadData",null),v()(u()(t),"sourceURL",""),t}return o()(n,[{key:"init",value:function(){}},{key:"setLoadData",value:function(t){this.loadData=t}},{key:"setSourceURL",value:function(t){this.sourceURL=t}},{key:"getLoadData",value:function(){return this.getLoadData}},{key:"getSourceURL",value:function(){return this.getSourceURL}}]),n}(U),j={LOAD_PLAYLIST:10,get 10(){return"loading playlist"},LOADED_PLAYLIST:11,get 11(){return"playlist is loaded"},IDLE:0,get 0(){return"is free"},LOADING:1,get 1(){return"loading segment"},DONE:2,get 2(){return"segment is loaded"},ERROR:3,get 3(){return"load get error"}},W=P.a.get("M3U8Parser.js",{level:2}),V={lineDelimiter:/\r?\n/,extensionHeader:"#EXTM3U",tagPrefix:"#EXT",segmentPrefix:"#EXTINF",segmentParse:/^#EXTINF: *([0-9.]+)(, *(.+?)?)?$/,tagParse:/^#EXT-X-([A-Z-]+)(:(.+))?$/,version:"VERSION",allowCache:"ALLOW-CACHE",combined:"COMBINED",endList:"ENDLIST",targetDuration:"TARGETDURATION",mediaSequence:"MEDIA-SEQUENCE",discontinuity:"DISCONTINUITY",streamInf:"STREAM-INF",isComment:function(t){return t&&"#"===t[0]&&!t.startsWith(V.tagPrefix)},isBlank:function(t){return""===t},canStrip:function(t){return V.isBlank(t)||V.isComment(t)}},z=0,X=1,G={file:void 0,name:void 0,start:0,end:0,discontinuity:void 0,duration:void 0},Y=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};i()(this,t),v()(this,"source",""),v()(this,"segments",[]),v()(this,"_currentSegment",null),v()(this,"discontinuous",null),v()(this,"tags",{VERSION:void 0,TARGETDURATION:void 0}),v()(this,"_state",null),this.source=e,this.options=n,this.parse(this.source)}return o()(t,[{key:"readSegment",value:function(t){var e=V.segmentParse.exec(t);if(null!==e){var n=parseFloat(e[1],10),r=e[3];n%1!=0&&this.tags.VERSION>=3&&W.info("readsegment","Version must be 3 or higher to support floating.","duration:",n),n<this.tags.TARGETDURATION&&W.info("readsegment","Segment duration must be less than the TARGETDURATION","duration:",n),n*=1e3,this._currentSegment=Object.assign({},G,{duration:n,name:r,discontinuity:this.discontinuous});var i=this.segments[this.segments.length-1]||{start:0,end:0};this._currentSegment.start=i.end,this._currentSegment.end=i.end+n,this.discontinuous=!1,this._state=X}else W.warn("readsegment","read segment failed","line:",t)}},{key:"readTag",value:function(t){var e=V.tagParse.exec(t);if(null!==e)return{name:e[1],value:e[3]}}},{key:"readLine",value:function(t){if(t.startsWith(V.segmentPrefix))return this.readSegment(t);var e=this.readTag(t);if(e)switch(e.name){case V.version:this.tags.VERSION=parseFloat(e.value,10);break;case V.mediaSequence:this.tags.MEDIA_SEQUENCE=parseFloat(e.value,10);break;case V.allowCache:this.tags.ALLOW_CACHE=!!/\s*(YES|yes)\s*/.test(e.value);break;case V.discontinuity:this.tags.DISCONTINUITY=!0,this.discontinuous=!0;break;case V.targetDuration:this.tags.TARGETDURATION=parseFloat(e.value,10);break;case V.combined:this.tags.COMBINED=e.value;break;case V.streamInf:this.tags.STREAM_INF=e.value;break;case V.endList:this.tags.ENDLIST="EOF";break;default:W.warn("readLine","unknow line","line:",t)}}},{key:"addFile",value:function(t){if("#"!==t[0]){this._currentSegment.file=t;var e=this.parseSDParam(t);if(e>=0){this._currentSegment.start=e,this._currentSegment.end=e+this._currentSegment.duration;var n=this.segments[this.segments.length-1]||{sd:0,start:0,end:0};n.duration=e-n.start,n.end=e}this._currentSegment.name||(this._currentSegment.name=t.substr(Math.max(0,t.lastIndexOf("/")),t.lastIndexOf("."))),this.segments.push(this._currentSegment),this._state=z}else{var r=this.readTag(t);switch(r.name){case"PROGRAM-DATE-TIME":var i=new Date(r.value);this._currentSegment.time=i;break;default:W.warn("addFile","Invalid tag.","tag.name:",r.name)}}}},{key:"parseSDParam",value:function(t){var e=-1;try{var n=new URL(t).searchParams.get("sd");n&&(e=parseInt(n,10))}catch(t){}return e}},{key:"parse",value:function(t){var e=this;if("string"==typeof(t=t||this.source)){this._state=z,this.discontinuous=!1;var n=t.split(V.lineDelimiter);if(n[0]==V.extensionHeader)return n.forEach((function(t){if(!V.canStrip(t))switch(e._state){case z:e.readLine(t);break;case X:e.addFile(t);break;default:Object(I.a)("parsing m3u8 get an error, it is unknow state.")}})),this;W.error("parse","it is not a valid  m3u8 header","header:",n[0])}else Object(I.a)("m3u8 file is not text.",t)}},{key:"version",get:function(){return this.tags.VERSION}},{key:"duration",get:function(){return this.segments.length?this.segments.reduce((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1?arguments[1]:void 0,n="number"==typeof t?t:t.duration;return n+e.duration})):0}},{key:"targetDuration",get:function(){return this.tags.TARGETDURATION}},{key:"mediaSequence",get:function(){return this.tags.MEDIA_SEQUENCE}},{key:"allowCache",get:function(){return this.tags.ALLOW_CACHE}},{key:"length",get:function(){return this.segments.length}}]),t}(),$=n(45),q=n.n($);function K(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Object";return function(e){var n="[object "+t+"]";return Object.prototype.toString.call(e)==n}}var Q=function(){function t(){i()(this,t)}return o()(t,null,[{key:"importScripts",value:function(t,e,n){var r="ready"+Date.now();t instanceof Array?q()(t,r):q()([t],r),q.a.ready(r,{success:e,error:n})}},{key:"blobData",value:function(t){var e=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(e)}},{key:"escapeHTML",value:function(e){if(t.isString(e))return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}},{key:"getInnerWidthHeight",value:function(){return{width:window.innerWidth,height:window.innerHeight}}},{key:"Fullscreen",value:function(){var t=document.documentElement;t.requestFullscreen?t.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullScreen&&(t.webkitRequestFullScreen(),setTimeout((function(){console.error("fullscreen success"),document.dispatchEvent(new Event("fullscreenchange"))}),0))}},{key:"exitFullscreen",value:function(){var t=document;t.exitFullscreen?t.exitFullscreen():t.mozCancelFullScreen?t.mozCancelFullScreen():t.webkitExitFullscreen&&(t.webkitExitFullscreen(),setTimeout((function(){console.error("exitfullscreen success"),document.dispatchEvent(new Event("fullscreenchange"))}),0))}},{key:"buildFilePath",value:function(t,e){return t.map((function(t){return e+t}))}},{key:"insertSort",value:function(t,e,n){var r,i,a=t.length;if(0!==a)if(n){var o=n(e);r=o.key,i=o.value;for(var s=0;s<a;s++)if(i<t[s][r]){for(var u=a;u>s;)t[u]=t[u-1],u--;return void(t[s]=e)}t.push(e)}else{i=e;for(var l=0;l<a;l++)if(i<t[l]){for(var c=a;c>l;)t[c]=t[c-1],c--;return void(t[l]=i)}t.push(i)}else t.push(e)}},{key:"isSafari",value:function(){var t=navigator.userAgent;return/Safari/.test(t)&&!/Chrome/.test(t)}},{key:"msec2sec",value:function(t){var e=(t/1e3).toFixed(3);return parseFloat(e,10)}}]),t}();v()(Q,"isObject",(function(){return K("Object")})),v()(Q,"isString",(function(){return K("String")})),v()(Q,"isFunction",(function(){return K("Function")}));var Z=n(34),J=n.n(Z);function tt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p()(t);if(e){var i=p()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}var et=function(t){c()(n,t);var e=tt(n);function n(){return i()(this,n),e.call(this)}return o()(n,[{key:"add",value:function(t){this.push(Object.freeze(t))}},{key:"addAll",value:function(t){var e=this;t.forEach((function(t){e.add(t)}))}},{key:"get",value:function(t){return this[t]}},{key:"getLast",value:function(){return this[this.length-1]}},{key:"getBy",value:function(t){var e=this;if("function"==typeof t){var n=new this.constructor;return this.every((function(r,i){return!0===t.call(e,r,i,e)&&n.add(r),!0})),n}}},{key:"indexOfByTime",value:function(t,e){e||(e=function(e){return t>=e.start&&t<e.end});for(var n=this.length-1,r=0;r<=n;){var i=Math.floor((n+r)/2),a=this[i];if(e(a))return i;a.start>t?n=i-1:r=i+1}return-1}},{key:"getByTime",value:function(t){var e=this.indexOfByTime(t);if(e>=0)return this[e]}},{key:"getByKey",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Array.isArray(e[0])&&(e=e[0]),this.getBy((function(t){var n=!1;return e.every((function(e){return!Object.prototype.hasOwnProperty.call(t,e)||(n=!0,!1)})),n}))}},{key:"getByValue",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Array.isArray(e[0])&&(e=e[0]),this.getBy((function(t){var n=!1;return t.each((function(t,r){if(e.includes(r))return n=!0,!1})),n}))}},{key:"getByKeyValue",value:function(t,e){return this.getBy((function(n){return n[t]===e}))}},{key:"getValues",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Array.isArray(e[0])&&(e=e[0]),this.map((function(t){return e.length?t.get(t,e):t.getValues(t)}))}},{key:"indexOfBy",value:function(t){var e=0,n=this.length;for(t=t||function(){return!1};e<n;){if(!0===t.call(this,this[e],e,this))return e;e++}return-1}},{key:"indexOfByKey",value:function(t,e){return this.indexOfBy((function(n){return n[t]===e}))}},{key:"indexOfByKeyValue",value:function(t,e){return this.indexOfByKey(t,e)}},{key:"each",value:function(t){if("function"==typeof t)return this.forEach(t),this}},{key:"remove",value:function(t,e){return this.length<=0||(t=t<0?0:t,e=e||t+1,this.splice(t,e-t)),this}},{key:"removeItem",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Array.isArray(e[0])&&(e=e[0]),this.removeBy((function(t){return e.includes(t)}))}},{key:"removeBy",value:function(t){for(var e=0,n=this.length;e<n;e++)!0===t.call(this,this[e],e,this)&&(this.splice(e,1),n--,e--);return this}},{key:"removeByKeyValue",value:function(t,e){return this.removeBy((function(n){return n[t]===e}))}},{key:"toJSON",value:function(){var t=Array.from(this);return t.forEach((function(e,n){t[n]=e&&"function"==typeof e.toJSON?e.toJSON():e})),t}},{key:"toArray",value:function(){return Array.from(this)}},{key:"size",get:function(){return this.length}}]),n}(J()(Array)),nt=function(){function t(){i()(this,t)}return o()(t,[{key:"pair",value:function(){return Object.entries(this)}},{key:"keys",value:function(){return Object.keys(this)}},{key:"set",value:function(t,e){return this[t]=e,this}},{key:"get",value:function(t){return this[t]}},{key:"add",value:function(t,e){return Object.prototype.hasOwnProperty.call(this,t)||this.set(t,e),this}},{key:"addAll",value:function(t){for(var e in t)this.add(e,t[e]);return this}},{key:"toJSON",value:function(){var t={};for(var e in this)Object.prototype.hasOwnProperty.call(this,e)&&(t[e]=this[e]);return t}}]),t}();function rt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p()(t);if(e){var i=p()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}var it=function(t){c()(n,t);var e=rt(n);function n(t){var r;return i()(this,n),r=e.call(this,t),v()(u()(r),"no",0),v()(u()(r),"name",null),v()(u()(r),"duration",0),v()(u()(r),"file",null),v()(u()(r),"start",0),v()(u()(r),"end",0),Object.assign(u()(r),t),r}return n}(nt);function at(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p()(t);if(e){var i=p()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}var ot=function(t){c()(n,t);var e=at(n);function n(t){return i()(this,n),e.call(this,t)}return o()(n,[{key:"add",value:function(t){t instanceof it||(t=new it(t)),t.no=this.length+1,Q.isObject(t)&&this.push(t)}}]),n}(et),st={ProcessorResetEnd:"DataProcessorController.processorResetEnd",DataProcessorReady:"DataProcessorController.dataProcessorReady",DecodeStartDecode:"DecodeController.startDecode",DecodeFlush:"DecodeController.flush",DecodeDecoded:"DecodeController.decoded",DecodeApppendEnd:"DecodeController.appendEnd",DecodeFlushEnd:"DecodeController.flushEnd",DecodeReady:"DecodeController.ready",DemuxResetEnd:"DemuxController.resetEnd",DemuxStartDemux:"DemuxController.startDemux",DemuxLast:"DemuxController.last",DemuxVideo:"DemuxController.video",DemuxAAC:"DemuxController.AAC",DemuxReady:"DemuxController.ready",ImagePlayerRenderEnd:"ImagePlayer.renderEnd",ImagePlayerWait:"ImagePlayer.wait",ImagePlayerReady:"ImagePlayer.ready",ImagePlayerEnd:"ImagePlayer.end",ImagePlayerBuffeUpdate:"ImagePlayer.bufferUpdate",ControlBarPlay:"ControlBar.onPlay",ControlBarPause:"ControlBar.onPause",ControlBarPauseLoading:"ControlBar.onPauseLoading",LoadDataReadBufferByNo:"LoadData.readBufferByNo",LoadDataReadBuffer:"LoadData.readBuffer",LoadDataRead:"LoadData.onRead",LoadDataSeek:"LoadData.onSeek",LoadDataFirstLoaded:"LoadData.onFirstLoaded",LoaderPlayListStart:"Loader.playlistStart",LoaderLoading:"Loader.onLoading",LoaderError:"Loader.onError",LoaderLoaded:"Loader.onLoaded",LoaderUpdateSpeed:"Loader.updateSpeed",LoaderLoadFile:"Loader.loadFile",LoaderPlayListLoaded:"Loader.playlistLoaded",AudioPlayerReady:"AudioPlayer.MSEReady",AudioPlayerDataReady:"AudioPlayer.dataReady",AudioPlayerWait:"AudioPlayer.wait",AudioPlayerEnd:"AudioPlayer.end",AudioPlayerPlaySuccess:"AudioPlayer.playSuccess",AudioPlayerPlayFail:"AudioPlayer.playFail",PlayerMaxPTS:"DemuxController.maxpts",PlayerSeekEnd:"Player.seekend",PlayerSpeedTo:"Player.speedTo",PlayerChangeRate:"Player.changeRate",PlayerChangeSrc:"Player.changeSrc",PlayerPlaying:"Player.playing",PlayerTimeUpdate:"Player.timeUpdate",PlayerbufferUpdate:"Player.bufferupdate",PlayerResetReady:"Player.resetReady",PlayerWait:"Player.wait",PlayerLoadNext:"Player.loadNext",PlayerOnPlay:"Player.onPlay",PlayerOnPause:"Player.onPause",PlayerOnSeek:"Player.onSeek",PlayerOnVolume:"Player.onVolume",PlayerReady:"Player.ready",PlayerPlay:"Player.play",PlayerReset:"Player.reset",PlayerLoadedMetaData:"Player.loadedMetaData",PlayerEnd:"Player.end",PlayerPause:"Player.pause",PlayerSeeking:"Player.seeking",PlayerAlert:"Player.alert",PlayerThrowError:"Player.throwError",StreamDataReady:"StreamController.dataReady"};function ut(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p()(t);if(e){var i=p()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}function lt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function ct(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?lt(Object(n),!0).forEach((function(e){v()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):lt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function ht(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p()(t);if(e){var i=p()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}var ft={HLS:function(t){c()(n,t);var e=ut(n);function n(t){var r;return i()(this,n),r=e.call(this),v()(u()(r),"state",j.IDLE),v()(u()(r),"maxBufferDuration",N.b.maxDuration),v()(u()(r),"maxBufferSize",N.b.maxSize),v()(u()(r),"baseUrl",""),v()(u()(r),"options",null),v()(u()(r),"httpWorker",null),v()(u()(r),"sourceData",null),v()(u()(r),"segmentPool",[]),v()(u()(r),"currentNo",null),v()(u()(r),"maxRetryCount",N.b.maxRetryCount),r.options=t,r.loaderController=r.options.loaderController,r.dataController=r.loaderController.dataController,r.httpWorker=t.httpWorker,r.setSegmentPool(new ot),r}return o()(n,[{key:"loadPlaylist",value:function(t){var e=this;this.httpWorker.postMessage({type:"invoke",fileType:"m3u8",method:"get",name:"playlist",url:this.sourceURL}),this.httpWorker.onmessage=function(n){var r=n.data,i=n.data.data;if(i)"playlist"==r.name&&e.parsePlaylist(i,t);else{var a="Get the ".concat(r.fileType," file error. URL: ").concat(r.url);e.events.emit(st.PlayerAlert,a),e.events.emit(st.LoaderError,a,r);var o=[e.state,"request playlist error.","data:",r,a];e.events.emit(st.PlayerThrowError,o)}}}},{key:"parsePlaylist",value:function(t,e){var n=new Y(t);if(n.segments&&n.segments.length){n.segments.forEach((function(t){t.start=Q.msec2sec(t.start),t.end=Q.msec2sec(t.end),t.duration=Q.msec2sec(t.duration)})),this.setSourceData(Object.freeze(n)),this.segmentPool.addAll(n.segments),e.call(this,n)}else{this.events.emit(st.LoaderError,n),this.events.emit(st.PlayerAlert,"Parse playlist file error.");var r=[this.state,"Parse playlist error.","data:",n];this.events.emit(st.PlayerThrowError,r)}}},{key:"setSourceData",value:function(t){this.sourceData=t}},{key:"getSourceData",value:function(){return this.sourceData}},{key:"setSegmentPool",value:function(t){this.segmentPool=t}},{key:"getSegmentPool",value:function(){return this.segmentPool}},{key:"isNotFree",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return t="["+t+"]loader is not free. please wait.",this.state!==j.IDLE&&this.state!==j.DONE&&(this.logger.warn("isNotFree","check status for loader","notice:",t),!0)}},{key:"getBaseUrl",value:function(t){var e=this.options.sourceURL;if(!(t.indexOf("//")>-1)){var n=e.lastIndexOf("/");return e.substr(0,n+1)}return""}},{key:"checkLoadCondition",value:function(t){return!(t.no>this.segmentPool.length)&&(!(this.dataController.getLoadDataBufferPool().bufferDuration>this.maxBufferDuration)||(this.logger.info("checkLoadCondition","stop load next segment.","bufferDuration:",this.dataController.getLoadDataBufferPool().bufferDuration,"maxBufferDuration:",this.maxBufferDuration),!1))}},{key:"loadFile",value:function(t,e,n){var r=this;if(t instanceof it)if(this.isNotFree()&&"seek"!==e&&"start"!==e)this.logger.warn("loadFile","is loading","segment:",t,"type:",e);else{if(!this.checkLoadCondition(t))return this.state=j.IDLE,void this.logger.warn("loadFile","checkLoadCondition failed","segment:",t,"type:",e);this.currentNo=t.no;var i=this.getBaseUrl(t.file)+t.file,a=1,o=function(t,e){return"function"==typeof r.options.processURL?r.options.processURL(t,e):t},s=function(){r.httpWorker.postMessage({type:"invoke",fileType:"ts",method:"get",name:t.no,url:o(i,t)})};this.state=j.LOADING,this.events.emit(st.LoaderLoading,t,e,n),this.httpWorker.onmessage=function(i){r.state=j.DONE;var o=i.data;if(r.logger.info("loadfile","httpWorker","onmessage get data"),o&&"error"!==o.type)"notice"===o.type?"speed"===o.noticeType&&r.events.emit(st.LoaderUpdateSpeed,o.data):"ts"===o.fileType&&o.name===t.no?(r.logger.info("loadFile","read success","data no:",o.name),r.state=j.IDLE,r.events.emit(st.LoaderLoaded,o,t,e,n)):r.logger.warn("loadFile","is not ts file or the segment'no is not equal.","fileType:",o.fileType,"data:",o);else if(r.state=j.ERROR,a<=r.maxRetryCount)r.logger.warn("loadFile","retry to load","count:",a,"segment:",t),s(),a+=1;else{r.events.emit(st.LoaderError,t,e,n);r.events.emit(st.PlayerAlert,"Load file error, please concat administrator.");var u=[r.state,"Load File error.","load count:",a,"segment:",t];r.events.emit(st.PlayerThrowError,u)}},s()}}},{key:"destroy",value:function(){this.httpWorker&&this.httpWorker.terminate()}}]),n}(F),MP4:F},dt=function(t){c()(n,t);var e=ht(n);function n(t,r){var a;return i()(this,n),a=e.call(this),v()(u()(a),"state",null),v()(u()(a),"exeLoader",null),v()(u()(a),"loadData",null),v()(u()(a),"type","HLS"),v()(u()(a),"options",null),v()(u()(a),"dataController",null),a.type=t||a.type,a.player=r.player,a.options=r.player.options,a.dataController=a.player.dataController,a.init(a.type,a.options),a}return o()(n,[{key:"init",value:function(t,e){this.bindEvent(),this.setExeLoader(new ft[t](ct(ct({},e),{},{player:this.player,loaderController:this}))),this.setSourceURL(e.sourceURL),this.player.loadData?this.setLoadData(this.player.loadData):this.setLoadData(this.dataController.getDataInstance("load",e)),this.exeLoader.setLoadData(this.loadData)}},{key:"run",value:function(){this.state=j.LOAD_PLAYLIST,this.events.emit(st.LoaderPlayListStart,this),this.logger.info("run",j[this.state],"url:",this.options.sourceURL),this.loadPlaylist()}},{key:"bindEvent",value:function(){var t=this;this.events.on(st.LoaderLoadFile,(function(e,n,r){t.exeLoader.loadFile(e,n,r)}))}},{key:"loadPlaylist",value:function(t){var e=this;this.exeLoader.loadPlaylist((function(n){n?(e.dataController.setLoadDataSourceData(e.exeLoader.getSourceData()),e.dataController.setLoadDataSegmentPool(e.exeLoader.getSegmentPool()),e.state=j.LOADED_PLAYLIST,e.events.emit(st.LoaderPlayListLoaded,e),"function"==typeof t&&t.call(e,n)):e.logger.error("run","start load m3u8","data:",n)}))}},{key:"switchPlaylist",value:function(t,e){this.setSourceURL(t),this.dataController.clearLoadData(),this.state=j.LOAD_PLAYLIST,this.events.emit(st.LoaderPlayListStart,this),this.logger.info("switchPlaylist",j[this.state],"url:",t),this.loadPlaylist(e)}},{key:"setExeLoader",value:function(t){this.exeLoader=t}},{key:"getExeLoader",value:function(){return this.exeLoader}},{key:"setSourceURL",value:function(t){this.exeLoader.setSourceURL(t)}},{key:"getSourceURL",value:function(){return this.exeLoader.getSourceURL()}},{key:"setLoadData",value:function(t){this.loadData=t}},{key:"getLoadData",value:function(){return this.loadData}},{key:"getSourceData",value:function(){return this.exeLoader.getSourceData()}},{key:"destroy",value:function(){this.exeLoader.destroy()}}]),n}(A);function pt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p()(t);if(e){var i=p()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}var yt=function(t){c()(n,t);var e=pt(n);function n(t){var r;return i()(this,n),r=e.call(this,t),v()(u()(r),"no",0),v()(u()(r),"start",0),v()(u()(r),"end",0),v()(u()(r),"blob",null),v()(u()(r),"arrayBuffer",null),v()(u()(r),"duration",0),Object.assign(u()(r),t),r}return o()(n,[{key:"size",get:function(){return this.blob.size}}]),n}(nt);function vt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p()(t);if(e){var i=p()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}var gt=function(t){c()(n,t);var e=vt(n);function n(t){return i()(this,n),e.call(this,t)}return o()(n,[{key:"add",value:function(t){t instanceof yt||(t=new yt(t));var e=this.length;if(0!==e){for(;e--;)if(t.no<=this[e].no)return void this.splice(e,1,t);return this.push(t),this}this.push(t)}},{key:"getBufferSize",value:function(){return this.length<=0?0:this.reduce((function(t,e){return isNaN(t)&&(t=t.blob.size),t+e.blob.size}))}},{key:"getBufferDuration",value:function(){return this.length<=0?0:this.reduce((function(t,e){return isNaN(t)&&(t=t.end-t.start),t+(e.end-e.start)}))}},{key:"bufferSize",get:function(){return this.getBufferSize()}},{key:"bufferDuration",get:function(){return this.getBufferDuration()}}]),n}(et);function mt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p()(t);if(e){var i=p()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}var bt=function(t){c()(n,t);var e=mt(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i()(this,n),t=e.call(this),v()(u()(t),"bufferPool",[]),v()(u()(t),"sourceData",{}),v()(u()(t),"options",{}),v()(u()(t),"segmentPool",[]),v()(u()(t),"readBufferNo",null),v()(u()(t),"startLoadTime",null),v()(u()(t),"currentSeekTime",null),t.options=r,t.init(),t}return o()(n,[{key:"init",value:function(){var t=this;this.setBufferPool(new gt),this.events.on(st.LoadDataReadBufferByNo,(function(e,n){t.readBufferByNo(e,n)})),this.events.on(st.LoadDataReadBuffer,(function(e,n){t.readBuffer(e,n)})),this.events.on(st.LoaderLoaded,(function(e,n,r,i){var a=t.createBuffer({arrayBuffer:e.arrayBuffer},n);if(t.segmentLoaded(n,a),"seek"===r&&i===t.currentSeekTime)return t.events.emit(st.LoadDataSeek,a,i),void t.removeBufferByNo(a.no);i===t.startLoadTime&&t.events.emit(st.LoadDataFirstLoaded,a,i)}))}},{key:"setOptions",value:function(t){Object.assign(this.options,t)}},{key:"startLoad",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.logger.info("startLoad","begin to load ts data","time:",t),isNaN(t)?this.logger.error("seekTime","seek","time:",t):(this.startLoadTime=t,this.loadSegmentByTime(t,"start"))}},{key:"readBuffer",value:function(t,e){var n=this.getSegmentByTime(t);n&&this.readBufferByNo(n.no,e)}},{key:"segmentLoaded",value:function(t,e){e&&this.addBufferPool(e),t.no===this.options.player.currentIndex&&this.readBufferByNo(t.no),t.no<this.segmentPool.getLast().no&&this.loadSegmentByNo(t.no+1)}},{key:"seekTime",value:function(t){if(isNaN(t))this.logger.error("seekTime","seek","time:",t);else{var e;this.currentSeekTime=t;var n=this.bufferPool.indexOfByTime(t);n>-1?(e=this.bufferPool[n],this.events.emit(st.LoadDataSeek,e,t)):(this.removeBufferPool(this.bufferPool.length),this.loadSegmentByTime(t,"seek"))}}},{key:"loadSegmentByTime",value:function(t,e){if(!isNaN(t)){var n=this.segmentPool.indexOfByTime(t);if(n>=0){var r=this.segmentPool[n];this.events.emit(st.LoaderLoadFile,r,e,t)}else this.logger.error("loadSegmentByTime","time over","time:",t,"type:",e)}}},{key:"createBuffer",value:function(t,e){if(t){var n={start:e.start,end:e.end,no:e.no,duration:e.end-e.start,arrayBuffer:t.arrayBuffer};return new yt(n)}}},{key:"isValidSegmentNo",value:function(t){return!isNaN(t)&&t>0&&t<=this.segmentPool.length}},{key:"loadSegmentByNo",value:function(t){var e=t-1,n=this.segmentPool.get(e);n&&this.events.emit(st.LoaderLoadFile,n,"play")}},{key:"readBufferByNo",value:function(t,e){this.isValidSegmentNo(t)?(this.readBufferNo=t,e=e||function(t){this.events.emit(st.LoadDataRead,t)},this.getBlobByNo(t,e)):this.logger.error("readBufferByNo","check buffer no","is not valid no",t)}},{key:"getSegmentByTime",value:function(t){var e=this.segmentPool.indexOfByTime(t);return this.segmentPool[e]}},{key:"getBlobByNo",value:function(t,e){if(isNaN(t))this.logger.error("getBlobByNo","isNaN","no:",t);else{var n;if(!this.isBufferReading)return this.isBufferReading=!0,n=this.bufferPool.getByKeyValue("no",t)[0],"function"==typeof e&&(e.call(this,n),n&&this.removeBufferByNo(n.no)),this.isBufferReading=!1,n;this.logger.warn("getBlobByNo","isBufferReading","no:",t)}}},{key:"addBufferPool",value:function(t){if(this.bufferPool.length){if(this.bufferPool[0].no===t.no+1)return this.bufferPool.unshift(t),!0;var e=this.bufferPool.getLast();if(t.no-e.no==1)return this.bufferPool.push(t),!0;if(this.bufferPool.indexOfByKey("no",t.no))return!0;this.bufferPool.splice(0,this.bufferPool.length)}this.bufferPool.push(t)}},{key:"removeBufferPool",value:function(t){this.bufferPool.splice(0,t+1)}},{key:"removeBufferByNo",value:function(t){var e=this.bufferPool.indexOfByKey("no",t);if(!(e<=-1))return this.removeBufferPool(e),this.bufferPool.length?this.bufferPool.getLast().no<this.segmentPool.getLast().no&&this.loadSegmentByNo(this.bufferPool.getLast().no+1):t<this.segmentPool.getLast().no&&this.loadSegmentByNo(t+1),!0}},{key:"clear",value:function(){this.sourceData={},this.readBufferNo=null,this.currentSeekTime=null,this.bufferPool.length=0,this.segmentPool.length=0}},{key:"getSegmentByNo",value:function(t){return this.segmentPool.get(t-1)}},{key:"getSegment",value:function(t){return this.segmentPool.getByTime(t)}},{key:"setSourceData",value:function(t){this.sourceData=t}},{key:"getSourceData",value:function(){return this.sourceData}},{key:"setBufferPool",value:function(t){this.bufferPool=t}},{key:"getBufferPool",value:function(){return this.bufferPool}},{key:"setSegmentPool",value:function(t){this.segmentPool=t}},{key:"getSegmentPool",value:function(){return this.segmentPool}}]),n}(U);function kt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p()(t);if(e){var i=p()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}var Pt=function(t){c()(n,t);var e=kt(n);function n(t){var r;return i()(this,n),r=e.call(this),v()(u()(r),"loadData",null),r.options=t,r}return o()(n,[{key:"setLoadData",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.loadData=C()(bt,e)}},{key:"getLoadData",value:function(){return this.loadData}},{key:"getLoadDataBufferPool",value:function(){return this.loadData.bufferPool}},{key:"setLoadDataSourceData",value:function(t){this.loadData.setSourceData(t)}},{key:"setLoadDataSegmentPool",value:function(t){this.loadData.setSegmentPool(t)}},{key:"startLoad",value:function(t){t=Math.max(t,0),this.startLoadData(t)}},{key:"startLoadData",value:function(t){this.loadData.startLoad(t)}},{key:"clearLoadData",value:function(){this.loadData.clear()}},{key:"getDataInstance",value:function(t){if(t)switch(t){case"load":if(!this.loadData){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];this.setLoadData.apply(this,n)}return this.loadData;default:return null}}}]),n}(A);function wt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p()(t);if(e){var i=p()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}var xt,_t,Bt=function(t){c()(n,t);var e=wt(n);function n(t){var r;return i()(this,n),r=e.call(this,t),v()(u()(r),"checkHanlder",null),v()(u()(r),"resetStatus",{processor:!1,audioPlayer:!1}),r.player=t.player,r.player?(r.audioPlayer=t.audioPlayer,r.imagePlayer=t.imagePlayer,r.loadData=t.loadData,r.bindEvent(),r):f()(r)}return o()(n,[{key:"bindEvent",value:function(){var t=this;this.events.on(st.ProcessorResetEnd,(function(){t.checkResetReady("processor")})),this.events.on(st.AudioPlayerReady,(function(){t.checkResetReady("audioPlayer")})),this.events.on(st.PlayerResetReady,(function(){t.onResetReady()})),this.events.on(st.LoadDataSeek,(function(e,n){t.onSeek(e,n)})),this.events.on(st.ImagePlayerRenderEnd,(function(e,n){t.onRenderEnd(e,n)})),this.events.on(st.ImagePlayerWait,(function(){t.audioPlayer.pause()}))}},{key:"play",value:function(t){this.logger.warn("play","play start"),this.sync(t)}},{key:"sync",value:function(t){var e=this.player,n=this.audioPlayer,r=this.imagePlayer,i=n.offset,a=r.offset,o=Math.min(i,a),s=Math.max(i,a);n.need||(o=a,s=a);var u=e.playbackRate;if(e.seeking&&(e.seeking=!1),!e.reseting&&"pause"!==e.status&&"waiting"!==n.status&&"wait"!==r.status)if("end"!==e.status){if(this.setCurrentTime(t),!(t<o))return n.need&&t>=i&&t<=a?(this.events.once(st.AudioPlayerPlaySuccess,(function(){r.render(a)})),n.playbackRate=u,void n.play()):void(t>=a&&(!n.need||t<=i)?r.render(t):t>s&&(this.audioPlayer.playbackRate=u,this.audioPlayer.play(),r.render(t)));this.sync(o)}else n.paused||n.pause()}},{key:"setCurrentTime",value:function(t){this.player.currentTime=t,this.events.emit(st.PlayerTimeUpdate,t)}},{key:"pause",value:function(){this.audioPlayer.pause(),this.clearDrawHanlder()}},{key:"seek",value:function(t){var e=this,n=this.imagePlayer.isBuffered(t),r=this.audioPlayer.isBuffered(t);this.player.pause(),n&&r?(this.logger.warn("seek","seek in buffer, time: ".concat(t,", buffer: ").concat(this.player.buffer()[0],", ").concat(this.player.buffer()[1])),this.audioPlayer.onSeekedHandler=function(){e.player.play()},this.audioPlayer.currentTime=t):this.reset()}},{key:"reset",value:function(t){this.logger.info("reset","reset start"),this.player.reseting=!0,this.events.emit(st.PlayerReset,t),this.resetStatus={processor:!1,audioPlayer:!1},this.player.processController.reset(),this.player.streamController.reset(),this.player.audioPlayer.reset(t),this.player.imagePlayer.reset(),this.player.currentIndex=null}},{key:"checkResetReady",value:function(t){var e=this.resetStatus;if(t&&"string"==typeof t){e[t]=!0;for(var n=Object.keys(e),r=0;r<n.length;r++)if(!e[n[r]])return!1;this.logger.warn("checkResetReady","reset ready"),this.events.emit(st.PlayerResetReady)}}},{key:"onResetReady",value:function(){this.player.reseting=!1,this.logger.info("onResetReady","reset Ready"),this.player.changing&&this.events.emit(st.DataProcessorReady),this.player.seeking&&this.player.loadData.seekTime(this.player.currentTime/1e3)}},{key:"onSeek",value:function(t,e){var n=this.player.currentTime;this.logger.info("onseek",n,t,t.no,e),t&&t.no&&Math.abs(n-Math.floor(1e3*e))<2?(this.player.currentIndex=t.no,this.logger.info("seektime:",t.no,e,this.player.currentTime),this.player.seekSegmentNo=t.no,this.player.streamController.startLoad(t.no)):this.logger.warn("seek failue, not found data",n,t,e)}},{key:"clearDrawHanlder",value:function(){clearTimeout(this.drawFrameHanlder),this.drawFrameHanlder=null}},{key:"onRenderEnd",value:function(t,e){this.player.seekTime&&(this.logger.info("onRenderEnd","seektoRenderTime:",Date.now()-this.player.seekTime),this.player.seekTime=null);var n=this.imagePlayer,r=this.audioPlayer,i=this.player.playbackRate,a=r.currentTime,o=n.currentTime,s=r.offset,u=n.fragDuration,l=a-o,c=0;r.need?o<s?this.drawNext(o+u*i,u):(l>0&&l>u?u=(c=o+Math.ceil(l/u+i)*u)-a:(c=o+u*i,u-=l),this.drawNext(c,u)):this.drawNext(t+e,Math.ceil(e/i))}},{key:"drawNext",value:function(t,e){var n=this;this.drawFrameHanlder&&this.clearDrawHanlder(),this.drawFrameHanlder=setTimeout((function(){n.sync(t)}),e)}}]),n}(U);function Tt(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return Et(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Et(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function Et(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function St(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p()(t);if(e){var i=p()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}function Rt(t){if(xt){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];xt.apply(void 0,[t].concat(n))}}function Lt(t){if(_t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];_t.apply(void 0,[t].concat(n))}}var Dt=function(){function t(e){i()(this,t),this.payload=e,this.nri=(96&this.payload[0])>>5,this.ntype=31&this.payload[0]}return o()(t,null,[{key:"type",value:function(e){return e.ntype in t.TYPES?t.TYPES[e.ntype]:"UNKNOWN"}},{key:"NDR",get:function(){return 1}},{key:"IDR",get:function(){return 5}},{key:"SEI",get:function(){return 6}},{key:"SPS",get:function(){return 7}},{key:"PPS",get:function(){return 8}},{key:"AUD",get:function(){return 9}},{key:"TYPES",get:function(){var e;return e={},v()(e,t.IDR,"IDR"),v()(e,t.SEI,"SEI"),v()(e,t.SPS,"SPS"),v()(e,t.PPS,"PPS"),v()(e,t.NDR,"NDR"),v()(e,t.AUD,"AUD"),e}}]),o()(t,[{key:"toString",value:function(){return"".concat(t.type(this),": NRI: ").concat(this.getNri())}},{key:"getNri",value:function(){return this.nri>>6}},{key:"type",value:function(){return this.ntype}},{key:"isKeyframe",value:function(){return this.ntype==t.IDR}},{key:"getSize",value:function(){return 4+this.payload.byteLength}},{key:"getData",value:function(){var t=new Uint8Array(this.getSize());return new DataView(t.buffer).setUint32(0,this.getSize()-4),t.set(this.payload,4),t}}]),t}(),Ct=function(){function t(e){i()(this,t),this.data=e,this.index=0,this.bitLength=8*e.byteLength}return o()(t,[{key:"skipBits",value:function(t){if(this.bitsAvailable<t)return!1;this.index+=t}},{key:"readBits",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.getBits(t,this.index,e);return n}},{key:"getBits",value:function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(this.bitsAvailable<t)return 0;var r=e%8,i=this.data[e/8|0]&255>>>r,a=8-r;if(a>=t)return n&&(this.index+=t),i>>a-t;n&&(this.index+=a);var o=t-a;return i<<o|this.getBits(o,e+a,n)}},{key:"skipLZ",value:function(){var t;for(t=0;t<this.bitLength-this.index;++t)if(0!==this.getBits(1,this.index+t,!1))return this.index+=t,t;return t}},{key:"skipUEG",value:function(){this.skipBits(1+this.skipLZ())}},{key:"skipEG",value:function(){this.skipBits(1+this.skipLZ())}},{key:"readUEG",value:function(){var t=this.skipLZ();return this.readBits(t+1)-1}},{key:"readEG",value:function(){var t=this.readUEG();return 1&t?1+t>>>1:-1*(t>>>1)}},{key:"readBoolean",value:function(){return 1===this.readBits(1)}},{key:"readUByte",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.readBits(8*t)}},{key:"readUShort",value:function(){return this.readBits(16)}},{key:"readUInt",value:function(){return this.readBits(32)}},{key:"bitsAvailable",get:function(){return this.bitLength-this.index}}]),t}(),At=function(){function t(e){i()(this,t),this.remuxer=e,this.track=e.mp4track}return o()(t,null,[{key:"extractNALu",value:function(t){for(var e,n,r=0,i=t.byteLength,a=0,o=[];r<i;)switch(e=t[r++],a){case 0:0===e&&(a=1);break;case 1:a=0===e?2:0;break;case 2:case 3:0===e?a=3:1===e&&r<i?(n&&o.push(t.subarray(n,r-a-1)),n=r,a=0):a=0}return n&&o.push(t.subarray(n,i)),o}},{key:"skipScalingList",value:function(t,e){for(var n=8,r=8,i=0;i<e;i++)0!==r&&(r=(n+t.readEG()+256)%256),n=0===r?n:r}},{key:"readSPS",value:function(e){var n,r,i,a,o,s,u=new Ct(e),l=0,c=0,h=0,f=0,d=1;if(u.readUByte(),n=u.readUByte(),u.readBits(5),u.skipBits(3),u.readUByte(),u.skipUEG(),100===n||110===n||122===n||244===n||44===n||83===n||86===n||118===n||128===n){var p=u.readUEG();if(3===p&&u.skipBits(1),u.skipUEG(),u.skipUEG(),u.skipBits(1),u.readBoolean()){s=3!==p?8:12;for(var y=0;y<s;++y)u.readBoolean()&&(y<6?t.skipScalingList(u,16):t.skipScalingList(u,64))}}u.skipUEG();var v=u.readUEG();if(0===v)u.readUEG();else if(1===v){u.skipBits(1),u.skipEG(),u.skipEG(),r=u.readUEG();for(var g=0;g<r;++g)u.skipEG()}if(u.skipUEG(),u.skipBits(1),i=u.readUEG(),a=u.readUEG(),0===(o=u.readBits(1))&&u.skipBits(1),u.skipBits(1),u.readBoolean()&&(l=u.readUEG(),c=u.readUEG(),h=u.readUEG(),f=u.readUEG()),u.readBoolean()){if(u.readBoolean()){var m;switch(u.readUByte()){case 1:m=[1,1];break;case 2:m=[12,11];break;case 3:m=[10,11];break;case 4:m=[16,11];break;case 5:m=[40,33];break;case 6:m=[24,11];break;case 7:m=[20,11];break;case 8:m=[32,11];break;case 9:m=[80,33];break;case 10:m=[18,11];break;case 11:m=[15,11];break;case 12:m=[64,33];break;case 13:m=[160,99];break;case 14:m=[4,3];break;case 15:m=[3,2];break;case 16:m=[2,1];break;case 255:m=[u.readUByte()<<8|u.readUByte(),u.readUByte()<<8|u.readUByte()]}m&&(d=m[0]/m[1])}if(u.readBoolean()&&u.skipBits(1),u.readBoolean()&&(u.skipBits(4),u.readBoolean()&&u.skipBits(24)),u.readBoolean()&&(u.skipUEG(),u.skipUEG()),u.readBoolean())u.readUInt(),u.readUInt(),u.readBoolean()}return{width:Math.ceil((16*(i+1)-2*l-2*c)*d),height:(2-o)*(a+1)*16-(o?2:4)*(h+f)}}}]),o()(t,[{key:"parseSPS",value:function(e){var n=t.readSPS(new Uint8Array(e));this.track.width=n.width,this.track.height=n.height,this.track.sps=[new Uint8Array(e)],this.track.codec="avc1.";for(var r=new DataView(e.buffer,e.byteOffset+1,4),i=0;i<3;++i){var a=r.getUint8(i).toString(16);a.length<2&&(a="0"+a),this.track.codec+=a}}},{key:"parsePPS",value:function(t){this.track.pps=[new Uint8Array(t)]}},{key:"parseNAL",value:function(t){if(!t)return!1;var e=!1;switch(t.type()){case Dt.NDR:case Dt.IDR:e=!0;break;case Dt.PPS:this.track.pps||(this.parsePPS(t.getData().subarray(4)),!this.remuxer.readyToDecode&&this.track.pps&&this.track.sps&&(this.remuxer.readyToDecode=!0)),e=!0;break;case Dt.SPS:this.track.sps||(this.parseSPS(t.getData().subarray(4)),!this.remuxer.readyToDecode&&this.track.pps&&this.track.sps&&(this.remuxer.readyToDecode=!0)),e=!0;break;case Dt.AUD:Rt("AUD - ignoing and disable HD mode for live channel"),this.remuxer.isHDAvail&&(this.remuxer.isHDAvail=!1);break;case Dt.SEI:Rt("SEI - ignoing")}return e}}]),t}(),Ot=function(){function t(e){i()(this,t),this.listener={},this.type=""|e}return o()(t,[{key:"on",value:function(t,e){return this.listener[t]||(this.listener[t]=[]),this.listener[t].push(e),!0}},{key:"off",value:function(t,e){if(this.listener[t]){var n=this.listener[t].indexOf(e);return n>-1&&this.listener[t].splice(n,1),!0}return!1}},{key:"offAll",value:function(){this.listener={}}},{key:"dispatch",value:function(t,e){return!!this.listener[t]&&(this.listener[t].map((function(t){t.apply(null,[e])})),!0)}}]),t}(),Mt=Math.pow(2,32)-1,It=function(){function t(){i()(this,t)}return o()(t,null,[{key:"init",value:function(){var e;for(e in t.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]},t.types)t.types.hasOwnProperty(e)&&(t.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);var n=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),r=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);t.HDLR_TYPES={video:n,audio:r};var i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),a=new Uint8Array([0,0,0,0,0,0,0,0]);t.STTS=t.STSC=t.STCO=a,t.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),t.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),t.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),t.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var o=new Uint8Array([105,115,111,109]),s=new Uint8Array([97,118,99,49]),u=new Uint8Array([0,0,0,1]);t.FTYP=t.box(t.types.ftyp,o,u,o,s),t.DINF=t.box(t.types.dinf,t.box(t.types.dref,i))}},{key:"box",value:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];for(var i,a=8,o=n.length,s=o;o--;)a+=n[o].byteLength;for((i=new Uint8Array(a))[0]=a>>24&255,i[1]=a>>16&255,i[2]=a>>8&255,i[3]=255&a,i.set(t,4),o=0,a=8;o<s;++o)i.set(n[o],a),a+=n[o].byteLength;return i}},{key:"hdlr",value:function(e){return t.box(t.types.hdlr,t.HDLR_TYPES[e])}},{key:"mdat",value:function(e){return t.box(t.types.mdat,e)}},{key:"mdhd",value:function(e,n){n*=e;var r=Math.floor(n/(Mt+1)),i=Math.floor(n%(Mt+1));return t.box(t.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,r>>24,r>>16&255,r>>8&255,255&r,i>>24,i>>16&255,i>>8&255,255&i,85,196,0,0]))}},{key:"mdia",value:function(e){return t.box(t.types.mdia,t.mdhd(e.timescale,e.duration),t.hdlr(e.type),t.minf(e))}},{key:"mfhd",value:function(e){return t.box(t.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,255&e]))}},{key:"minf",value:function(e){return"audio"===e.type?t.box(t.types.minf,t.box(t.types.smhd,t.SMHD),t.DINF,t.stbl(e)):t.box(t.types.minf,t.box(t.types.vmhd,t.VMHD),t.DINF,t.stbl(e))}},{key:"moof",value:function(e,n,r){return t.box(t.types.moof,t.mfhd(e),t.traf(r,n))}},{key:"moov",value:function(e,n,r){for(var i=e.length,a=[];i--;)a[i]=t.trak(e[i]);return t.box.apply(null,[t.types.moov,t.mvhd(r,n)].concat(a).concat(t.mvex(e)))}},{key:"mvex",value:function(e){for(var n=e.length,r=[];n--;)r[n]=t.trex(e[n]);return t.box.apply(null,[t.types.mvex].concat(r))}},{key:"mvhd",value:function(e,n){n*=e;var r=Math.floor(n/(Mt+1)),i=Math.floor(n%(Mt+1)),a=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,r>>24,r>>16&255,r>>8&255,255&r,i>>24,i>>16&255,i>>8&255,255&i,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return t.box(t.types.mvhd,a)}},{key:"sdtp",value:function(e){var n,r,i=e.samples||[],a=new Uint8Array(4+i.length);for(r=0;r<i.length;r++)n=i[r].flags,a[r+4]=n.dependsOn<<4|n.isDependedOn<<2|n.hasRedundancy;return t.box(t.types.sdtp,a)}},{key:"stbl",value:function(e){return t.box(t.types.stbl,t.stsd(e),t.box(t.types.stts,t.STTS),t.box(t.types.stsc,t.STSC),t.box(t.types.stsz,t.STSZ),t.box(t.types.stco,t.STCO))}},{key:"avc1",value:function(e){var n,r,i,a=[],o=[];for(n=0;n<e.sps.length;n++)i=(r=e.sps[n]).byteLength,a.push(i>>>8&255),a.push(255&i),a=a.concat(Array.prototype.slice.call(r));for(n=0;n<e.pps.length;n++)i=(r=e.pps[n]).byteLength,o.push(i>>>8&255),o.push(255&i),o=o.concat(Array.prototype.slice.call(r));var s=t.box(t.types.avcC,new Uint8Array([1,a[3],a[4],a[5],255,224|e.sps.length].concat(a).concat([e.pps.length]).concat(o))),u=e.width,l=e.height;return t.box(t.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,u>>8&255,255&u,l>>8&255,255&l,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,98,105,110,101,108,112,114,111,46,114,117,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),s,t.box(t.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])))}},{key:"esds",value:function(t){var e=t.config.byteLength,n=new Uint8Array(26+e+3);return n.set([0,0,0,0,3,23+e,0,1,0,4,15+e,64,21,0,0,0,0,0,0,0,0,0,0,0,5,e]),n.set(t.config,26),n.set([6,1,2],26+e),n}},{key:"mp4a",value:function(e){var n=e.audiosamplerate;return t.box(t.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,n>>8&255,255&n,0,0]),t.box(t.types.esds,t.esds(e)))}},{key:"stsd",value:function(e){return"audio"===e.type?t.box(t.types.stsd,t.STSD,t.mp4a(e)):t.box(t.types.stsd,t.STSD,t.avc1(e))}},{key:"tkhd",value:function(e){var n=e.id,r=e.duration*e.timescale,i=e.width,a=e.height,o=Math.floor(r/(Mt+1)),s=Math.floor(r%(Mt+1));return t.box(t.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,n>>24&255,n>>16&255,n>>8&255,255&n,0,0,0,0,o>>24,o>>16&255,o>>8&255,255&o,s>>24,s>>16&255,s>>8&255,255&s,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,i>>8&255,255&i,0,0,a>>8&255,255&a,0,0]))}},{key:"traf",value:function(e,n){var r=t.sdtp(e),i=e.id,a=Math.floor(n/(Mt+1)),o=Math.floor(n%(Mt+1));return t.box(t.types.traf,t.box(t.types.tfhd,new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,255&i])),t.box(t.types.tfdt,new Uint8Array([1,0,0,0,a>>24,a>>16&255,a>>8&255,255&a,o>>24,o>>16&255,o>>8&255,255&o])),t.trun(e,r.length+16+20+8+16+8+8),r)}},{key:"trak",value:function(e){return e.duration=e.duration||4294967295,t.box(t.types.trak,t.tkhd(e),t.mdia(e))}},{key:"trex",value:function(e){var n=e.id;return t.box(t.types.trex,new Uint8Array([0,0,0,0,n>>24,n>>16&255,n>>8&255,255&n,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}},{key:"trun",value:function(e,n){var r,i,a,o,s,u,l=e.samples||[],c=l.length,h=12+16*c,f=new Uint8Array(h);for(n+=8+h,f.set([0,0,15,1,c>>>24&255,c>>>16&255,c>>>8&255,255&c,n>>>24&255,n>>>16&255,n>>>8&255,255&n],0),r=0;r<c;r++)a=(i=l[r]).duration,o=i.size,s=i.flags,u=i.cts,f.set([a>>>24&255,a>>>16&255,a>>>8&255,255&a,o>>>24&255,o>>>16&255,o>>>8&255,255&o,s.isLeading<<2|s.dependsOn,s.isDependedOn<<6|s.hasRedundancy<<4|s.paddingValue<<1|s.isNonSync,61440&s.degradPrio,15&s.degradPrio,u>>>24&255,u>>>16&255,u>>>8&255,255&u],12+16*r);return t.box(t.types.trun,f)}},{key:"initSegment",value:function(e,n,r){t.types||t.init();var i,a=t.moov(e,n,r);return(i=new Uint8Array(t.FTYP.byteLength+a.byteLength)).set(t.FTYP),i.set(a,t.FTYP.byteLength),i}}]),t}(),Ut=function(){function t(e){i()(this,t),this.remuxer=e,this.track=e.mp4track,this.aacHeader=null}return o()(t,[{key:"getHeaderLength",value:function(t){return 1&t[1]?7:9}},{key:"getFrameLength",value:function(t){return(3&t[3])<<11|t[4]<<3|(224&t[5])>>>5}},{key:"isAACPattern",value:function(t){return 255===t[0]&&240==(240&t[1])&&0==(6&t[1])}},{key:"extractAAC",value:function(t){var e,n,r=0,i=t.byteLength,a=[];if(!this.isAACPattern(t))return Lt("Invalid ADTS audio format"),a;for(e=this.getHeaderLength(t),this.aacHeader||(this.aacHeader=t.subarray(0,e));r<i;)n=this.getFrameLength(t),a.push(t.subarray(e,n)),t=t.slice(n),r+=n;return a}},{key:"samplingRateMap",get:function(){return[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350]}},{key:"getAACHeaderData",get:function(){return this.aacHeader}},{key:"setAACHeaderData",set:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.aacHeader=t}}]),o()(t,[{key:"setAACConfig",value:function(){var t,e,n,r=new Uint8Array(2),i=this.getAACHeaderData;i&&(t=1+((192&i[2])>>>6),e=(60&i[2])>>>2,n=(1&i[2])<<2,n|=(192&i[3])>>>6,r[0]=t<<3,r[0]|=(14&e)>>1,r[1]|=(1&e)<<7,r[1]|=n<<3,this.track.codec="mp4a.40."+t,this.track.channelCount=n,this.track.config=r,this.remuxer.readyToDecode=!0)}}]),t}(),Nt=1,Ht=function(){function t(){i()(this,t),this.seq=1}return o()(t,null,[{key:"getTrackID",value:function(){return Nt++}}]),o()(t,[{key:"flush",value:function(){this.seq++,this.mp4track.len=0,this.mp4track.samples=[]}},{key:"isReady",value:function(){return!(!this.readyToDecode||!this.samples.length)||null}}]),t}(),Ft=function(t){c()(n,t);var e=St(n);function n(){var t;return i()(this,n),(t=e.call(this)).readyToDecode=!1,t.nextDts=0,t.dts=0,t.timescale=1e3,t.mp4track={id:Ht.getTrackID(),type:"audio",channelCount:0,len:0,fragmented:!0,timescale:t.timescale,duration:t.timescale,samples:[],config:"",codec:""},t.samples=[],t.aac=new Ut(u()(t)),t}return o()(n,[{key:"resetTrack",value:function(){this.readyToDecode=!1,this.mp4track.codec="",this.mp4track.channelCount="",this.mp4track.config="",this.mp4track.timescale=this.timescale}},{key:"remux",value:function(t){var e,n,r,i=Tt(t);try{for(i.s();!(r=i.n()).done;){var a=r.value;e=(n=a.units).byteLength,this.samples.push({units:n,size:e,duration:a.duration}),this.mp4track.len+=e,this.readyToDecode||this.aac.setAACConfig()}}catch(t){i.e(t)}finally{i.f()}}},{key:"getPayload",value:function(){if(!this.isReady())return null;var t,e,n=new Uint8Array(this.mp4track.len),r=0,i=this.mp4track.samples;for(this.dts=this.nextDts;this.samples.length;){var a=this.samples.shift();(e=a.duration)<=0?(Rt("remuxer: invalid sample duration at DTS: ".concat(this.nextDts," :").concat(e)),this.mp4track.len-=a.size):(this.nextDts+=e,t={size:a.size,duration:e,cts:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},n.set(a.units,r),r+=a.size,i.push(t))}return i.length?new Uint8Array(n.buffer,0,this.mp4track.len):null}}]),n}(Ht),jt=function(t){c()(n,t);var e=St(n);function n(){var t;return i()(this,n),(t=e.call(this)).readyToDecode=!1,t.nextDts=0,t.dts=0,t.timescale=1e3,t.mp4track={id:Ht.getTrackID(),type:"video",len:0,fragmented:!0,sps:"",pps:"",width:0,height:0,timescale:t.timescale,duration:t.timescale,samples:[]},t.samples=[],t.h264=new At(u()(t)),t}return o()(n,[{key:"resetTrack",value:function(){this.readyToDecode=!1,this.mp4track.sps="",this.mp4track.pps=""}},{key:"remux",value:function(t){var e,n,r,i,a,o,s=Tt(t);try{for(s.s();!(o=s.n()).done;){e=o.value,n=[],i=0,a=!1;var u,l=Tt(e.units);try{for(l.s();!(u=l.n()).done;)r=u.value,this.h264.parseNAL(r)&&(n.push(r),i+=r.getSize(),a||(a=r.isKeyframe()))}catch(t){l.e(t)}finally{l.f()}n.length>0&&this.readyToDecode&&(this.mp4track.len+=i,this.samples.push({units:n,size:i,keyFrame:a,duration:e.duration}))}}catch(t){s.e(t)}finally{s.f()}}},{key:"getPayload",value:function(){if(!this.isReady())return null;var t,e,n=new Uint8Array(this.mp4track.len),r=0,i=this.mp4track.samples;for(this.dts=this.nextDts;this.samples.length;){var a=this.samples.shift(),o=a.units;if((e=a.duration)<=0)Rt("remuxer: invalid sample duration at DTS: ".concat(this.nextDts," :").concat(e)),this.mp4track.len-=a.size;else{this.nextDts+=e,t={size:a.size,duration:e,cts:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,isNonSync:a.keyFrame?0:1,dependsOn:a.keyFrame?2:1}};var s,u=Tt(o);try{for(u.s();!(s=u.n()).done;){var l=s.value;n.set(l.getData(),r),r+=l.getSize()}}catch(t){u.e(t)}finally{u.f()}i.push(t)}}return i.length?new Uint8Array(n.buffer,0,this.mp4track.len):null}}]),n}(Ht);function Wt(t,e){var n=new Uint8Array((0|t.byteLength)+(0|e.byteLength));return n.set(t,0),n.set(e,0|t.byteLength),n}var Vt=function(t){c()(n,t);var e=St(n);function n(t){var r;return i()(this,n),(r=e.call(this,"remuxer")).initialized=!1,r.trackTypes=[],r.tracks={},r.mediaDuration=t?1/0:1e3,r}return o()(n,[{key:"addTrack",value:function(t){"video"!==t&&"both"!==t||(this.tracks.video=new jt,this.trackTypes.push("video")),"audio"!==t&&"both"!==t||(this.tracks.audio=new Ft,this.trackTypes.push("audio"))}},{key:"reset",value:function(){var t,e=Tt(this.trackTypes);try{for(e.s();!(t=e.n()).done;){var n=t.value;this.tracks[n].resetTrack()}}catch(t){e.e(t)}finally{e.f()}this.initialized=!1}},{key:"destroy",value:function(){this.tracks={},this.offAll()}},{key:"flush",value:function(){if(this.initialized){var t,e=Tt(this.trackTypes);try{for(e.s();!(t=e.n()).done;){var n=t.value,r=this.tracks[n],i=r.getPayload();if(i&&i.byteLength){var a={type:n,payload:Wt(It.moof(r.seq,r.dts,r.mp4track),It.mdat(i)),dts:r.dts};this.dispatch("buffer",a);var o=(f=r.dts/1e3,d=void 0,p=void 0,y=void 0,v=void 0,v="",d=Math.floor(f),(p=parseInt(d/3600,10)%24)>0&&(v+=(p<10?"0"+p:p)+":"),v+=((y=parseInt(d/60,10)%60)<10?"0"+y:y)+":"+((d=d<0?0:d%60)<10?"0"+d:d));Rt("put segment (".concat(n,"): ").concat(r.seq," dts: ").concat(r.dts," samples: ").concat(r.mp4track.samples.length," second: ").concat(o)),r.flush()}}}catch(t){e.e(t)}finally{e.f()}}else if(this.isReady()){this.dispatch("ready");var s,u=Tt(this.trackTypes);try{for(u.s();!(s=u.n()).done;){var l=s.value,c=this.tracks[l],h={type:l,payload:It.initSegment([c.mp4track],this.mediaDuration,c.mp4track.timescale)};this.dispatch("buffer",h)}}catch(t){u.e(t)}finally{u.f()}Rt("Initial segment generated."),this.initialized=!0}var f,d,p,y,v}},{key:"isReady",value:function(){var t,e=Tt(this.trackTypes);try{for(e.s();!(t=e.n()).done;){var n=t.value;if(!this.tracks[n].readyToDecode||!this.tracks[n].samples.length)return!1}}catch(t){e.e(t)}finally{e.f()}return!0}},{key:"remux",value:function(t){var e,n=Tt(this.trackTypes);try{for(n.s();!(e=n.n()).done;){var r=e.value,i=t[r];"audio"===r&&this.tracks.video&&!this.tracks.video.readyToDecode||i.length>0&&this.tracks[r].remux(i)}}catch(t){n.e(t)}finally{n.f()}this.flush()}}]),n}(Ot),zt=function(t){c()(n,t);var e=St(n);function n(t,r){var a;return i()(this,n),(a=e.call(this,"buffer")).type=r,a.queue=new Uint8Array,a.cleaning=!1,a.pendingCleaning=0,a.cleanOffset=30,a.cleanRanges=[],a.sourceBuffer=t,a.sourceBuffer.addEventListener("updateend",(function(){a.dispatch("updateend",Date.now()),a.pendingCleaning>0&&(a.initCleanup(a.pendingCleaning),a.pendingCleaning=0),a.cleaning=!1,a.cleanRanges.length&&a.doCleanup()})),a.sourceBuffer.addEventListener("error",(function(t){a.dispatch("error",{type:a.type,name:"buffer",error:t})})),a}return o()(n,[{key:"destroy",value:function(){this.queue=null,this.sourceBuffer=null,this.offAll()}},{key:"doCleanup",value:function(){if(this.cleanRanges.length){var t=this.cleanRanges.shift();Rt("".concat(this.type," remove range [").concat(t[0]," - ").concat(t[1],")")),this.cleaning=!0,this.sourceBuffer.remove(t[0],t[1]),this.dispatch("clearBuffer")}else this.cleaning=!1}},{key:"initCleanup",value:function(t){if(this.sourceBuffer.updating)this.pendingCleaning=t;else if(this.sourceBuffer.buffered&&this.sourceBuffer.buffered.length&&!this.cleaning){for(var e=0;e<this.sourceBuffer.buffered.length;++e){var n=this.sourceBuffer.buffered.start(e),r=this.sourceBuffer.buffered.end(e);t-n>this.cleanOffset&&n<(r=t-this.cleanOffset)&&this.cleanRanges.push([n,r])}this.doCleanup()}}},{key:"doAppend",value:function(){if(this.queue.length&&!this.sourceBuffer.updating)try{this.sourceBuffer.appendBuffer(this.queue),this.queue=new Uint8Array}catch(t){if("QuotaExceededError"===t.name)return Rt("".concat(this.type," buffer quota full")),void this.dispatch("error",{type:this.type,name:"QuotaExceeded",error:"buffer error"});Lt("Error occured while appending ".concat(this.type," buffer -  ").concat(t.name,": ").concat(t.message)),this.dispatch("error",{type:this.type,name:"unexpectedError",error:"buffer error"})}}},{key:"feed",value:function(t){this.queue=Wt(this.queue,t)}}]),n}(Ot);window.MediaSource=window.MediaSource||window.WebKitMediaSource;var Xt=function(t){c()(n,t);var e=St(n);function n(t){var r;i()(this,n),r=e.call(this,"jmuxer"),window.MediaSource=window.MediaSource||window.WebKitMediaSource;if(r.options=Object.assign({},{node:"",mode:"both",flushingTime:1500,clearBuffer:!0,onReady:null,fps:30,debug:!1,onClearBuffer:null},t),r.options.debug&&(xt=console.log,_t=console.error),"string"==typeof r.options.node&&""==r.options.node&&Lt("no video element were found to render, provide a valid video element"),r.options.fps||(r.options.fps=30),r.frameDuration=1e3/r.options.fps|0,r.node="string"==typeof r.options.node?document.getElementById(r.options.node):r.options.node,r.sourceBuffers={},r.isMSESupported=!!window.MediaSource,!r.isMSESupported)throw"Oops! Browser does not support media source extension.";return r.setupMSE(),r.remuxController=new Vt(r.options.clearBuffer),r.remuxController.addTrack(r.options.mode),"audio"===r.options.mode&&(r.aacParser=r.remuxController.tracks.audio.aac),r.mseReady=!1,r.lastCleaningTime=Date.now(),r.keyframeCache=[],r.frameCounter=0,r.remuxController.on("buffer",r.onBuffer.bind(u()(r))),r.remuxController.on("ready",r.createBuffer.bind(u()(r))),r.startInterval(),r}return o()(n,null,[{key:"isSupported",value:function(t){return window.MediaSource&&window.MediaSource.isTypeSupported(t)}}]),o()(n,[{key:"setupMSE",value:function(){this.mediaSource=new MediaSource,this.node.src=URL.createObjectURL(this.mediaSource),this.mediaSource.addEventListener("sourceopen",this.onMSEOpen.bind(this)),this.mediaSource.addEventListener("sourceclose",this.onMSEClose.bind(this)),this.mediaSource.addEventListener("webkitsourceopen",this.onMSEOpen.bind(this)),this.mediaSource.addEventListener("webkitsourceclose",this.onMSEClose.bind(this))}},{key:"feed",value:function(t){var e,n,r,i=!1,a={video:[],audio:[]};t&&this.remuxController&&(r=t.duration?parseInt(t.duration):0,t.video&&(e=At.extractNALu(t.video)).length>0&&(a.video=this.getVideoFrames(e,r),i=!0),t.audio&&(n=this.aacParser.extractAAC(t.audio)).length>0&&(a.audio=this.getAudioFrames(n,r),i=!0),i?this.remuxController.remux(a):Lt("Input object must have video and/or audio property. Make sure it is not empty and valid typed array"))}},{key:"getVideoFrames",value:function(t,e){var n,r,i,a,o=[],s=[],u=0,l=[],c=Tt(t);try{for(c.s();!(a=c.n()).done;)n=a.value,r=new Dt(n),o.push(r),r.type()!==Dt.IDR&&r.type()!==Dt.NDR||(s.push({units:o}),o=[],this.options.clearBuffer&&(r.type()===Dt.IDR&&l.push(this.frameCounter),this.frameCounter++))}catch(t){c.e(t)}finally{c.f()}return e?(i=e/s.length|0,u=e-i*s.length):i=this.frameDuration,s.map((function(t){t.duration=u>0?i+1:i,0!==u&&u--})),this.options.clearBuffer&&(l=l.map((function(t){return t*i/1e3})),this.keyframeCache=this.keyframeCache.concat(l)),s}},{key:"getAudioFrames",value:function(t,e){var n,r,i,a=[],o=0,s=Tt(t);try{for(s.s();!(i=s.n()).done;)n=i.value,a.push({units:n})}catch(t){s.e(t)}finally{s.f()}return e?(r=e/a.length|0,o=e-r*a.length):r=this.frameDuration,a.map((function(t){t.duration=o>0?r+1:r,0!==o&&o--})),a}},{key:"destroy",value:function(){if(this.aacParser=null,this.stopInterval(),this.mediaSource){try{this.bufferControllers&&(this.mediaSource.endOfStream(),this.removeSourceBuffer())}catch(t){Lt("mediasource is not available to end ".concat(t.message))}this.mediaSource=null}if(this.remuxController&&(this.remuxController.destroy(),this.remuxController=null),this.bufferControllers){for(var t in this.bufferControllers)this.bufferControllers[t].destroy();this.bufferControllers=null}this.node=!1,this.mseReady=!1,this.videoStarted=!1}},{key:"createBuffer",value:function(){if(this.mseReady&&this.remuxController&&this.remuxController.isReady()&&!this.bufferControllers)for(var t in this.bufferControllers={},this.remuxController.tracks){var e=this.remuxController.tracks[t];if(!n.isSupported("".concat(t,'/mp4; codecs="').concat(e.mp4track.codec,'"')))return Lt("Browser does not support codec"),!1;var r=this.mediaSource.addSourceBuffer("".concat(t,'/mp4; codecs="').concat(e.mp4track.codec,'"'));this.bufferControllers[t]=new zt(r,t),this.sourceBuffers[t]=r,this.bufferControllers[t].on("error",this.onBufferError.bind(this)),this.bufferControllers[t].on("clearBuffer",this.onClearBuffer.bind(this)),this.bufferControllers[t].on("updateend",this.onUpdateEnd.bind(this))}}},{key:"onUpdateEnd",value:function(t){"function"==typeof this.options.onUpdateEnd&&this.options.onUpdateEnd(t)}},{key:"startInterval",value:function(){var t=this;this.interval=setInterval((function(){t.bufferControllers&&(t.releaseBuffer(),t.clearBuffer())}),this.options.flushingTime)}},{key:"stopInterval",value:function(){this.interval&&clearInterval(this.interval)}},{key:"releaseBuffer",value:function(){for(var t in this.bufferControllers)this.bufferControllers[t].doAppend()}},{key:"getSafeBufferClearLimit",value:function(t){for(var e,n="audio"===this.options.mode&&t||0,r=0;r<this.keyframeCache.length&&!(this.keyframeCache[r]>=t);r++)e=this.keyframeCache[r];return e&&(this.keyframeCache=this.keyframeCache.filter((function(t){return t<e&&(n=t),t>=e}))),n}},{key:"clearBuffer",value:function(){if(this.options.clearBuffer&&Date.now()-this.lastCleaningTime>1e4){for(var t in this.bufferControllers){var e=this.getSafeBufferClearLimit(this.node.currentTime);this.bufferControllers[t].initCleanup(e)}this.lastCleaningTime=Date.now()}}},{key:"onBuffer",value:function(t){this.bufferControllers&&this.bufferControllers[t.type]&&this.bufferControllers[t.type].feed(t.payload)}},{key:"onClearBuffer",value:function(){"function"==typeof this.options.onClearBuffer&&this.options.onClearBuffer()}},{key:"removeSourceBuffer",value:function(){if(this.mediaSource){var t=this.sourceBuffers;for(var e in t)this.mediaSource.removeSourceBuffer(t[e])}}},{key:"onMSEOpen",value:function(){this.mseReady=!0,this.createBuffer(),"function"==typeof this.options.onReady&&(this.options.onReady(),this.options.onReady=null)}},{key:"onMSEClose",value:function(){this.mseReady=!1,this.videoStarted=!1}},{key:"onBufferError",value:function(t){if("QuotaExceeded"!=t.name){if(this.mediaSource.sourceBuffers.length>0&&this.sourceBuffers[t.type]&&this.mediaSource.removeSourceBuffer(this.sourceBuffers[t.type]),0==this.mediaSource.sourceBuffers.length)try{this.mediaSource.endOfStream()}catch(t){Lt("mediasource is not available to end")}}else this.bufferControllers[t.type].initCleanup(this.node.currentTime)}}]),n}(Ot);function Gt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p()(t);if(e){var i=p()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}var Yt=function(t){c()(n,t);var e=Gt(n);function n(t){var r;return i()(this,n),r=e.call(this,t),v()(u()(r),"source",[]),v()(u()(r),"onPlay",void 0),r.source=t.source,r.onPlay=t.onPlay,r.init(),r}return o()(n,[{key:"init",value:function(){}},{key:"extract",value:function(t,e){for(var n=this.provide(e),r=0;r<n.size;r++)t[2*r]=n.left[r],t[2*r+1]=n.right[r];return n.size}},{key:"provide",value:function(t){for(var e=t,n=new Float32Array(e),r=new Float32Array(e),i=0,a=0,o=0;this.source.length>0;){var s=this.source.shift(),u=s.loadedPosition||0;a=s.startTime+s.duration*u/s.length;var l=Math.min(s.length-u,e-i),c=s.getChannelData(0),h=s.numberOfChannels>1?s.getChannelData(1):s.getChannelData(0);if(n.set(c.slice(u,u+l),i),r.set(h.slice(u,u+l),i),o+=l,i+=l,(u+=l)<s.length){s.loadedPosition=u,this.source.unshift(s);break}}return this.onPlay&&this.onPlay(a),{left:n,right:r,size:o}}}]),n}(U);function $t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function qt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Kt(t,e,n){return e&&qt(t.prototype,e),n&&qt(t,n),t}function Qt(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Jt(t,e)}function Zt(t){return(Zt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Jt(t,e){return(Jt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function te(t,e){return!e||"object"!==S()(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ee(t,e,n){return(ee="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Zt(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}var ne=function(){function t(){$t(this,t),this._vector=new Float32Array,this._position=0,this._frameCount=0}return Kt(t,[{key:"clear",value:function(){this.receive(this._frameCount),this.rewind()}},{key:"put",value:function(t){this._frameCount+=t}},{key:"putSamples",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=2*(e=e||0);n>=0||(n=(t.length-r)/2);var i=2*n;this.ensureCapacity(n+this._frameCount);var a=this.endIndex;this.vector.set(t.subarray(r,r+i),a),this._frameCount+=n}},{key:"putBuffer",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;e=e||0,n>=0||(n=t.frameCount-e),this.putSamples(t.vector,t.position+e,n)}},{key:"receive",value:function(t){t>=0&&!(t>this._frameCount)||(t=this.frameCount),this._frameCount-=t,this._position+=t}},{key:"receiveSamples",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=2*e,r=this.startIndex;t.set(this._vector.subarray(r,r+n)),this.receive(e)}},{key:"extract",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=this.startIndex+2*e,i=2*n;t.set(this._vector.subarray(r,r+i))}},{key:"ensureCapacity",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=parseInt(2*t);if(this._vector.length<e){var n=new Float32Array(e);n.set(this._vector.subarray(this.startIndex,this.endIndex)),this._vector=n,this._position=0}else this.rewind()}},{key:"ensureAdditionalCapacity",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.ensureCapacity(this._frameCount+t)}},{key:"rewind",value:function(){this._position>0&&(this._vector.set(this._vector.subarray(this.startIndex,this.endIndex)),this._position=0)}},{key:"vector",get:function(){return this._vector}},{key:"position",get:function(){return this._position}},{key:"startIndex",get:function(){return 2*this._position}},{key:"frameCount",get:function(){return this._frameCount}},{key:"endIndex",get:function(){return 2*(this._position+this._frameCount)}}]),t}(),re=function(){function t(e){$t(this,t),e?(this._inputBuffer=new ne,this._outputBuffer=new ne):this._inputBuffer=this._outputBuffer=null}return Kt(t,[{key:"clear",value:function(){this._inputBuffer.clear(),this._outputBuffer.clear()}},{key:"inputBuffer",get:function(){return this._inputBuffer},set:function(t){this._inputBuffer=t}},{key:"outputBuffer",get:function(){return this._outputBuffer},set:function(t){this._outputBuffer=t}}]),t}(),ie=function(t){function e(t){var n;return $t(this,e),(n=te(this,Zt(e).call(this,t))).reset(),n._rate=1,n}return Qt(e,t),Kt(e,[{key:"reset",value:function(){this.slopeCount=0,this.prevSampleL=0,this.prevSampleR=0}},{key:"clone",value:function(){var t=new e;return t.rate=this._rate,t}},{key:"process",value:function(){var t=this._inputBuffer.frameCount;this._outputBuffer.ensureAdditionalCapacity(t/this._rate+1);var e=this.transpose(t);this._inputBuffer.receive(),this._outputBuffer.put(e)}},{key:"transpose",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(0===t)return 0;for(var e=this._inputBuffer.vector,n=this._inputBuffer.startIndex,r=this._outputBuffer.vector,i=this._outputBuffer.endIndex,a=0,o=0;this.slopeCount<1;)r[i+2*o]=(1-this.slopeCount)*this.prevSampleL+this.slopeCount*e[n],r[i+2*o+1]=(1-this.slopeCount)*this.prevSampleR+this.slopeCount*e[n+1],o+=1,this.slopeCount+=this._rate;if(this.slopeCount-=1,1!==t)t:for(;;){for(;this.slopeCount>1;)if(this.slopeCount-=1,(a+=1)>=t-1)break t;var s=n+2*a;r[i+2*o]=(1-this.slopeCount)*e[s]+this.slopeCount*e[s+2],r[i+2*o+1]=(1-this.slopeCount)*e[s+1]+this.slopeCount*e[s+3],o+=1,this.slopeCount+=this._rate}return this.prevSampleL=e[n+2*t-2],this.prevSampleR=e[n+2*t-1],o}},{key:"rate",set:function(t){this._rate=t}}]),e}(re),ae=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024;$t(this,t),this._pipe=e,this.inputSize=n}return Kt(t,[{key:"fillInputBuffer",value:function(){throw new Error("fillInputBuffer() not overridden")}},{key:"fillOutputBuffer",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=this.inputSize;this.outputBuffer.frameCount<t;){var n=e-this.inputBuffer.frameCount;if(this.fillInputBuffer(n),this.inputBuffer.frameCount<e)break;this._pipe.process()}}},{key:"clear",value:function(){this._pipe.clear()}},{key:"pipe",get:function(){return this._pipe}},{key:"inputBuffer",get:function(){return this._pipe.inputBuffer}},{key:"outputBuffer",get:function(){return this._pipe.outputBuffer}}]),t}(),oe=function(){},se=function(t){function e(t,n){var r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1024,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:oe;return $t(this,e),(r=te(this,Zt(e).call(this,n,i))).callback=a,r.sourceSound=t,r.historyBufferSize=22050,r._sourcePosition=0,r.outputBufferPosition=0,r._position=0,r}return Qt(e,t),Kt(e,[{key:"onEnd",value:function(){this.callback()}},{key:"fillInputBuffer",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=new Float32Array(2*t),n=this.sourceSound.extract(e,t,this._sourcePosition);this._sourcePosition+=n,this.inputBuffer.putSamples(e,0,n)}},{key:"extract",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.fillOutputBuffer(this.outputBufferPosition+e);var n=Math.min(e,this.outputBuffer.frameCount-this.outputBufferPosition);this.outputBuffer.extract(t,this.outputBufferPosition,n);var r=this.outputBufferPosition+n;return this.outputBufferPosition=Math.min(this.historyBufferSize,r),this.outputBuffer.receive(Math.max(r-this.historyBufferSize,0)),this._position+=n,n}},{key:"handleSampleData",value:function(t){this.extract(t.data,4096)}},{key:"clear",value:function(){ee(Zt(e.prototype),"clear",this).call(this),this.outputBufferPosition=0}},{key:"position",get:function(){return this._position},set:function(t){if(t>this._position)throw new RangeError("New position may not be greater than current position");var e=this.outputBufferPosition-(this._position-t);if(e<0)throw new RangeError("New position falls outside of history buffer");this.outputBufferPosition=e,this._position=t}},{key:"sourcePosition",get:function(){return this._sourcePosition},set:function(t){this.clear(),this._sourcePosition=t}}]),e}(ae),ue=[[124,186,248,310,372,434,496,558,620,682,744,806,868,930,992,1054,1116,1178,1240,1302,1364,1426,1488,0],[-100,-75,-50,-25,25,50,75,100,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[-20,-15,-10,-5,5,10,15,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[-4,-3,-2,-1,1,2,3,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],le=function(t){function e(t){var n;return $t(this,e),(n=te(this,Zt(e).call(this,t)))._quickSeek=!0,n.midBufferDirty=!1,n.midBuffer=null,n.overlapLength=0,n.autoSeqSetting=!0,n.autoSeekSetting=!0,n._tempo=1,n.setParameters(44100,0,0,8),n}return Qt(e,t),Kt(e,[{key:"clear",value:function(){ee(Zt(e.prototype),"clear",this).call(this),this.clearMidBuffer()}},{key:"clearMidBuffer",value:function(){this.midBufferDirty&&(this.midBufferDirty=!1,this.midBuffer=null)}},{key:"setParameters",value:function(t,e,n,r){t>0&&(this.sampleRate=t),r>0&&(this.overlapMs=r),e>0?(this.sequenceMs=e,this.autoSeqSetting=!1):this.autoSeqSetting=!0,n>0?(this.seekWindowMs=n,this.autoSeekSetting=!1):this.autoSeekSetting=!0,this.calculateSequenceParameters(),this.calculateOverlapLength(this.overlapMs),this.tempo=this._tempo}},{key:"calculateOverlapLength",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;t=(t=this.sampleRate*e/1e3)<16?16:t,t-=t%8,this.overlapLength=t,this.refMidBuffer=new Float32Array(2*this.overlapLength),this.midBuffer=new Float32Array(2*this.overlapLength)}},{key:"checkLimits",value:function(t,e,n){return t<e?e:t>n?n:t}},{key:"calculateSequenceParameters",value:function(){var t,e;this.autoSeqSetting&&(t=150+-50*this._tempo,t=this.checkLimits(t,50,125),this.sequenceMs=Math.floor(t+.5)),this.autoSeekSetting&&(e=25- -10/1.5*.5+-10/1.5*this._tempo,e=this.checkLimits(e,15,25),this.seekWindowMs=Math.floor(e+.5)),this.seekWindowLength=Math.floor(this.sampleRate*this.sequenceMs/1e3),this.seekLength=Math.floor(this.sampleRate*this.seekWindowMs/1e3)}},{key:"clone",value:function(){var t=new e;return t.tempo=this._tempo,t.setParameters(this.sampleRate,this.sequenceMs,this.seekWindowMs,this.overlapMs),t}},{key:"seekBestOverlapPosition",value:function(){return this._quickSeek?this.seekBestOverlapPositionStereoQuick():this.seekBestOverlapPositionStereo()}},{key:"seekBestOverlapPositionStereo",value:function(){var t,e,n,r=0;for(this.preCalculateCorrelationReferenceStereo(),t=0,e=Number.MIN_VALUE;r<this.seekLength;r+=1)(n=this.calculateCrossCorrelationStereo(2*r,this.refMidBuffer))>e&&(e=n,t=r);return t}},{key:"seekBestOverlapPositionStereoQuick",value:function(){var t,e,n,r,i,a=0;for(this.preCalculateCorrelationReferenceStereo(),e=Number.MIN_VALUE,t=0,r=0,i=0;a<4;a+=1){for(var o=0;ue[a][o]&&!((i=r+ue[a][o])>=this.seekLength);)(n=this.calculateCrossCorrelationStereo(2*i,this.refMidBuffer))>e&&(e=n,t=i),o+=1;r=t}return t}},{key:"preCalculateCorrelationReferenceStereo",value:function(){for(var t,e,n=0;n<this.overlapLength;n+=1)e=n*(this.overlapLength-n),t=2*n,this.refMidBuffer[t]=this.midBuffer[t]*e,this.refMidBuffer[t+1]=this.midBuffer[t+1]*e}},{key:"calculateCrossCorrelationStereo",value:function(t,e){var n=this._inputBuffer.vector;t+=this._inputBuffer.startIndex;for(var r,i=0,a=2,o=2*this.overlapLength;a<o;a+=2)i+=n[r=a+t]*e[a]+n[r+1]*e[a+1];return i}},{key:"overlap",value:function(t){this.overlapStereo(2*t)}},{key:"overlapStereo",value:function(t){var e=this._inputBuffer.vector;t+=this._inputBuffer.startIndex;for(var n,r,i,a,o,s=this._outputBuffer.vector,u=this._outputBuffer.endIndex,l=0,c=1/this.overlapLength;l<this.overlapLength;l+=1)r=(this.overlapLength-l)*c,i=l*c,a=(n=2*l)+t,s[(o=n+u)+0]=e[a+0]*i+this.midBuffer[n+0]*r,s[o+1]=e[a+1]*i+this.midBuffer[n+1]*r}},{key:"process",value:function(){var t,e,n;if(null===this.midBuffer){if(this._inputBuffer.frameCount<this.overlapLength)return;this.midBuffer=new Float32Array(2*this.overlapLength),this._inputBuffer.receiveSamples(this.midBuffer,this.overlapLength)}for(;this._inputBuffer.frameCount>=this.sampleReq;){t=this.seekBestOverlapPosition(),this._outputBuffer.ensureAdditionalCapacity(this.overlapLength),this.overlap(Math.floor(t)),this._outputBuffer.put(this.overlapLength),(e=this.seekWindowLength-2*this.overlapLength)>0&&this._outputBuffer.putBuffer(this._inputBuffer,t+this.overlapLength,e);var r=this._inputBuffer.startIndex+2*(t+this.seekWindowLength-this.overlapLength);this.midBuffer.set(this._inputBuffer.vector.subarray(r,r+2*this.overlapLength)),this.skipFract+=this.nominalSkip,n=Math.floor(this.skipFract),this.skipFract-=n,this._inputBuffer.receive(n)}}},{key:"tempo",set:function(t){var e;this._tempo=t,this.calculateSequenceParameters(),this.nominalSkip=this._tempo*(this.seekWindowLength-this.overlapLength),this.skipFract=0,e=Math.floor(this.nominalSkip+.5),this.sampleReq=Math.max(e+this.overlapLength,this.seekWindowLength)+this.seekLength},get:function(){return this._tempo}},{key:"inputChunkSize",get:function(){return this.sampleReq}},{key:"outputChunkSize",get:function(){return this.overlapLength+Math.max(0,this.seekWindowLength-2*this.overlapLength)}},{key:"quickSeek",set:function(t){this._quickSeek=t}}]),e}(re),ce=function(t,e){return(t>e?t-e:e-t)>1e-10},he=function(){function t(){$t(this,t),this.transposer=new ie(!1),this.stretch=new le(!1),this._inputBuffer=new ne,this._intermediateBuffer=new ne,this._outputBuffer=new ne,this._rate=0,this._tempo=0,this.virtualPitch=1,this.virtualRate=1,this.virtualTempo=1,this.calculateEffectiveRateAndTempo()}return Kt(t,[{key:"clear",value:function(){this.transposer.clear(),this.stretch.clear()}},{key:"clone",value:function(){var e=new t;return e.rate=this.rate,e.tempo=this.tempo,e}},{key:"calculateEffectiveRateAndTempo",value:function(){var t=this._tempo,e=this._rate;this._tempo=this.virtualTempo/this.virtualPitch,this._rate=this.virtualRate*this.virtualPitch,ce(this._tempo,t)&&(this.stretch.tempo=this._tempo),ce(this._rate,e)&&(this.transposer.rate=this._rate),this._rate>1?this._outputBuffer!=this.transposer.outputBuffer&&(this.stretch.inputBuffer=this._inputBuffer,this.stretch.outputBuffer=this._intermediateBuffer,this.transposer.inputBuffer=this._intermediateBuffer,this.transposer.outputBuffer=this._outputBuffer):this._outputBuffer!=this.stretch.outputBuffer&&(this.transposer.inputBuffer=this._inputBuffer,this.transposer.outputBuffer=this._intermediateBuffer,this.stretch.inputBuffer=this._intermediateBuffer,this.stretch.outputBuffer=this._outputBuffer)}},{key:"process",value:function(){this._rate>1?(this.stretch.process(),this.transposer.process()):(this.transposer.process(),this.stretch.process())}},{key:"rate",get:function(){return this._rate},set:function(t){this.virtualRate=t,this.calculateEffectiveRateAndTempo()}},{key:"rateChange",set:function(t){this._rate=1+.01*t}},{key:"tempo",get:function(){return this._tempo},set:function(t){this.virtualTempo=t,this.calculateEffectiveRateAndTempo()}},{key:"tempoChange",set:function(t){this.tempo=1+.01*t}},{key:"pitch",set:function(t){this.virtualPitch=t,this.calculateEffectiveRateAndTempo()}},{key:"pitchOctaves",set:function(t){this.pitch=Math.exp(.69314718056*t),this.calculateEffectiveRateAndTempo()}},{key:"pitchSemitones",set:function(t){this.pitchOctaves=t/12}},{key:"inputBuffer",get:function(){return this._inputBuffer}},{key:"outputBuffer",get:function(){return this._outputBuffer}}]),t}(),fe=function(){function t(e){$t(this,t),this.buffer=e,this._position=0}return Kt(t,[{key:"extract",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.position=n;for(var r=this.buffer.getChannelData(0),i=this.dualChannel?this.buffer.getChannelData(1):this.buffer.getChannelData(0),a=0;a<e;a++)t[2*a]=r[a+n],t[2*a+1]=i[a+n];return Math.min(e,r.length-n)}},{key:"dualChannel",get:function(){return this.buffer.numberOfChannels>1}},{key:"position",get:function(){return this._position},set:function(t){this._position=t}}]),t}(),de=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:oe,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:4096,i=t.createScriptProcessor(r,2,2),a=new Float32Array(2*r);return i.onaudioprocess=function(t){var i=t.outputBuffer.getChannelData(0),o=t.outputBuffer.getChannelData(1),s=e.extract(a,r);n(e.sourcePosition),0===s&&e.onEnd();for(var u=0;u<s;u++)i[u]=a[2*u],o[u]=a[2*u+1]},i},pe=function(t){var e,n,r,i=Math.floor(t/60),a=t-60*i;return"".concat(i,":").concat((e=parseInt(a),r=r||"0",(e+="").length>=(n=2)?e:new Array(n-e.length+1).join(r)+e))},ye=function(t){var e=this.timePlayed,n=this.sampleRate;if(this.sourcePosition=t,this.timePlayed=t/n,e!==this.timePlayed){var r=new CustomEvent("play",{detail:{timePlayed:this.timePlayed,formattedTimePlayed:this.formattedTimePlayed,percentagePlayed:this.percentagePlayed}});this._node.dispatchEvent(r)}};!function(){function t(e,n,r){var i=this,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:oe;$t(this,t),this._soundtouch=new he;var o=new fe(n);this.timePlayed=0,this.sourcePosition=0,this._filter=new se(o,this._soundtouch,a),this._node=de(e,this._filter,(function(t){return ye.call(i,t)})),this.tempo=1,this.rate=1,this.duration=n.duration,this.sampleRate=e.sampleRate,this.listeners=[]}Kt(t,[{key:"connect",value:function(t){this._node.connect(t)}},{key:"disconnect",value:function(){this._node.disconnect()}},{key:"on",value:function(t,e){this.listeners.push({name:t,cb:e}),this._node.addEventListener(t,(function(t){return e(t.detail)}))}},{key:"off",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=this.listeners;e&&(n=n.filter((function(t){return t.name===e}))),n.forEach((function(e){t._node.removeEventListener(e.name,(function(t){return e.cb(t.detail)}))}))}},{key:"formattedDuration",get:function(){return pe(this.duration)}},{key:"formattedTimePlayed",get:function(){return pe(this.timePlayed)}},{key:"percentagePlayed",get:function(){return 100*this._filter.sourcePosition/(this.duration*this.sampleRate)},set:function(t){this._filter.sourcePosition=parseInt(t*this.duration*this.sampleRate)}},{key:"node",get:function(){return this._node}},{key:"pitch",set:function(t){this._soundtouch.pitch=t}},{key:"pitchSemitones",set:function(t){this._soundtouch.pitchSemitones=t}},{key:"rate",set:function(t){this._soundtouch.rate=t}},{key:"tempo",set:function(t){this._soundtouch.tempo=t}}])}();function ve(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p()(t);if(e){var i=p()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}var ge=function(t){c()(n,t);var e=ve(n);function n(t){var r;return i()(this,n),r=e.call(this,t),v()(u()(r),"soundTouch",void 0),v()(u()(r),"filter",void 0),r.init(t.source),r}return o()(n,[{key:"init",value:function(t){this.soundTouch=new he,this.soundTouch.tempo=1,this.soundTouch.rate=1,this.filter=new se(t,this.soundTouch,2048)}},{key:"provide",value:function(t){for(var e=new Float32Array(2*t),n=this.filter.extract(e,t),r=new Float32Array(n),i=new Float32Array(n),a=0;a<n;a++)r[a]=e[2*a],i[a]=e[2*a+1];return{size:n,left:r,right:i}}},{key:"rate",set:function(t){this.soundTouch.tempo=t}}]),n}(U);function me(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p()(t);if(e){var i=p()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}var be=function(t){c()(n,t);var e=me(n);function n(t){var r;return i()(this,n),r=e.call(this,t),v()(u()(r),"currentRate",1),v()(u()(r),"source",[]),v()(u()(r),"commonProcessor",void 0),v()(u()(r),"rateProcessor",void 0),v()(u()(r),"audioTime",0),r.source=t.source,r.init(),r}return o()(n,[{key:"init",value:function(){var t=this;this.commonProcessor=new Yt({source:this.source,onPlay:function(e){t.audioTime=e}}),this.rateProcessor=new ge({source:this.commonProcessor})}},{key:"provide",value:function(t){var e=(1===this.currentRate?this.commonProcessor:this.rateProcessor).provide(t);return e.audioTime=this.audioTime,e}},{key:"rate",set:function(t){this.currentRate=t,this.rateProcessor.rate=t}}]),n}(U);function ke(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p()(t);if(e){var i=p()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}var Pe="canplaythrough",we="seeked",xe="waiting",_e=function(t){c()(n,t);var e=ke(n);function n(t){var r;return i()(this,n),r=e.call(this,t),v()(u()(r),"audioContext",null),v()(u()(r),"scriptNode",null),v()(u()(r),"gainNode",null),v()(u()(r),"delay",0),v()(u()(r),"audioBuffer",new ArrayBuffer(0)),v()(u()(r),"decodedBuffer",[]),v()(u()(r),"isFirstPlay",!0),v()(u()(r),"defaultVolume",1),v()(u()(r),"currentRate",1),v()(u()(r),"eventListeners",{}),v()(u()(r),"canPlay",!1),v()(u()(r),"interval",void 0),v()(u()(r),"seekTimeDelta",0),v()(u()(r),"audioTime",0),v()(u()(r),"audioProvider",void 0),v()(u()(r),"isWaiting",!1),t=Object.assign({},t),r.flushTime=t.flushTime||1e3,r.onReady=t.onReady,r.init(),r}return o()(n,[{key:"init",value:function(){this.audioProvider=new be({source:this.decodedBuffer}),"function"==typeof this.onReady&&setTimeout(this.onReady,0)}},{key:"feed",value:function(t){var e=t.audio;this.audioBuffer=this.appendByteArray(this.audioBuffer,e),this.canPlay||(this.canPlay=!0,this.triggerEvent(Pe))}},{key:"appendByteArray",value:function(t,e){var n=new Uint8Array((0|t.byteLength)+(0|e.byteLength));return n.set(new Uint8Array(t),0),n.set(new Uint8Array(e),0|t.byteLength),n.buffer}},{key:"decodeAudioData",value:function(t){var e=this;this.audioBuffer&&this.audioBuffer.byteLength>0&&(this.audioContext.decodeAudioData(this.audioBuffer,(function(n){n.startTime=e.delay,e.delay+=n.duration,e.decodedBuffer.push(n),t&&t.call()}),(function(t){e.logger.error("decodeAudioData",t)})),this.audioBuffer=new ArrayBuffer(0))}},{key:"play",value:function(){var t=this;return new Promise((function(e,n){t.isFirstPlay?(t.isFirstPlay=!1,t.logger.info("startPlay"),t.audioContext=new(window.AudioContext||window.webkitAudioContext),t.gainNode=t.audioContext.createGain(),t.gainNode.gain.value=t.defaultVolume,t.scriptNode=t.audioContext.createScriptProcessor(2048,2,2),t.scriptNode.onaudioprocess=function(e){var n=e.outputBuffer,r=n.length,i=t.audioProvider.provide(r);if(0!==i.size){t.isWaiting&&(t.isWaiting=!1,t.triggerEvent(Pe));var a=n.getChannelData(0),o=n.getChannelData(1);if(0!=i.audioTime&&(t.audioTime=i.audioTime),a.set(i.left),o.set(i.right),i.size<r){var s=new Float32Array(r-i.size);a.set(s,i.size),o.set(s,i.size)}}else t.isWaiting||(t.isWaiting=!0,t.triggerEvent(xe))},t.scriptNode.connect(t.gainNode),t.gainNode.connect(t.audioContext.destination),t.decodeAudioData.call(t,t.testAutoplay.bind(t,e,n)),t.interval=setInterval(t.decodeAudioData.bind(t),t.flushTime)):"suspended"===t.audioContext.state?t.audioContext.resume().then((function(){t.logger.info("play","Audio is resumed"),e()})):(t.logger.info("Audio resumed from waiting"),e())}))}},{key:"pause",value:function(){var t=this;this.audioContext&&this.audioContext.suspend().then((function(){t.logger.info("pause","Audio is paused")}))}},{key:"addEventListener",value:function(t,e){this.eventListeners[t]=e}},{key:"triggerEvent",value:function(t){var e=this.eventListeners[t];e&&e.call()}},{key:"buffer",value:function(){var t=0;this.decodedBuffer.length>0&&(t=this.decodedBuffer[0].startTime);return{start:1e3*t,end:parseInt(1e3*this.delay)}}},{key:"destroy",value:function(){this.delay=0,this.audioContext&&(clearInterval(this.interval),this.scriptNode.disconnect(),this.scriptNode=null,this.audioContext.close(),this.audioContext=null),this.gainNode=null,this.audioBuffer=new ArrayBuffer(0),this.canPlay=!1,this.isFirstPlay=!0,this.decodedBuffer.length=0,this.seekTimeDelta=0,this.audioTime=0}},{key:"testAutoplay",value:function(t,e){var n=L.createEl("audio"),r=n.play();n=null;var i=!1;void 0!==r?(r.catch((function(){i=!0})),setTimeout((function(){r=null,i?e("Autoplay is prevented"):t()}),100)):e("Promise is undefined")}},{key:"currentTime",get:function(){return this.audioTime},set:function(t){var e=this;for(this.audioTime=t;this.decodedBuffer.length>0;){var n=this.decodedBuffer.shift();if(n.startTime<=t&&n.startTime+n.duration>t){n.loadedPosition=parseInt(n.length*(t-n.startTime)/n.duration),this.decodedBuffer.unshift(n);break}}setTimeout((function(){e.triggerEvent(we)}),0)}},{key:"volume",get:function(){return this.gainNode.gain.value},set:function(t){this.gainNode?this.gainNode.gain.value=t:this.defaultVolume=t}},{key:"playbackRate",set:function(t){t!==this.currentRate&&(this.currentRate=t,this.audioProvider.rate=t)}}]),n}(U);function Be(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p()(t);if(e){var i=p()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}var Te=function(t){c()(n,t);var e=Be(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i()(this,n),t=e.call(this,r),v()(u()(t),"need",!0),v()(u()(t),"first",!1),v()(u()(t),"offset",0),v()(u()(t),"currentPTS",0),v()(u()(t),"ready",!1),v()(u()(t),"end",!1),v()(u()(t),"lastData",null),v()(u()(t),"nodeParent",null),v()(u()(t),"useJMuxer",!1),t.player=r.audioNode,t.createAudioMuxer(),t.bindEvent(),t.logger.info("audioDecoder",t.useJMuxer?"JMuxer":"AudioContext"),t}return o()(n,[{key:"bindEvent",value:function(){var t=this;this.bindNodeEvent(),this.events.on(st.PlayerMaxPTS,(function(e){t.currentPTS===e&&(t.end=!0)}))}},{key:"bindNodeEvent",value:function(){var t=this;this.addEventListener("seeked",(function(){t.onSeekedHandler&&t.onSeekedHandler(),t.events.emit("AudioPlayer.seeked")})),this.addEventListener("canplaythrough",(function(){t.logger.info("canplaythrough"),t.ready||(t.ready=!0,t.status="ready",t.logger.info("constructor","canplaythrough","ready"),t.events.emit(st.AudioPlayerDataReady))})),this.addEventListener("waiting",(function(){t.ready=!1,t.end?(t.useJMuxer||t.player.destroy(),t.status="end",t.events.emit(st.AudioPlayerEnd,"audio"),t.logger.info("audioPlayer end")):(t.logger.warn("audioPlayer waiting",t.player.currentTime,t.currentPTS),t.status="waiting",t.events.emit(st.AudioPlayerWait,"audio"))}))}},{key:"reset",value:function(){this.lastData=null,this.first=!1,this.offset=0,this.currentPTS=0,this.ready=!1,this.end=!1,this.clear(),this.createAudioMuxer(),this.bindNodeEvent(),this.stime=null}},{key:"createNode",value:function(){this.player=document.createElement("audio"),this.player.classList.add("goldplay__audio--player"),this.parentNode.appendChild(this.player)}},{key:"createAudioMuxer",value:function(){this.useJMuxer?this.audioDecoder=new Xt({node:this.player,mode:"audio",debug:!1,clearBuffer:!0,flushingTime:10,onReady:this.onMSEReady.bind(this)}):(this.audioDecoder=new _e({flushTime:100,onReady:this.onMSEReady.bind(this)}),this.player=this.audioDecoder)}},{key:"onMSEReady",value:function(){this.logger.info("onMSEReady","AudioPlayerReady"),this.events.emit(st.AudioPlayerReady)}},{key:"clear",value:function(){this.audioDecoder.destroy(),this.audioDecoder=null}},{key:"play",value:function(){var t=this;"playing"!==this.status&&(this.status="playing",this.player.play().then((function(){t.events.emit(st.AudioPlayerPlaySuccess)})).catch((function(e){t.logger.error("play","errorInfo:",e),t.events.emit(st.AudioPlayerPlayFail)})))}},{key:"pause",value:function(){"pause"!==this.status&&(this.status="pause",this.player.pause())}},{key:"send",value:function(t){if(!t.PTS)return this.need=!1,void this.events.emit(st.AudioPlayerDataReady);if(this.need=!0,this.audioDecoder){if(this.stime||(this.stime=Date.now()),(t=this.format(t)).audioEnd)return this.logger.info("push","audioEnd"),this.feed(this.lastData),void(this.lastData=null);if(this.first||(this.first=!0,this.offset=t.start),t.PTS>this.currentPTS){if(!this.lastData)return void(this.lastData=t);this.lastData.duration=t.PTS-this.lastData.PTS,this.feed(this.lastData),t.duration=this.lastData.duration,this.lastData=t}}else this.logger.error("send","audioDecoder is:",this.audioDecoder)}},{key:"feed",value:function(t){this.audioDecoder.feed({audio:t.data_byte,duration:t.duration}),this.currentPTS=t.PTS}},{key:"format",value:function(t){return t&&t.data_byte&&(t.start=t.PTS),t}},{key:"addEventListener",value:function(t,e){this.player.addEventListener(t,e)}},{key:"isBuffered",value:function(t){return-1!==[this.buffer()].findIndex((function(e){return t>=e.start&&t<e.end}))}},{key:"buffer",value:function(){if(this.useJMuxer){for(var t=this.player.buffered,e=t.length,n={};e>0;)n.start=1e3*t.start(e-1)+this.offset,n.end=1e3*t.end(e-1)+this.offset,e--;return n}var r=this.player.buffer();return{start:r.start+this.offset,end:r.end+this.offset}}},{key:"muted",set:function(t){this.player.muted=!!t}},{key:"playbackRate",set:function(t){this.player.playbackRate=t}},{key:"volume",get:function(){return this.player.volume},set:function(t){this.player.volume=t,this.muted=0===t}},{key:"currentTime",get:function(){return parseInt(1e3*this.player.currentTime+this.offset)},set:function(t){this.player.currentTime=(t-this.offset)/1e3}},{key:"paused",get:function(){return this.player.paused}},{key:"offset",set:function(t){this.offset=t}}]),n}(U),Ee={playerContainer:"goldplay__container",screenContainer:"goldplay__screen--container",screenCanvas:"goldplay__screen--canvas",audioContainer:"goldplay__audio--container",audioPlayer:"goldplay__audio--player",controlContainer:"goldplay__control--container",containerFullPage:"goldplay__container-fullpage",containerFullScreen:"goldplay__container-fullscreen",controlContainerFloat:"goldplay__control--container-float",bigPlayButton:"goldplay__screen--bigplay",poster:"goldplay__screen--poster",nearside:"goldplay__control--nearside",sidebar:"goldplay__control--sidebar",buttonBlock:"goldplay__control--button-block",playButton:"goldplay__control--play",pauseButton:"goldplay__control--pause",replayButton:"goldplay__control--replay",speedBar:"goldplay__speed-bar",speedBarBox:"goldplay__speed-bar--box",rateBar:"goldplay__rate-bar",rateBarBox:"goldplay__rate-bar--box",fullPage:"goldplay__control--fullpage",fullScreen:"goldplay__control--fullscreen",waitingBar:"goldplay__waiting-bar",progressBar:"goldplay__progress-bar",progressBarHover:"goldplay__progress-bar-hover",progressBarPlay:"goldplay__progressbar--play",progressBarPlayHover:"goldplay__progressbar--play-hover",progressBarLoad:"goldplay__progressbar--load",progressBarLoadHover:"goldplay__progressbar--load-hover",progressBarDot:"goldplay__progressbar--dot",progressBarDotHover:"goldplay__progressbar--dot-hover",volumeBar:"goldplay__volume-bar",volumeBarAudio:"goldplay__volume-bar--audio",volumeBarAudioOn:"goldplay__volume-bar--audio-on",volumeBarAudioOff:"goldplay__volume-bar--audio-off",volumeBarHandle:"goldplay__volume-bar--handle",volumeBarRod:"goldplay__volume-bar--rod",volumeBarRodHover:"goldplay__volume-bar--rod-hover",volumeBarSize:"goldplay__volume-bar--size",volumeBarColumn:"goldplay__volume-bar--column",alertBox:"goldplay__alter-box",alertClose:"goldplay__alter--close"};function Se(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p()(t);if(e){var i=p()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}var Re=Ee,Le=function(){function t(){i()(this,t)}return o()(t,null,[{key:"createContainer",value:function(t){var e=function(t){c()(n,t);var e=Se(n);function n(){return i()(this,n),e.apply(this,arguments)}return n}(J()(HTMLDivElement));customElements.get("gp-container")||customElements.define("gp-container",e,{extends:"div"});var n=L.createEl("gp-container","div");return n.className=Re.playerContainer,n.style.width=(t.options.width?t.options.width:t.el.offsetWidth)+"px",n.style.height=(t.options.height?t.options.height:t.el.offsetHeight)+"px",n}},{key:"createScreenContainer",value:function(t){var e=t.$container,n=function(t){c()(n,t);var e=Se(n);function n(){return i()(this,n),e.apply(this,arguments)}return n}(J()(HTMLDivElement));customElements.get("gp-screen")||customElements.define("gp-screen",n,{extends:"div"});var r,a=L.createEl("gp-screen","div");return a.classList.add(Re.screenContainer),r=t.controlBarAutoHide?e.offsetHeight:e.offsetHeight-t.controlBarHeight,a.style.height=r+"px",a}},{key:"createAudioContainer",value:function(){var t=L.createEl("gp-audio");return t.classList.add(Re.audioContainer),t.style.display="none",t}},{key:"createAudio",value:function(){var t=L.createEl("audio");return t.classList.add(Re.audioPlayer),t.controls=!0,t}},{key:"clearCavans",value:function(t){var e=t.getContext("webgl");e.clear(e.COLOR_BUFFER_BIT)}}]),t}();v()(Le,"createCanvas",(function(t){var e=L.createEl("canvas");return e.style.display="none",e.classList.add(Re.screenCanvas),e.width=t.options.screenWidth||t.screenWidth,e.height=t.options.screenHeight||t.screenHeight,e}));var De=P.a.get("Template.js"),Ce=function(){function t(){i()(this,t)}return o()(t,null,[{key:"mergeVar",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("string"!=typeof t||""===t)return t;try{var n=new RegExp("\\${'?\"?\\s*([.:a-z0-9_s]+?)\\s*'?\"?}","ig");return t.replace(n,(function(t,n){n=n.trim();var r=e[n];return r=(r=void 0===(r=null===r?"":r)?"":r)||""}))}catch(e){return De.error("mergeVar","replace variable","error:",e),t}}},{key:"makeValue",value:function(e,n,r){if("string"!=typeof n&&"function"!=typeof n)return n;if("function"==typeof n&&(n=n.call(this,this.data)),!r)return t.escapeHTML.call(this,n);var i,a=function(e){var n="";return e&&(n=" ".concat(t.slotReplaceName,'="true"')),'<gp-slot style="display:none"'.concat(n,"></gp-slot>")};if(t.isSoltType(r)){if("function"!=typeof this.getComponent)return De.error("makeValue","the object is not support slot mode.",this.getComponent,n),n;switch(r){case t.slotTypeMap.component:i=n;var o=this.getComponent(i);"object"===S()(o)&&o.element?(o.element.setAttribute(t.slotReplaceName,"true"),n=o.element.outerHTML):n=a(i);break;case t.slotTypeMap.html:n=t.mergeVar.call(this,n,this.data)}var s="";void 0!==i&&(s=" ".concat(t.slotComName,'="').concat(i,'" '));var u="$1 "+t.slotTypeName+'="'+r+'" '+t.slotKeyName+'="'+e+'"'+s+"$2";return"string"==typeof n&&(n=(n=""===n?a():n).replace(/^\s*(<\s?[\w-]*)(.*[\r|\n|>])/,u)),n}if("string"==typeof r){var l=Ae[r];return"function"==typeof l&&(n=l.call(this,n)),n}return t.escapeHTML.call(this,n)}},{key:"escapeHTML",value:function(t){return"string"!=typeof t?t:t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}},{key:"generate",value:function(e,n,r){var i=this,a=r[r.length-1]||{},o=[e[0]];return n.forEach((function(n,s){if(n){var u,l,c=n.split(t.pipSeparator);c.length>1&&(n=c[0],l=c[1]),u=Number.isInteger(n)?r[n]:a[n],void 0!==(u=t.makeValue.bind(i)(n,u,l))&&o.push(u),void 0!==e[s+1]&&o.push(e[s+1])}})),o.join("")}},{key:"create",value:function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];var a;a=Array.isArray(e)?"array":"function"==typeof e?"function":"string";var o=this;if("object"===S()(o)||"function"==typeof o)if(void 0!==e&&""!==e)switch(void 0!==o.data&&null!==o.data||(De.info("create","this object.data is undefined or null",o),o.data={}),a){case"array":return function(){for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];var s=i[i.length-1]||{};"object"===S()(o)&&(o.__template__={tplObj:e,keys:r,dict:s});var u=t.generate.bind(o);return u(e,r,i)};case"function":var s=t.create.bind(o);return e.call(o,o.data,s,o);default:return function(n){return n=void 0!==n?n:o.data,t.mergeVar(e,n)}}else De.error("create","have not give tplObj parameter.",e);else De.error("create","this is not an object.",o)}},{key:"isSoltType",value:function(e){return e=String(e).toLowerCase(),t.slotTypeMap[e]}}]),t}();Ce.pipSeparator="|",Ce.slotTypeName="gp-slot-type",Ce.slotKeyName="gp-slot-key",Ce.slotComName="gp-slot-com",Ce.slotReplaceName="gp-slot-replace",Ce.slotTypeMap={html:"html",component:"component"};var Ae={trim:function(t){return t.trim()},upperCase:function(t){return t.toUpperCase()},lowerCase:function(t){return t.toLowerCase()}},Oe=Ce,Me=n(18),Ie=n.n(Me),Ue=n(28),Ne=n.n(Ue),He=P.a.get("Observer.js"),Fe=function(){function t(e){i()(this,t),v()(this,"object",null),this.setObject(e)}var e;return o()(t,[{key:"setObject",value:function(t){this.object=t}},{key:"watch",value:(e=Ne()(Ie.a.mark((function t(e,n,r){var i;return Ie.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("function"==typeof(i=this.object).watch){t.next=3;break}return t.abrupt("return");case 3:return t.next=5,i.watch(e,n,r);case 5:!1!==t.sent&&"function"==typeof i.render&&i.render(e,n,r),"function"==typeof i.afterWatch&&i.afterWatch(e,n,r);case 8:case"end":return t.stop()}}),t,this)}))),function(t,n,r){return e.apply(this,arguments)})},{key:"create",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this,r=e.set,i=e.get;t=t||n.data;var a=n.object,o={set:function(t,e,i){return"function"==typeof r?r.call(n,t,e,i):(t[e]!==i&&(t[e]=i,a.__template__&&Object.prototype.hasOwnProperty.call(a.__template__.dict,e)&&n.watch(t,e,i)),!0)},get:function(t,e){return"function"==typeof i?i.call(n,t,e):"object"===S()(t[e])&&null!==t[e]?new Proxy(t[e],o):Reflect.get(t,e)}};return new Proxy(t,o)}}]),t}(),je=function(t){return"object"!==S()(t)&&He.error("observer","this is not an object."),new Fe(t)};function We(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return Ve(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ve(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function Ve(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function ze(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p()(t);if(e){var i=p()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}function Xe(t){if(t){var e=[],n=[];for(n.push(t);n.length;){var r=n.shift(),i=r.getAttribute(Oe.slotTypeName);if(!Oe.isSoltType(i)){e.push(r);for(var a=r.children,o=0,s=a.length;o<s;o++)n.push(a[o])}}return e}}var Ge=function(t){return t.getAttribute&&t.getAttribute(Oe.slotTypeName)===Oe.slotTypeMap.html},Ye=function(t,e){return!(!(n=t).getAttribute||n.getAttribute(Oe.slotTypeName)!==Oe.slotTypeMap.component||t.getAttribute(Oe.slotComName)===e.getAttribute(Oe.slotComName));var n},$e=function(t,e,n){var r;(t||e)&&(!t&&e?n.appendChild(e):!e&&t?n.removeChild(t):t.tagName!==e.tagName||(r=e,Ge(t)&&Ge(r))||Ye(t,e)?t.replaceWith(e.cloneNode(!0)):t.nodeType===Node.TEXT_NODE&&t.nodeValue!==e.nodeValue?t.nodeValue=e.nodeValue:t.setAttribute&&L.setAttributes(t,e))},qe=function(t){c()(n,t);var e=ze(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i()(this,n),t=e.call(this,r),v()(u()(t),"createTemplate",null),v()(u()(t),"template",""),v()(u()(t),"element",null),v()(u()(t),"eventsList",{}),v()(u()(t),"data",{}),v()(u()(t),"id",""),t.id=r.id||t.constructor.name,t.options=r,t.createTemplate=Oe.create.bind(u()(t)),t}return o()(n,[{key:"getTemplate",value:function(){return this.template}},{key:"setTemplate",value:function(t){this.template=t}},{key:"init",value:function(){this.data=je(this).create(this.data),this.render(),"function"==typeof this.afterInit&&this.afterInit()}},{key:"afterInit",value:function(){}},{key:"initProps",value:function(){}},{key:"bindEvent",value:function(){}},{key:"watch",value:function(){}},{key:"render",value:function(){var t="";t="function"==typeof this.template?this.template(this.data):this.template;var e=L.createEl("div");if("string"==typeof t){e.innerHTML=t;var n,r=e.firstElementChild,i=We(r.querySelectorAll("["+Oe.slotReplaceName+"]"));try{for(i.s();!(n=i.n()).done;){var a=n.value;if("true"===a.getAttribute(Oe.slotReplaceName)){var o=a.getAttribute(Oe.slotComName),s=this.getComponent(o);if(!s)continue;var u=s.element;L.isElement(this.element)?a.replaceWith(u.cloneNode(!0)):a.replaceWith(u),s.element.removeAttribute(Oe.slotReplaceName)}}}catch(t){i.e(t)}finally{i.f()}L.isElement(this.element)?this.replaceNode(this.element,r):this.element=r}else this.logger.error("render:","this template is not html string","html:",t)}},{key:"replaceNode",value:function(t,e){if(t&&e){var n=Xe(t),r=Xe(e),i=n.length,a=r.length,o=Math.max(i,a);if(o<=0||t.tagName!==e.tagName)return t.replaceWith(e),void(this.element=e);for(;o--;){var s=n[o],u=r[o];if(s)if(u){if(s.tagName===u.tagName&&L.syncAttributes(s,u),!s.isEqualNode(u)){var l=Math.max(s.childNodes.length,u.childNodes.length);if(l<=0)$e(s,u,s.parentNode);else for(var c=0,h=l;c<h;c++){var f=s.childNodes[c],d=u.childNodes[c];(f||d)&&$e(f,d,s)}}}else s.parentNode.removeChild(s);else t.appendChild(u)}}}},{key:"show",value:function(){this.data.display="show",this.element&&(this.element.style.display="inline-block")}},{key:"hide",value:function(){this.data.display="hide",this.element&&(this.element.style.display="none")}},{key:"resetPosition",value:function(){var t=this.element.parentNode,e=t.offsetWidth,n=t.offsetHeight;this.element.style.marginTop=(n-this.element.offsetHeight)/2+"px",this.element.style.marginLeft=(e-this.element.offsetWidth)/2+"px"}},{key:"replace",value:function(t){this.element.replaceWith(t),this.element=t}},{key:"update",value:function(t){this.element.innerHTML=t}},{key:"addEventListener",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return t.addEventListener(e,n,r),{destroy:function(){t.removeEventListener(e,n)}}}},{key:"removeEventListenerAll",value:function(){var t=this;Object.keys(this.eventsList).forEach((function(e){t.eventsList[e].destroy()}))}},{key:"getComponent",value:function(t){if(void 0!==t)return this.options.componentsController?this.options.componentsController.getComponent(t):void 0}},{key:"getHTMLString",value:function(){return this.element.outerHTML}},{key:"destroy",value:function(){this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.events.emit("Component_"+this.id+".destroy",this),this.removeEventListenerAll()}}]),n}(U),Ke=n(8),Qe=n.n(Ke),Ze={formatHHMMSS:function(t){var e=parseInt(t,10),n=Math.floor(e/3600),r=Math.floor((e-3600*n)/60),i=e-3600*n-60*r;n<10&&(n="0"+n),r<10&&(r="0"+r),i<10&&(i="0"+i);var a="";return"00"!==n&&(a=n+":"),a+r+":"+i}},Je={formatBytes:function(t,e){if(0==t)return"0 Bytes";var n=e<=0?0:e||2,r=Math.floor(Math.log(t)/Math.log(1024));return parseFloat((t/Math.pow(1024,r)).toFixed(n))+" "+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][r]}};function tn(){var t=Qe()(['\n  <gp-poster class="goldplay__screen--poster">\n  <img src="','" width="','" data-display="','" heigth="','" class="goldplay__screen--poster-image">\n  <gp-speed class="goldplay__screen--poster-speed">',"</gp-speed>\n  </gp-poster>\n  "]);return tn=function(){return t},t}function en(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p()(t);if(e){var i=p()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}var nn="data:img/jpg;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAAA+CAYAAABuk1SaAAAZ2ElEQVR4nO2de1wV1fbA157ZcyTe\n6sjj8FJeoqghiJAovsAHkJSUmpZl3bTHTe/NzO71k131Z97y9tJft9SrojdNLTQUH6iR4EcTUTRN\nBERCRAQcURCUnNfvDzl2OMzrPDDsd75/wZ6ZvdfMnLX3XmuvtQfAjh07duzYsWPHjh07duzYsdMp\nQFKFoig+aDnsAEC0F9UzxgNiORG4L8+y31pSh7czxiQBmBeAu9rEcbaW8f8DCP2mFvh3lOOhIc6H\nCh2tFxOeDeKn+TuDv8N/RD9b1e3tjPHUEJg6py8/pyAV/AEAlpwil2i9PlZPBQ/xEIdEdBcfjewu\nRJ5NAy/aAcKYFiguTCMqL96C8tIGoqSsEZUV3YSi/KtsuaWyxvtSfRP1YsLzIfzzrjpwdV8vhlha\n18NCh40g0V5UzxA3CO3pLPbEBOD6X1H91dtQff4mFBcxbJ3VDTwAwmnKY3EUvyStpzgRAGgAgMom\nKPTfJEbZov4RflS/7xK4He46CDaUMS1QTG8Q+6hdOyaAilzwKL9guLcYb5BNA0xxAxR/V0FmbrqI\nvjp7ja3RclGkJ+W/bBC/bKyvOMbQViGD9kdmCGM1tvtQYTyC2ExBBvSg9MO8YegT/vyTiT5iQmux\n1Itjau9A3Yoi8rOMX9D24ussY3ZjD4AxAVTk/nFcNpjcw4KT5KylJ7jV1tY/zJcKO5zMHTatP72U\n+NcLP/DzlK5dMZRcODtceMP0WjNh1pQQ/1l6Ci2taOCa5E6aGKyL3z6azTBta/YxPG3FT+xmK9rv\ntBgrCGFtZalB1JCs8cT6MxO5nz5/jNua6CNOgXsPU+7l0Z6PQN+lUfyq4qe48wuj8WvWymBrIjwo\nXynlAAC42IgsnqIY8HPFDlLKAQDwqwB3la7NeZzYagPlAACgX+4tvFMxhf8lpRcVK3VCrJ4KllIO\nAIDyRrD6OTwMWKwgw3ypsIKJxN7MBC4zxV98ASx7YfTiSH7RkSeITEvl6Ai2jOK+Bpn7qWiCCmvr\nfyYYTZWrn0Dy7yRrPLF+lF4cJXethdBZY7hdU3tTY0wPZCZwmXJtVTZBpQ1l6LRYpCBLBuPZh5O5\nw9E9xHFgg54szlMcciCF+NrKemxChAflG+YGYXLHq5vFamvbyKuBvCWnyDktPFRpveaV/tRTKf5i\nCthWOQzQm0dwm2K8qUBDQZwPFer5CHjInM/U3BY02S8PO2YrSHYysendgfy70P5FMeW34Pj8AvzS\n+Gwc3X879g7ZhruGZ2DP+N04fHouTs6qROkAIGVz0Ik+YsKbEXi6BfdgU07XsVUTDuDUyiYolDou\niCBY28axarbs3ePcihF78EiQfh5tCOpKuX45hPsCOkY5DNDfjOK+Mfxz5ApbmvY9TmNaoFjq5Lpm\n3urn8DBglpv39NPowFhfiIC2L4phWoCZeYSatb3sbt4H0pfWAUARAOyRM34BgP44hv/IzxVvu9zI\ntZgjl63ZWc4eDelKjb4wibsARnJyAtSwvLKNYA7Hqtmy0imoNNRN+Yf/9gBhPnSscgAAgL8z+E8J\npRK2lLIHAQAyyti8CA8q8fST3Cnj9mvvQJ1nRwvTSdA8gmQnE5siurVXjk0Xic30BrHP9rK7eVrq\n2X+JLYzZiWNAZiQZ7IEGa5WpI7lwg72ZXkqkG5edqUdnaps5m/act3m4rXZO9hUyO6cabQMNo42V\n0DNC+BnGBafr2KrMS2incdm5G+jnDpaj06BJQRYMwjONfeCtMGtLiHXTDvJzzG00/ypbbvrjM+BK\ngau59XUUZ2+is8b/19wBm8+7HUlwVDtne9ndvFG7hMlp3+M00KYkzOl6OLi2hPhwz2W0UeM1AAAw\n1lccE9SVavMOTtcTp4z/r2uBh2IdyxaoTrEiPSn/wif4pWAyxBc3QPFLh/j5ljb8+Xni8xdChRdM\n6mWOX4PjltZpa1gBtQnVaObUe/uOJKOMzetLU+FFadw5kJ9yMc/m4ue+Kmb3RbQWeDiRRKwnEftp\nLPdJoAsEKlwLAEAHOENPADhjKLhr4nq+xSLZdZM/GqojyBdDeCnjkJmSg5+xpuGCGrbilaP4Vfit\nd2OezcXPnetEq+wYiW06EB0But9LFgNFDFsXuws/BjKjwsoiYuVXxew+47K6Zl7YWc4eDdwsxmRX\nof1qbXg5gpfx/yRq25F2IX//5/CgUFSQMQFUZIyH2M4mSC8l0k/XsZpdlHJ8eZb9dsB2/GjqQRwX\n+g3ubfpiOxu0g+0NZQHM94odq2bL5KaoOyqI75Sufe4Qeg5UplxOWHna100ndlOT8Y+CooLM7cfP\nBYnR44ti4gtbCXDmGludeZE9WlrP1tuqzo7iERIcfm8ZDKSXERukymtV7KS6Zl5YdIpcpHROIwuN\nSse7dKLn0NHI2iB9acqjKE1st7pafgvKrYkIfZjRkaLVU4sYbyowugcM9nUUfXu6CAFTAuUXJZW4\n2CCWSZXzGtZpjtWhYwqHmfM3pNc+DHSGqaatmB5GJbnqwDXvKuSduca2WwSWVZBRepAMaUi/QG5Y\nbGMhO4LQblS3QFcIDHKFwBu/ws2SBiiubhKrrcmRcFSZeigxOZQa9W4E927+BOgHNljT+JUX7zax\nUOFMQU/jcqVQFQNNHMga2Udq0VGpH4oxLhQ4axa0FT9X7ODliLwCXSGwhwN4dCFFHSsgrv5XqP/l\nFpRfuiVWVj3A9S+9C9btGcfv3jj8/tIFkxpEpWZeZI8anyerIIl6PlGq/Pg11Gm8TKZ4OmEitRd6\n4qUQ/qXSp8XBYPJD5ASoWT4Ef7KtHG0rqGErzK3fCZv/w/B0wsTqYcKarSPFCabyWENdMy9UTkP1\npgqiBb0j6GUOMR+cIT/YKXPQgDkjaUovKvbZYH7a5WfuB7HKwawYSq5ceY5YceEGe1Nr/ZaSEoBS\nIrpBglERvXUkt9XDiQwAI7tQsrfRu2BdaoA4QerY5U4apDYxWBd/7in+3Oo4LiPGQ0wCiZeBCfCa\n15//oCCVK/jXEPyOuW2Y673xdcUOBU/wBakB4osS8jCbLhIrzInHshXJfkKyVHlONcrZWd62B5VC\n60i6JZFYmTWG2zUlUPwzqHcO9OxwYdGFSdwF45iwjkK8NxVt46xwIMG3bzeir3GZpIL4OCE9SNxQ\n9W04U98idjpj+u9ReOb20WwG7dBmPs/k16E9G8uIjzMvoXXVt+EM/PZA6Lf683N/noR+8HXFmg1O\nZwzOnk5Yc/RB1lh+l78zRJoUM5+fJxbrN5M+0w7yc4puoCKt9dmCAT0o/fRgQSrmjfnTYeJlLXVo\nGUmzxhPrpwSqjhpS0EdSuCMeTqTqc/Z0wsTMftTE7GRiU+10dO700+jAlFAqQe06AIA159jvFhaS\n70FbJWHumKx1SU6xertLG44XGlBZZ8tznjsQT/9ocJuFTObNfHJu5iX03cUbbGOM0bmj/KgBc8L5\nOa2jI92vK4w4+jh/BAA0ZQhiArxa5/iqhvDyIfjtef0hwqSYmfwDnry1lM15vbXAmRLNnrZZw3eJ\n3A6QGM3id+Ph5TdZRe+VAbWRdEIgNWRnouWRx5gAr0lBxCQA2CJ3TqA7di2ZxJ80zsb0fAT6bhnJ\nRczoQ81Yf57NUmtncQH379rp6HXPR+5ni1bmX2XLVXPSe7uKoTKC2yyHfUAPSh/rCbE6AnQ6QtRh\nAmEAAF4UOVEE4ETE3RXgLi8AhxAQzlh0PnAF7TdOE43zoUKPpPAfgZFyROzAA0/XsVUfS7SZc5k9\nAwAvvR1JvfhhNPcBAND+zuC/ZgS57OVD/N+0yI00GMGt0QfzwCRKIO17nJZRxmqKWesIDqQQXyf6\ngOn0hUnZjx/Pq2I1j2QOKm7eVH8hFay0t1ptYFkF+Xa08I2xchhBr4/n1gNADy3trC8l17/zKL8c\nAOBoHTrqb3Jc8gevdxR9pMrDu4p99S5YV32Lszqi9Xgql+9Agq8512RUoNUAMMvw/9ph3FowUo4R\ne/BILQuYHxay69aOIHu/1Ft4G+5l1v1pmC+14XAVq+jeBNDmJXpvIP8emPxA0kuJ9N9LOcJpyiMj\ngctI9IEwE7mYcdl4/L4K9oQ59akpiLej6KV0vIW/X48sSouyiQG6iAPjRNOpaxtSg6ghph4pKX6+\n+VvgZQFDFEwxOS75sq+1oGtS5e46CPZ4BMkl0ZhF9W0wO/HoSjO6Yvg7pRcVa5zYlHkJ7Tx0mdUc\nZfpeITKef9J/G6BxBFE5Hk5THhIODubTc8RnWmWzBtN8ldmPUlPPpXHnwtxgKBgpRwsPVVGZOMpc\n5TCgZCPk1pC5EsXMolPkG1GZOCD0G9Ip9BvSKexb3GNcNo6WCqjESH62Ek0L7TyUJtCDuouD1O4B\nAODmr2DwmDFSHlrJmyxvks+7jqTbGZ0WkXoAp4J54dvMpz+jTw3/vNybfxmMHtKGMiy5sixHVSPX\nsqUc3R/Ck/zEpAE9KDn3533UplhShmlxAxTbIjRHC/UtQj3AvXWX8qkof0Us95mJPEzmJbQucCsZ\ndLKGtdQjSSOFriK9RExvdYrc5+0CPP+949z/nqxhKysbuNuVDdzt4usss6+CPZG0R3i+4Bpqo6ic\nCLK2Li8iVTt4cA8hRu0cAAD3LuBu+FtqBiH5sssaQHKVFgDg1TD+VS0Nq3H2Gluz6SKhdVcMZuoh\nPK38JtcIAODvhh1Nemnmp+viaXNl+L6a/N7oX3qYNwxVu4ZQCc+ZGcbPMi07VksorVzblKeDiKcy\nxhKrto7ktga6gGlPy7xyFL+auk94ydppstJUs7aZE2J3ko+tKSH+CfcS6orTS4R0qXMjPCjfZ8Oo\ncZ6PiJpnJj/Vt/FISjLWVxwT6I5VUyf6uYv9AAAOXEEHpY5LDmOtax0MSAxj0T3EQXE+VOiRK2yp\nWuO24kgtOrq5hL0fhRrRHZkmbsHFG9o8MMZUNbddgxij58cCwDala6hWZ4IUUV6U/8nU9nnc136V\nnrJ2BJ8/xm2VKGZyqlHOnGPkHK17YalB3nPYyPbklQ3cbQD4W1BXahkAQF0ze3/q19MNOyf6ooQn\nA/gnTz8pvWalxL4K9gTMUpvsAj3UCw0FgD1KJ0XRQhQAQGYlmSm1Mi7ZC1y4wd78+QbIzefpVuPY\navq4iZrikFYUkW3m72ESbmi9CzY7PshN99vwCgAw+t6OIYqQCp68OM+283wDXQixQ4L7WnjQEprB\nTM/Fz4/aJUy2lXIAKNsIxly8wTYaOq84Hyo0fSS5vGIK/8uaodyOJD9xOljo7Xr9R/w6qIwif4/g\nVO3K1j3cmKO1IGnQyw6Te6vIvXLHwtwgbMVQcqFa40qEdKXcI2llT4SBssa2U76+boLpzoN0qDuS\ndE0rMcRDGGL8vzMFziFdKXe58wEAKAUFGebJD5MqD3YVg8yVTQ1fV+zQmvwkB7PkFDnHexPpvbGY\nVexFLYEkkOYF01g9FZw5jlh7JIU78kKo8BYYeR4LrqF9Lx7GqbG7cAiYYZN+fobdVn5LeW+uMDcI\nSw2ihsgdj/Cg7ntRC2ul7THZm8ypRjkgLzA9O1x4w5JwDQOz+oivgMbeg+XbDuUhbu3Xacb5iOPM\nlaF1AzZj6G4OoJjrYJo8ZEwfd+kRMclPTDJXNiUmh1Kj8lL4XEyAlDuVWVhIvh6yDYe8e5xb0VEL\nu0rPwZiF0fi1Y49zP5qE2zAZFWh1XBaOi94ujF9XxO48Vs3K2r1yPJ2DnwZlpaI3xHOyzpvBHvds\ntFXFhOxOmfIjSAV7oomVj/qE1nCN3AlERrQX1VPhvHakBVPxb/Xn52o938epbXCdlIv4nUf5+eaE\njcwdKL3FkMo9Kxqn11uQbBjOs2GUpAKbmzC1ZgS5zMgAb0fiPipxcQH3744O+NOyaJw1nli/OJJf\nBCaOgjfzyblp2cIsa+3YkzVs5dzj5FxQUBJ3HbgvjcF/kTo2pRc/GQBgTxWxW+56xWFy2RlymYqM\n9HBvcWJBKleQPpJcntKLilXyj3s6YWLBIDwzYzQnuZ2lHP8YyLdJ8Cm+SZyXkmV9vLBeS33je1KD\nPhrcZgXeAKMWa0YqKEhxA5JbaKS/Gs79N5ym2hnwnCBv6Jry9yg88+Xewp9A4dldbBAeSK6O0nMA\nAMgYS6yS2uguvZRI//g0t9FWcnx0ituYVYmyQGG2syCCXzC+J9VmXcTfDTu27lLJHKsRZb2Mije5\nsRS07ohBvxAqvJU1hvuxdJJQsieJ2LBoMP7z9DAqKTFAFzExWBe/chi58NIz/KWlUfwqMNMwi/EQ\nB68ZQS4zGOKn65GkSzfRR0zInUBkyK1neDtjPD+SenHvWG6vlAy5V1Ge2pREyUg/eZ04qXApfS6N\nOzf7UWpqWHeK9nTCRIw3FRjsKhkuIclYH2GslNzGdHdADyQdVmmKNT2MSjLeEd+YTeXkJlvLkrJX\nmFF7R3GnFXrvWG6v8e8iwQclAACdUYG2K23lpDhMXm7kWuYOxHNleltJ3HUQnOQnBif58bbcJZF+\nubfwDoUIDADzTl4TC0HaDU0P9xYnnpnIxWeOI3buriJ3VzdDtasOXOM8hbir04TXlO4j+wqRPVxF\nECUj/VA1HJKR6758K2I5i38gq0rIVcO9uXgAoHOqEYzSt9+F3+UBbZukNNX8RyTXLtTGQAsvdkhS\n1LAsPKz0aa5Erl0AoM9M5H7ydcV+VY1cy/9EcUsAgFlfSq5PU6hX1RPx0SluYyfZqJj5soRYBQBQ\n0cA15V5FSnFNdGqA+OLqOC4jawz34+YRXPbrfYSFoJKwk3MV5agJodRzltaz9fl1HZdQtrmE3T/h\nwD2Pz7OHiC5NbPtz3LsgRS+crZCbYg3oQemVvGvxXmK8ZLkv1VeqXCul9Wx9/G48HFSM9pwk/vu/\nR+GZhqSxrF9YxUVcTa665P04WaXhjoCpvQNFTAsUrywi3tNvJn2MPR2tayM2kym/Dh039aQgibUo\ntZX0f5xql2NgU3aWs0ePVbNlThg5OlPtjzti0eK0YDmklEFuBHHRgTModERLo/ilk0OpNutN0V5U\nz7xkLtf4OnNsMwN5VWzRxO8pxc31Qt1gyPuD7k3zl58ll6vVqUlBzl5ja8Zn4/FKDdsYJi4Lx3lu\nFMPpDWKfNw7zi01DIzLK2LzSBrDVaj4z/wTZbhM8qV0e1fz/eyvYE3JhC1rQujn2gO4wwNI2zMWV\nEts9B7mYtKvNYg2o9OJbR3Jbi6egwyuHkQu3JBIrC1K5AjBRKj9n0axIbwPby+7mzcjDM1RkAABg\nNpUh1VAnzYs9eyvYE2raaSOY8dl4vBYX4DOH8DM2kIf55GfiE6lI4AAnMcC0DIGo+sxm5BFaXpAk\nSkF6xgTJGPe22H3elECX9gudcrZY+U2uUcM0kw5zg6Fv9BUWyaXjBrpA4DBfyqIdX9afZ7NmH8Nz\nQOEd5F5FeVoCSM36/MH2srt5w3bjYU2s9R+RkYEZl43H79UYgn2yhq2c8oNVSsJkV6H9fz3Cvy91\ncEA3sV0vrSUfpKqRawnPwOGWPKdgF1GTV8vDQTq4T4t85jKwu2iaGanIh2fJD8D6jktzCoIUK35i\nN79dgOfLyMF8VoQ1pR+Y/TAPV7HFQVvJoE9+JhbING4JTGUTFFqSn7CllD1o4fSP+fw88e+xu4Vp\ncidIhcJojUE6x7B1od+QvVcVE++bI9tYX3GMFoPVTSe6SZWr2UjmonfBOn9nME20AwrJp91mlLF5\nrTs/ar1vJr8O7TE9P8lPTDIOBzGXDwvZdVJKUnsH6rR+jcCih1nbzAl/PcK/H7EDDzT3ByABs+QU\nucR/kxhlaX7C3gr2hN/XpN8/fyLnaZCFyb2Kto/ag0e/nse/Z66sV+9oT/SqvsXdnZXLL4jKxFHL\nz5LzWz9GoyYfnZfM5aptPnC5GV2Wlg9Z/QUsYzhBlJryMWo73b/wAz9v6WlyKWh4H68cxa/G7BCS\n//wjfsP0/Faj32I+LGTXtdZ7v715x7HiR1KNsclXbv3dsOM4PzQu2ZdPHu4txsvkChvDVDZB5X/L\nyP9uuIA22nLbUW9njOP1KH6opzA0yEUM8ncW/RvuosaKJlRReB2dPFCFDqptjGZgehiVtHE4twFa\nNxZbcopc8u5xboU18oXTlIe/M/j7OoGvjgSd6U6IJALCz1H0L2DQcaUU3ZCulLvpB3466tPMr/Sn\nnjL6whUzvwDP/6CQXafl2tYMyydieggxAS6ivwMJDtdbUP3FW6js0FUid99lcZ+xA2ZhNH5tahD/\nTFcddNv2C7H1jcO81fsUBnWlXC9O4hoAAG7ehTK177t3yGegDehdsK6XK+rp5wT+ekdRr3cEvQsl\nugAA1N1BtZXNqPJCI5SZkx77e+Lvhh31Tkh/6y40dqad5wHubQ/7VC/xKT8n0a+skbiwuUzc3FFf\n5wp0x67eTsjregvUd9ZPd8tRmEZkR9LiGNC4cUaHKogdO52JTQnkZ9OChKkAQOfXoT0xO6Q3zTPG\npt9Jt2Ons7IwGr9mUA4AYF48TM5Qu8YUm+1zZcdOZ2JmP2ri6rj7ofbMm/nkXEumyPYplp0/HDP6\nUCmtm8fRAAA51WjbqF3CZK3X220QO39YWreivR993sRCRcg2MsSczEq7DWLnoSfSk/K/OQNdeLEv\nNQHg3o4ymeOItSapGcygTBxtTdqxfQSx81CyYBCe2Zp8Z+xybpPa23877m/JTi6qm1fbsdPZobuI\nBmVolzadX4eOT84hJlc0sFZ/rto+xbLzUJJ/jTgO7cNYmPkFeH7MDiG5ooGzybfc7VMsOw8tS2Pw\nX+YP4Oc3cdD0nxJy7epitNoWYUtIKlPOjh07duzYsWPHjh07dh4A/wcMRwRD90zgYwAAAABJRU5E\nrkJggg==",rn=function(t){c()(n,t);var e=en(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i()(this,n),t=e.call(this,r),v()(u()(t),"template",t.createTemplate(tn(),"poster","width","display","height","speed")),v()(u()(t),"data",{poster:"",status:"",display:"show",speed:"",width:"",height:""}),v()(u()(t),"options",{}),t.options=r,r.player.poster?t.data.poster=r.player.poster:t.data.poster=nn,Object.assign(t.data,r.data),t.init(),t}return o()(n,[{key:"resetPosition",value:function(){if(this.element){var t=this.element.parentNode.offsetWidth,e=this.element.parentNode.offsetHeight;this.element.style.width=t+"px",this.element.style.marginTop=(e-this.element.offsetHeight-20)/2+"px"}}},{key:"bindEvent",value:function(){var t=this;this.events.on(st.LoaderUpdateSpeed,(function(e){"show"===t.data.display&&(t.data.speed=Je.formatBytes(e.speed)+" /s")}))}},{key:"hide",value:function(){"hide"!==this.data.display&&(this.element.style.opacity=0,this.element.style.display="none",this.data.display="hide")}}]),n}(qe);function an(){var t=Qe()(['\n    <gp-control class="goldplay__control--container ','" style="width:',"px;height:","px;opacity:",'" data-status="','">\n      ',"\n      ","\n      ","\n    </gp-control>\n  "]);return an=function(){return t},t}function on(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p()(t);if(e){var i=p()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}var sn=function(t){c()(n,t);var e=on(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i()(this,n),t=e.call(this,r),v()(u()(t),"template",t.createTemplate(an(),"containerFloatCss","width","height","opacity","status","progressBarName|component","sideControlBarName|component","nearControlBarName|component")),v()(u()(t),"hideDelayTime",void 0),v()(u()(t),"hideTimeCount",void 0),v()(u()(t),"data",{progressBarName:"progressBar",sideControlBarName:"sideControlBar",nearControlBarName:"nearControlBar",width:"",height:"",opacity:1,containerFloatCss:"",display:"show",status:""}),v()(u()(t),"options",{}),t.options=r,t.hideDelayTime=t.options.player.controlBarAutoHideTime||3,r.player.controlBarAutoHide&&(t.data.containerFloatCss=t.options.cssName.controlContainerFloat,t.resetPosition()),Object.assign(t.data,r.data),t.init(),t}return o()(n,[{key:"initProps",value:function(){this.hideTimeCount=this.hideDelayTime}},{key:"bindEvent",value:function(){var t=this,e=this.options;e.player.controlBarAutoHide&&(e.$container.addEventListener("mousemove",(function(){t.hideTimeCount<=0&&(t.data.display="show",t.show()),t.hideTimeCount=t.hideDelayTime})),setInterval((function(){t.hideTimeCount>0?t.hideTimeCount-=1:"hide"!==t.data.display&&(t.data.display="hide",t.hide())}),100))}},{key:"setSize",value:function(t,e){void 0!==t&&(this.data.width=t),void 0!==e&&(this.data.height=e)}},{key:"show",value:function(){var t,e=this;this.options.player.controlBarAutoHide?(clearTimeout(t),t=setTimeout((function(){e.data.opacity=1}),1)):this.data.opacity=1}},{key:"hide",value:function(){this.data.opacity=0}},{key:"resetPosition",value:function(){this.setSize(this.options.$container.offsetWidth,this.options.player.controlBarHeight)}}]),n}(qe),un=P.a.get("Delegator.js");function ln(t){return"undefined"!=typeof HTMLElement?t instanceof HTMLElement:"object"===S()(t)&&(1===t.nodeType&&"string"==typeof t.nodeName)}function cn(t){t.preventDefault(),t.stopPropagation()}function hn(t,e,n,r,i){var a=function(t,e){if(t&&t.matches){if(!Array.isArray(e))return t.matches(e);for(var n=0,r=e.length;n<r;n++)if(t.matches(e[n]))return!0}return!1};function o(t){for(var e=(t=t||window.event).target||t.srcElement,i=t.currentTarget,o=!0;o&&e!==i&&e;){if(a(e,n)&&(o=!1!==r.call(e,t)),!o)return void cn(t);e=e.parentNode}}r.__delegateWrapper=o,function(t,e,n,r){void 0===r&&(r="blur"===e||"focus"===e),ln(t)&&t.addEventListener(e,n,r)}(t,e,o,i)}var fn=function(){function t(e){return i()(this,t),v()(this,"element",null),ln(e)?this.element=e:un.error("constructor","new instance","element:",this.element),this}return o()(t,[{key:"off",value:function(t,e,n){return e.__delegateWrapper&&delete(e=e.__delegateWrapper).__delegateWrapper,this.element.removeEventListener(t,e,n),this}},{key:"on",value:function(t,e,n,r){var i=this;return Array.isArray(e)?e.forEach((function(e){hn(i.element,t,e,n,r)})):hn(this.element,t,e,n,r),this}},{key:"once",value:function(t,e,n,r){return this.on(t,e,n,{capture:r,once:!0}),this}}]),t}(),dn=null,pn=function(t){return"string"==typeof t&&(t=document.querySelector(t)),dn?dn.element=t:dn=new fn(t),dn},yn=function(){function t(e,n){var r=n.$container,a=n.type,o=n.scope,s=n.onStart,u=n.onDrag,l=n.onRelease;i()(this,t),v()(this,"$container",null),v()(this,"$ele",null),v()(this,"active",!1),v()(this,"offsetX",0),v()(this,"offsetY",0),v()(this,"offsetLeft",0),v()(this,"offsetTop",0),v()(this,"orginOffsetLeft",0),v()(this,"orginOffsetTop",0),v()(this,"orginOffsetWidth",0),v()(this,"orginOffsetHeight",0),v()(this,"initialX",0),v()(this,"initialY",0),v()(this,"type","default"),v()(this,"scope",{}),this.$container=r||document.body,this.$ele=e,this.type=a,this.scope=o,this.eventsList={},this.onStart=s,this.onDrag=u,this.onRelease=l,this.bindEvent()}return o()(t,[{key:"addEventListener",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return t.addEventListener(e,n,r),{destroy:function(){t.removeEventListener(e,n)}}}},{key:"removeEventListenerAll",value:function(){var t=this;Object.keys(this.eventsList).forEach((function(e){t.eventsList[e].destroy()}))}},{key:"bindEvent",value:function(){var t=this;this.eventsList.mousedown=this.addEventListener(this.$container,"mousedown",(function(e){t.start(e)}),!1),this.eventsList.mouseup=this.addEventListener(this.$container,"mouseup",(function(e){t.release(e)}),!1),this.eventsList.mousemove=this.addEventListener(this.$container,"mousemove",(function(e){t.drag(e)}),!1)}},{key:"start",value:function(t){t.target===this.$ele&&(void 0===this.scope&&void 0!==this.$container&&(this.scope={left:this.$container.offsetLeft,right:this.$container.offsetLeft+this.$container.offsetWidth,top:this.$container.offsetTop,bottom:this.$container.offsetTop+this.$container.offsetHeight}),this.offsetLeft=this.$ele.offsetLeft,this.offsetTop=this.$ele.offsetTop,this.active=!0,this.initialX=t.clientX,this.initialY=t.clientY,this.orginOffsetLeft=this.$ele.offsetLeft,this.orginOffsetTop=this.$ele.offsetTop,this.orginOffsetWidth=this.$ele.offsetWidth,this.orginOffsetHeight=this.$ele.offsetHeight,"function"==typeof this.onStart&&this.onStart.call(this,this.offsetX,this.offsetY,t,this))}},{key:"release",value:function(t){this.active=!1,"function"==typeof this.onRelease&&this.onRelease.call(this,this.offsetX,this.offsetY,t,this)}},{key:"drag",value:function(t){this.active&&(t.preventDefault(),t.stopPropagation(),this.offsetX=t.clientX-this.initialX+this.offsetLeft,this.offsetY=t.clientY-this.initialY+this.offsetTop,this.setPosition(t))}},{key:"setPosition",value:function(t){switch(this.type){case"vertical":this.offsetX=this.orginOffsetLeft,this.offsetY<this.scope.top&&(this.offsetY=this.scope.top),this.offsetY>this.scope.bottom-this.orginOffsetHeight&&(this.offsetY=this.scope.bottom-this.orginOffsetHeight);break;case"level":this.offsetY=this.orginOffsetTop,this.offsetX>this.scope.right-this.orginOffsetWidth&&(this.offsetX=this.scope.right-this.orginOffsetWidth),this.offsetX<this.scope.left&&(this.offsetX=this.scope.left);break;default:isNaN(this.scope.right)||this.offsetX>this.scope.right-this.orginOffsetWidth&&(this.offsetX=this.scope.right-this.orginOffsetWidth),isNaN(this.scope.left)||this.offsetX<this.scope.left&&(this.offsetX=this.scope.left),isNaN(this.scope.top)||this.offsetY<this.scope.top&&(this.offsetY=this.scope.top),isNaN(this.scope.bottom)||this.offsetY>this.scope.bottom-this.orginOffsetHeight&&(this.offsetY=this.scope.bottom-this.orginOffsetHeight)}this.$ele.style.left=this.offsetX+"px",this.$ele.style.top=this.offsetY+"px","function"==typeof this.onDrag&&this.onDrag.call(this,this.offsetX,this.offsetY,t,this)}},{key:"destroy",value:function(){this.$ele.parentNode.removeChild(this.$ele),this.removeEventListenerAll()}}]),t}(),vn=function(t,e){return new yn(t,e)};function gn(){var t=Qe()(['\n    <gp-control-progressbar class="goldplay__progress-bar ','" data-status="','">\n      <div class="goldplay__progressbar--load ','">\n      </div>\n      <div class="goldplay__progressbar--play ','">\n      </div>\n      <span class="goldplay__progressbar--dot ','" title="','"></span>\n    </gp-control-progressbar>\n  ']);return gn=function(){return t},t}function mn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p()(t);if(e){var i=p()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}var bn=function(t){c()(n,t);var e=mn(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i()(this,n),t=e.call(this,r),v()(u()(t),"template",t.createTemplate(gn(),"progressBarHoverCss","status","progressBarLoadHoverCss","progressBarPlayHoverCss","progressBarDotHoverCss","time")),v()(u()(t),"options",{}),v()(u()(t),"data",{playWidth:"",dot:"",time:"",status:""}),v()(u()(t),"setProgressBarSize",(function(e){t.$progressBarPlay.style.width=e+"px"})),t.options=r,Object.assign(t.data,r.data),t.init(),t}return o()(n,[{key:"watch",value:function(){var t=this.options.cssName;"dragstart"===this.data.status?(this.data.progressBarHoverCss=t.progressBarHover,this.data.progressBarLoadHoverCss=t.progressBarLoadHover,this.data.progressBarPlayHoverCss=t.progressBarPlayHover,this.data.progressBarDotHoverCss=t.progressBarDotHover):"dragend"===this.data.status&&(this.data.progressBarHoverCss="",this.data.progressBarLoadHoverCss="",this.data.progressBarPlayHoverCss="",this.data.progressBarDotHoverCss="")}},{key:"afterInit",value:function(){}},{key:"initProps",value:function(){var t=this.element,e=this.options.cssName;this.$progressDragDot=t.querySelector("."+e.progressBarDot),this.$progressBarPlay=t.querySelector("."+e.progressBarPlay),this.$progressBarLoad=t.querySelector("."+e.progressBarLoad),this.timer=this.getComponent("timer"),this.pauseButton=this.getComponent("pauseButton")}},{key:"bindEvent",value:function(){var t=this,e=this.options.cssName,n=!1;this.events.on(st.PlayerTimeUpdate,(function(e){var r=t.options.loadData.sourceData.duration;if(!n&&e&&r){var i=e/1e3/r*t.progressBarWidth;t.setProgressPosition(i),t.timer.data.time=Ze.formatHHMMSS(e/1e3)}})),this.events.on(st.PlayerbufferUpdate,(function(e){!n&&e&&t.updateProgressLoad(e)})),pn(this.options.$controlBarContainer).on("click","."+e.progressBar,(function(n){if(n.target!==t.$progressDragDot){var r=(t.options.loadData.sourceData.duration||0)/t.progressBarWidth,i=0;n.target.classList.contains(e.progressBarLoad)&&(i=n.target.offsetLeft-n.target.parentNode.offsetLeft);var a=i+n.offsetX,o=a*r*1e3;return t.setProgressPosition(a),t.logger.info("bindEvent","click to seek","seekTime:",o,"offsetX:",a),n.target!==t.$progressBarLoad&&t.clearLoadBar(n.offsetX),t.timer.data.time=Ze.formatHHMMSS(o/1e3),t.events.emit(st.PlayerOnSeek,o),!1}})),this.progressDragEvent=vn(this.$progressDragDot,{$container:document.body,type:"level",scope:{left:this.progressBarLeft,right:this.progressBarLeft+this.progressBarWidth,top:this.$progressDragDot.offsetTop,bottom:this.$progressDragDot.offsetTop+this.$progressDragDot.offsetHeight},onStart:function(){n=!0,t.data.status="dragstart"},onDrag:function(e){var n;n=t.options.player.controlBarAutoHide?e:e-t.options.$controlBarContainer.offsetLeft;var r=0,i=t.$progressDragDot.offsetWidth;t.progressBarWidth-n<=i&&(r=i),t.setProgressBarSize(n),t.data.status="draging";var a=t.getSeekTime(t.progressBarWidth-r);t.timer.data.time=Ze.formatHHMMSS(a/1e3),t.data.time=t.timer.data.time},onRelease:function(e,r,i){if(n){var a=t.getSeekTime();i.target!==t.$progressBarLoad&&t.clearLoadBar(e),t.events.emit(st.PlayerOnSeek,a),t.logger.info("bindEvent","onDrag release seek","seekTime:",a),t.data.status="dragend",n=!1}}})}},{key:"setProgressPosition",value:function(t){var e=Math.min(t,this.progressBarWidth),n=this.$progressDragDot,r=this.progressBarWidth,i=0,a=n.offsetWidth/2;e>r||r-e<=a?i=a-(r-e):e<=a&&(i=-(a-e));var o=e-i-n.offsetWidth/2;this.setProgressPlayWidth(e),this.setProgressDragDotLeft(o+this.progressBarLeft)}},{key:"setProgressPlayWidth",value:function(t){this.$progressBarPlay.style.width=t+"px"}},{key:"setProgressDragDotLeft",value:function(t){this.$progressDragDot.style.left=t+"px"}},{key:"getProgressPlayLeftWidth",value:function(){return{offsetLeft:this.$progressBarPlay.offsetLeft,offsetWidth:this.$progressBarPlay.offsetWidth}}},{key:"getProgressLoadLeftWidth",value:function(){return{offsetLeft:this.$progressBarLoad.offsetLeft,offsetWidth:this.$progressBarLoad.offsetWidth}}},{key:"setProgressLoadLeftWidth",value:function(t,e){var n=this.progressBarLeft+this.progressBarWidth;(t=Math.min(t,n))+e>n&&(e=n-t),this.$progressBarLoad.style.left=t+"px",this.$progressBarLoad.style.width=e+"px"}},{key:"updateProgressLoad",value:function(t){var e=this.options.loadData.sourceData.duration;if(e){var n=this.progressBarWidth,r=this.progressBarLeft,i=t[0]/1e3/e*n,a=t[1]/1e3/e*n,o=Math.floor(r+i),s=Math.floor(a-i);this.setProgressLoadLeftWidth(o,s)}}},{key:"getSeekTime",value:function(t,e){var n=this.progressBarWidth,r=(e=e||this.options.loadData.sourceData.duration||0)/(t||n);return this.$progressBarPlay.offsetWidth*r*1e3}},{key:"clearLoadBar",value:function(t){t<this.$progressBarLoad.offsetLeft-this.progressBarLeft&&(this.$progressBarLoad.style.width="0px")}},{key:"getDragDotPosition",value:function(){return{offsetLeft:this.$progressDragDot.offsetLeft,offsetTop:this.$progressDragDot.offsetTop,left:this.$progressDragDot.style.left,top:this.$progressDragDot.style.top}}},{key:"clearDragDotTop",value:function(){this.$progressDragDot.style.top=""}},{key:"progressBarWidth",get:function(){return this.element.offsetWidth}},{key:"progressBarLeft",get:function(){return this.element.offsetLeft}}]),n}(qe);function kn(){var t=Qe()(['\n  <gp-button class="goldplay__control--play" data-status="','" title="','">\n  <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n  viewBox="0 0 232.153 232.153" width="20" height="20" style="enable-background:new 0 0 232.153 232.153;" xml:space="preserve">\n  <g >\n  <path style="fill-rule:evenodd;clip-rule:evenodd;" d="M203.791,99.628L49.307,2.294c-4.567-2.719-10.238-2.266-14.521-2.266\n    c-17.132,0-17.056,13.227-17.056,16.578v198.94c0,2.833-0.075,16.579,17.056,16.579c4.283,0,9.955,0.451,14.521-2.267\n    l154.483-97.333c12.68-7.545,10.489-16.449,10.489-16.449S216.471,107.172,203.791,99.628z" fill="#f1f1f1"/>\n  </g>\n  </svg>\n  </gp-button>\n  ']);return kn=function(){return t},t}function Pn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p()(t);if(e){var i=p()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}var wn=function(t){c()(n,t);var e=Pn(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i()(this,n),t=e.call(this,r),v()(u()(t),"template",t.createTemplate(kn(),"status","title")),v()(u()(t),"data",{title:"play",play:">"}),v()(u()(t),"options",{}),t.options=r,Object.assign(t.data,r.data),t.init(),t}return n}(qe);function xn(){var t=Qe()(['\n  <gp-button class="goldplay__control--pause" title="','" status="','">\n  ',"\n  </gp-button>\n  "]);return xn=function(){return t},t}function _n(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p()(t);if(e){var i=p()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}function Bn(){var t=Qe()(['\n<svg style="display:','" class="goldplay__control--pausing" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="20px" height="20px" viewBox="0 0 26 26" style="background:none" xml:space="preserve">\n<g>\n<path d="M2.667,0h6v26h-6V0z M15.333,0v26h6V0H15.333z" fill="#f1f1f1"/>\n</g>\n</svg>\n']);return Bn=function(){return t},t}var Tn=Oe.create(Bn(),"pauseHide"),En=function(t){c()(n,t);var e=_n(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i()(this,n),t=e.call(this,r),v()(u()(t),"template",t.createTemplate((function(t,e){return e(xn(),"title","status","icon|html")}))),v()(u()(t),"data",{title:"pause",pauseHide:"",pauseLoadingHide:"none",icon:Tn,status:"",display:""}),v()(u()(t),"options",{}),t.options=r,Object.assign(t.data,r.data),t.init(),t}return o()(n,[{key:"watch",value:function(){"pauseloading"===this.data.status?(this.data.pauseHide="none",this.data.pauseLoadingHide="inline-block",this.data.title="loading",this.data.icon='\n<svg version="1.1" class="goldplay__control--pause-loading" style="display:${\'pauseLoadingHide\'}" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="25px" height="25px" viewBox="0 0 612 792" style="background:none;margin: -4px 0 0 -5px;" xml:space="preserve">\n<linearGradient id="goldplay-pause-loading-gradient" gradientUnits="userSpaceOnUse" x1="1.98" y1="784.6123" x2="26.2101" y2="770.623" gradientTransform="matrix(21.8571 0 0 21.8571 -2.0895 -16600.5293)">\n    <stop offset="0.1682" style="stop-color:#f1f1f1;stop-opacity:0"></stop>\n    <stop offset="0.7502" style="stop-color:#f1f1f1"></stop>\n    <stop offset="1" style="stop-color:#f1f1f1"></stop>\n</linearGradient>\n<path style="transform-origin: center center;animation: goldplay-rotate-360 .8s linear infinite;" fill="url(#goldplay-pause-loading-gradient)" d="M306,133.714c144.257,0,262.286,118.028,262.286,262.286c0,144.257-118.029,262.286-262.286,262.286\n  C161.743,658.286,43.714,540.257,43.714,396C43.714,251.743,161.743,133.714,306,133.714 M306,90C137.7,90,0,227.7,0,396\n  s137.7,306,306,306s306-137.7,306-306S474.3,90,306,90L306,90z">\n    <animateTransform attributeName="transform" attributeType="XML" type="rotate" from="0" to="360" dur=".8s" repeatCount="indefinite" />\n</path>\n<g>\n    <g>\n        <path fill="#f1f1f1" d="M229.5,514.028L229.5,514.028c-13.114,0-21.857-8.742-21.857-21.856V295.457\n        c0-10.929,8.743-21.857,21.857-21.857l0,0c10.929,0,21.857,8.743,21.857,21.857v196.715\n        C251.357,503.1,242.614,514.028,229.5,514.028z"></path>\n        <path fill="#f1f1f1" d="M229.5,273.6c-13.114,0-21.857,8.743-21.857,21.857v196.715c0,10.928,8.743,21.856,21.857,21.856\n        s21.857-10.929,21.857-21.856V295.457C251.357,282.343,242.614,273.6,229.5,273.6L229.5,273.6z"></path>\n    </g>\n    <g>\n        <path fill="#f1f1f1" d="M382.5,518.4L382.5,518.4c-13.114,0-21.857-8.743-21.857-21.857V299.829\n        c0-10.929,8.743-21.857,21.857-21.857l0,0c10.929,0,21.857,8.743,21.857,21.857v196.714\n        C404.357,509.657,395.614,518.4,382.5,518.4z"></path>\n        <path fill="#f1f1f1" d="M382.5,277.972c-10.929,0-21.857,8.743-21.857,21.857v196.714c0,10.929,10.929,21.857,21.857,21.857\n        s21.857-10.929,21.857-21.857V299.829C404.357,288.9,393.429,277.972,382.5,277.972L382.5,277.972z"></path>\n    </g>\n</g>\n</svg>\n'):"pause"===this.data.status&&(this.data.pauseHide="inline-block",this.data.pauseLoadingHide="none",this.data.title="pause",this.data.icon=Tn)}}]),n}(qe);function Sn(){var t=Qe()(['\n  <gp-button class="goldplay__control--replay" title="','" data-display="','">\n  <svg version="1.0" xmlns="http://www.w3.org/2000/svg"\n  width="24px" height="24px" viewBox="0 0 245.000000 206.000000"\n  preserveAspectRatio="xMidYMid meet">\n <g transform="translate(0.000000,206.000000) scale(0.100000,-0.100000)"\n fill="#f1f1f1" stroke="1">\n <path d="M1250 2046 c-286 -55 -525 -211 -681 -445 -91 -136 -152 -302 -167\n -453 -12 -119 3 -108 -143 -109 -70 -1 -156 -4 -192 -8 l-65 -6 262 -265 262\n -265 266 265 265 265 -62 6 c-35 4 -123 7 -197 8 l-134 1 7 69 c26 284 232\n 543 504 635 201 69 404 53 596 -47 62 -32 103 -63 177 -137 83 -83 102 -108\n 142 -190 63 -130 77 -193 77 -340 0 -178 -37 -298 -134 -435 -91 -126 -220\n -224 -369 -278 -72 -26 -99 -31 -218 -35 -117 -4 -146 -1 -215 17 -104 29\n -205 79 -283 142 l-63 52 -89 -89 c-49 -49 -89 -96 -89 -106 0 -24 154 -136\n 253 -185 89 -44 177 -74 272 -95 84 -17 303 -15 391 5 403 91 691 371 795 772\n 19 76 23 114 22 240 0 129 -4 164 -27 249 -99 377 -406 673 -778 751 -104 22\n -297 28 -385 11z"/>\n <path d="M1227 1418 c-9 -68 -7 -695 2 -770 l6 -57 240 200 c132 110 251 210\n 264 223 l23 24 -257 213 c-141 118 -260 215 -264 217 -5 1 -11 -21 -14 -50z"/>\n </g>\n </svg>\n  </gp-button>\n  ']);return Sn=function(){return t},t}function Rn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p()(t);if(e){var i=p()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}var Ln=function(t){c()(n,t);var e=Rn(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i()(this,n),t=e.call(this,r),v()(u()(t),"template",t.createTemplate(Sn(),"title","display")),v()(u()(t),"data",{title:"replay",display:"",replay:"->"}),v()(u()(t),"options",{}),t.options=r,Object.assign(t.data,r.data),t.init(),t}return n}(qe);function Dn(){var t=Qe()(['\n  <gp-volume class="goldplay__volume-bar">\n    <gp-overbox class="goldplay-hoverbox goldplay__volume-bar--handle">\n      <span class="goldplay__volume-bar--precent">','</span>\n      <span class="goldplay__volume-bar--rod ','" title="adjust volume"></span>\n      <span class="goldplay__volume-bar--size">&nbsp;</span>\n      <span class="goldplay__volume-bar--column">&nbsp;</span>\n    </gp-overbox>\n    <gp-button class="goldplay__volume-bar--audio ','" title="','" data-mute="','" data-volume-size="','"  data-last-volume="','">\n    ',"\n    </gp-button>\n  </gp-volume>\n  "]);return Dn=function(){return t},t}function Cn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p()(t);if(e){var i=p()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}function An(){var t=Qe()(['\n<svg xmlns="http://www.w3.org/2000/svg" style="display:','" width="20px" height="20px" viewBox="0 0 24 24" style="margin-left: -5px;">\n<path d="M12.2 13.914v6.678a.5.5 0 0 1-.825.38L5.2 15.679H3a1 1 0 0 1-1-1v-6a1 1 0 0 1 1-1h2.2l.412-.353-2.558-2.558a.5.5 0 0 1 0-.707l.707-.707a.5.5 0 0 1 .707 0l16.849 16.849a.5.5 0 0 1 0 .707l-.707.707a.5.5 0 0 1-.707 0l-2.386-2.386a10 10 0 0 1-2.33 1.422c-.526.229-.583.284-.987.377v-2.375l.007-.003a8.332 8.332 0 0 0 1.717-1.014l-1.67-1.669a5.251 5.251 0 0 1-.054.034v-.089l-2-2zM8.373 4.96l3.002-2.572a.5.5 0 0 1 .825.38v6.019L8.373 4.959zm9.867 9.867c.48-.99.76-2.115.76-3.347 0-3.418-2.148-6.014-4.793-7.173a4.11 4.11 0 0 0-.007-.003V2c.027.006.054.012.082.02.852.221 1.274.453 1.436.535A10 10 0 0 1 21.2 11.48a9.954 9.954 0 0 1-1.326 4.98l-1.634-1.633zm-1.766-1.766L14.2 10.786V7.057a5.247 5.247 0 0 1 2.274 6.003z" fill="#f1f1f1"></path>\n</svg>\n']);return An=function(){return t},t}function On(){var t=Qe()(['\n<svg xmlns="http://www.w3.org/2000/svg" style="display:','" width="20px" height="20px" viewBox="0 0 24 24" style="margin-left: -5px;">\n<path d="M5.2 7.68l6.175-5.293a.5.5 0 0 1 .825.38v17.825a.5.5 0 0 1-.825.38L5.2 15.679H3a1 1 0 0 1-1-1v-6a1 1 0 0 1 1-1h2.2zm9 13.35v-2.375l.007-.003C16.852 17.493 19 14.897 19 11.479s-2.148-6.014-4.793-7.173a4.11 4.11 0 0 0-.007-.003V2c.027.006.054.012.082.02.852.221 1.274.453 1.436.535A10 10 0 0 1 21.2 11.48c0 4.106-2.474 7.633-6.013 9.174-.526.229-.583.284-.987.377zm0-13.973c1.5.925 2.5 2.582 2.5 4.473 0 1.892-1 3.55-2.5 4.473V7.057z" fill="#f1f1f1"></path>\n</svg>\n']);return On=function(){return t},t}var Mn=Oe.create(On(),"audioOnHide"),In=Oe.create(An(),"audioOffHide"),Un=function(t){c()(n,t);var e=Cn(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i()(this,n),t=e.call(this,r),v()(u()(t),"template",t.createTemplate(Dn(),"dataPrecent","volumeBarRodHoverCss","audioOffClass","title","dataMute","dataVolumeSize","dataLastVolume","icon|html")),v()(u()(t),"options",{}),v()(u()(t),"data",{audioONHide:"",audioOffHide:"",audioOffClass:"",dataVolumeSize:"",dataPrecent:"",dataLastVolume:"",dataMute:"",volumeBarRodHoverCss:"",icon:Mn,title:"turn off"}),t.options=r,Object.assign(t.data,r.data),t.init(),t}return o()(n,[{key:"watch",value:function(){this.data.dataPrecent=Math.floor(100*this.data.dataVolumeSize),""!==this.data.audioOffClass?(this.data.dataMute="true",this.data.audioOffHide="inline-block",this.data.audioOnHide="none",this.data.icon=In,this.data.title="turn on"):(this.data.dataMute="",this.data.audioOffHide="none",this.data.audioOnHide="inline-block",this.data.icon=Mn,this.data.title="turn off")}},{key:"initProps",value:function(){var t=this.element,e=this.options.cssName;this.INIT_VOLUME_SIZE=void 0===this.options.player.defaultVolumeSize?.5:this.options.player.defaultVolumeSize,this.$volumeBarHandle=t.querySelector("."+e.volumeBarHandle),this.$volumeBarRod=t.querySelector("."+e.volumeBarRod),this.$volumeBarAudio=t.querySelector("."+e.volumeBarAudio),this.$volumeBarSize=t.querySelector("."+e.volumeBarSize),this.$volumeBarColumn=t.querySelector("."+e.volumeBarColumn),this.volumeBarColumnHeight=this.$volumeBarColumn.offsetHeight,this.volumeBarColumnTop=this.$volumeBarColumn.offsetTop,this.volumeBarRodHeight=this.$volumeBarRod.offsetHeight,this.volumeBarRodHeightHalf=this.volumeBarRodHeight/2,this.volumeBarColumnRealTop=this.volumeBarColumnTop+this.volumeBarRodHeightHalf,this.volumeBarColumnMaxHeight=this.volumeBarColumnHeight-this.volumeBarRodHeight}},{key:"bindEvent",value:function(){var t,e=this,n=this.options.$controlBarContainer,r=this.options.cssName;pn(n).on("mouseover","."+r.volumeBar,(function(){clearTimeout(t),e.showVolumeBarHandle()})),pn(n).on("mousewheel","."+r.volumeBarHandle,(function(t){var n=t.wheelDelta/500;n=e.data.dataVolumeSize+n,e.setVolumeSize(n),t.preventDefault(),t.stopPropagation()})),pn(n).on("click",["."+r.volumeBarColumn,"."+r.volumeBarSize],(function(t){var n=0;return t.target===e.$volumeBarColumn?n=(e.$volumeBarColumn.offsetHeight-t.offsetY)/t.target.offsetHeight:t.target===e.$volumeBarSize&&(n=e.$volumeBarColumn.offsetHeight-t.target.offsetHeight+t.offsetY,n=e.$volumeBarColumn.offsetHeight-n,n/=e.$volumeBarColumn.offsetHeight),e.setVolumeSize(n),!1})),pn(n).on("click","."+r.volumeBarAudio,(function(t){return e.$volumeBarAudio.classList.contains(r.volumeBarAudioOff)?e.setAudioOn(t.offsetY):e.setAudioOff(t.offsetY),!1}));pn(n).on("mouseout","."+r.volumeBar,(function(n){t=setTimeout((function(){!function(t){var n=e.element,r={y:n.offsetTop+e.$volumeBarHandle.offsetTop,x:n.offsetLeft};return r.width=n.offsetWidth,r.height=e.$volumeBarHandle.offsetHeight,t.pageX>r.x&&t.pageX<r.x+r.width&&t.pageY>r.y&&t.pageY<r.y+r.height}(n)?e.hideVolumeBarHandle():clearTimeout(t)}),N.c.hideBarBoxTime)})),this.volumeDragEvent=vn(this.$volumeBarRod,{$container:this.element,type:"vertical",scope:{top:this.volumeBarColumnTop,right:0,bottom:this.volumeBarColumnTop+this.volumeBarColumnHeight,left:0},onStart:function(){e.data.volumeBarRodHoverCss=e.options.cssName.volumeBarRodHover},onDrag:function(t,n){n-=1,e.dragHandle(n)},onRelease:function(){e.data.volumeBarRodHoverCss=""}})}},{key:"hideVolumeBarHandle",value:function(){this.$volumeBarHandle.style.visibility="hidden"}},{key:"showVolumeBarHandle",value:function(){this.$volumeBarHandle.style.visibility="visible"}},{key:"getVolume",value:function(){var t=(this.$volumeBarSize.offsetHeight-this.volumeBarRodHeight)/this.volumeBarColumnMaxHeight;return t=Math.min(t,1),(t=Math.max(t,0)).toFixed(2)}},{key:"setVolume",value:function(t){this.data.dataVolumeSize=Number(t),this.events.emit(st.PlayerOnVolume,t)}},{key:"initVolumeSize",value:function(){this.data.dataLastVolume=this.INIT_VOLUME_SIZE,this.setAudioOn()}},{key:"setAudioOn",value:function(){var t=this.data.dataLastVolume||0;this.setVolume(t);var e=parseFloat(t,10),n=Math.floor(e*this.volumeBarColumnMaxHeight),r=this.volumeBarColumnTop+(this.volumeBarColumnMaxHeight-n);this.$volumeBarSize.style.marginTop=r+"px",this.$volumeBarSize.style.height=n+this.volumeBarRodHeight+"px",this.$volumeBarRod.style.top=r+"px",this.data.audioOffClass=""}},{key:"setAudioOff",value:function(){this.setVolume(0),this.data.audioOffClass=this.options.cssName.volumeBarAudioOff;var t=this.getVolume();t>0&&(this.data.dataLastVolume=t),this.$volumeBarSize.style.height=this.volumeBarRodHeight+"px",this.$volumeBarSize.style.marginTop=this.volumeBarColumnRealTop-this.volumeBarRodHeightHalf+this.volumeBarColumnMaxHeight+"px",this.$volumeBarRod.style.top=this.volumeBarColumnRealTop+this.volumeBarColumnMaxHeight-this.volumeBarRodHeightHalf+"px"}},{key:"dragHandle",value:function(t){this.$volumeBarSize.style.marginTop=t+1+"px",this.$volumeBarSize.style.height=this.volumeBarColumnHeight-t+this.volumeBarRodHeight+"px";var e=this.getVolume();e<=0?this.setAudioOff(t):"true"==this.data.dataMute&&this.setAudioOn(t),this.setVolume(e)}},{key:"setVolumeSize",value:function(t){if((t=t.toFixed(2))>=1?t=1:t<.001&&(t=0),t!==this.data.dataVolumeSize){this.setVolume(t);var e=this.volumeBarColumnMaxHeight,n=e-t*e+this.volumeBarColumnTop;this.$volumeBarSize.style.marginTop=n+"px",this.$volumeBarSize.style.height=t*e+this.volumeBarRodHeight+"px",this.$volumeBarRod.style.top=n+"px",t<=0?this.data.audioOffClass=this.options.cssName.volumeBarAudioOff:"true"==this.data.dataMute&&(this.data.audioOffClass="")}}}]),n}(qe);function Nn(){var t=Qe()(['\n  <gp-wait class="goldplay-tip goldplay__waiting-bar" title="','" data-status="','">\n    <span class="goldplay__waiting-bar--icon">\n    <svg width="60px" height="60px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid" style="background: none;opacity:0.8">\n    <circle cx="50" cy="50" fill="none" stroke-linecap="round" r="40" stroke-width="8" stroke="#f6f6f6" stroke-dasharray="62.83185307179586 62.83185307179586" transform="rotate(17.8841 50 50)">\n    <animateTransform attributeName="transform" type="rotate" calcMode="linear" values="0 50 50;360 50 50" keyTimes="0;1" dur="0.7s" begin="0s" repeatCount="indefinite">\n    </animateTransform>\n    </circle>\n    </svg>\n  </span>\n  <gp-speed class="goldplay__waiting-bar--speed">',"</gp-speed>\n  </gp-wait>\n  "]);return Nn=function(){return t},t}function Hn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p()(t);if(e){var i=p()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}var Fn=function(t){c()(n,t);var e=Hn(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i()(this,n),t=e.call(this,r),v()(u()(t),"template",t.createTemplate(Nn(),"title","status","speed")),v()(u()(t),"data",{title:"waiting",speed:"",status:"",display:"show"}),v()(u()(t),"options",{}),t.options=r,Object.assign(t.data,r.data),t.init(),t}return o()(n,[{key:"initProps",value:function(){}},{key:"bindEvent",value:function(){var t=this;this.events.on(st.LoaderUpdateSpeed,(function(e){"show"===t.data.display&&(t.data.speed=Je.formatBytes(e.speed)+" /s")}))}},{key:"showWaiting",value:function(){var t=this.options.cssName,e=this.options.$screenContainer;e.querySelector("."+t.waitingBar)||e.prepend(this.element),this.data.display="show",this.show(),this.resetPosition()}},{key:"hideWaiting",value:function(){var t=this.options.cssName;this.options.$screenContainer.querySelector("."+t.waitingBar)&&(this.data.display="hide",this.data.speed="Loading...",this.hide())}}]),n}(qe);function jn(){var t=Qe()(['\n  <gp-alert class="goldplay-tip goldplay__alter-box" title="','" data-display="','">\n  <em title="close" class="goldplay__alter--close">\n    <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="background:none;opacity:0.6" xml:space="preserve" width="20px" height="20px" viewBox="0 0 496.158 496.158">\n    <path style="fill:#ff3300;" d="M496.158,248.085c0-137.021-111.07-248.082-248.076-248.082C111.07,0.003,0,111.063,0,248.085\n    c0,137.002,111.07,248.07,248.082,248.07C385.088,496.155,496.158,385.087,496.158,248.085z"/>\n    <path style="fill:#FFFFFF;" d="M277.042,248.082l72.528-84.196c7.91-9.182,6.876-23.041-2.31-30.951\n    c-9.172-7.904-23.032-6.876-30.947,2.306l-68.236,79.212l-68.229-79.212c-7.91-9.188-21.771-10.216-30.954-2.306\n    c-9.186,7.91-10.214,21.77-2.304,30.951l72.522,84.196l-72.522,84.192c-7.91,9.182-6.882,23.041,2.304,30.951\n    c4.143,3.569,9.241,5.318,14.316,5.318c6.161,0,12.294-2.586,16.638-7.624l68.229-79.212l68.236,79.212\n    c4.338,5.041,10.47,7.624,16.637,7.624c5.069,0,10.168-1.749,14.311-5.318c9.186-7.91,10.22-21.77,2.31-30.951L277.042,248.082z"/>\n    </svg>\n  </em>\n  <span class="goldplay__alter--warn">\n    <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n    width="30" height="30" viewBox="0 0 512 512" style="enable-background:new 0 0 512 512;" xml:space="preserve">\n    <path style="fill:#495A79;" d="M501.461,383.799L320.501,51.401C306.7,28.6,282.7,14.8,256,14.8s-50.7,13.8-64.501,36.601\n      L10.539,383.799C-3.259,407.501-3.56,435.701,9.941,459.4c13.499,23.699,37.798,37.8,65.099,37.8h361.92\n      c27.301,0,51.601-14.101,65.099-37.8C515.56,435.701,515.259,407.501,501.461,383.799z"/>\n    <path style="fill:#42516D;" d="M502.059,459.4c-13.499,23.699-37.798,37.8-65.099,37.8H256V14.8c26.7,0,50.7,13.801,64.501,36.601\n      L501.461,383.8C515.259,407.501,515.56,435.701,502.059,459.4z"/>\n    <path style="fill:#FFDE33;" d="M475.661,399.1L294.699,66.699C286.601,52.9,271.901,44.8,256,44.8s-30.601,8.101-38.699,21.899\n      L36.339,399.1c-8.399,14.101-8.399,31.199-0.298,45.3c8.099,14.399,22.798,22.8,39,22.8h361.92c16.201,0,30.901-8.401,39-22.8\n      C484.06,430.299,484.06,413.201,475.661,399.1z"/>\n    <path style="fill:#FFBC33;" d="M475.96,444.4c-8.099,14.399-22.798,22.8-39,22.8H256V44.8c15.901,0,30.601,8.101,38.699,21.899\n      L475.661,399.1C484.06,413.201,484.06,430.299,475.96,444.4z"/>\n    <g>\n      <path style="fill:#495A79;" d="M256,437.2c-16.538,0-30-13.462-30-30s13.462-30,30-30s30,13.462,30,30S272.538,437.2,256,437.2z"/>\n      <path style="fill:#495A79;" d="M286,317.2c0,16.538-13.462,30-30,30s-30-13.462-30-30v-150c0-16.538,13.462-30,30-30\n        s30,13.462,30,30V317.2z"/>\n    </g>\n    <g>\n      <path style="fill:#42516D;" d="M286,407.2c0-16.538-13.462-30-30-30v60C272.538,437.2,286,423.738,286,407.2z"/>\n      <path style="fill:#42516D;" d="M286,317.2v-150c0-16.538-13.462-30-30-30v210C272.538,347.2,286,333.738,286,317.2z"/>\n    </g>\n    </svg>\n  </span>\n  <gp-content class="goldplay__alter--content">',"</gp-content>\n  </gp-alert>\n  "]);return jn=function(){return t},t}function Wn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p()(t);if(e){var i=p()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}var Vn=function(t){c()(n,t);var e=Wn(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i()(this,n),t=e.call(this,r),v()(u()(t),"template",t.createTemplate(jn(),"title","display","content|trim")),v()(u()(t),"data",{title:"alert",display:"default",content:""}),v()(u()(t),"options",{}),t.options=r,Object.assign(t.data,r.data),t.init(),t}return o()(n,[{key:"bindEvent",value:function(){var t=this,e=this.options.$screenContainer,n=this.options.cssName;pn(e).on("click","."+n.alertClose,(function(){t.hide()}))}},{key:"afterWatch",value:function(){"show"===this.data.display&&this.resetPosition()}},{key:"showBox",value:function(){var t=this.options.cssName,e=this.options.$screenContainer;e.querySelector("."+t.alertBox)||e.prepend(this.element),this.data.display="show",this.show()}},{key:"hideBox",value:function(){var t=this.options.cssName;this.options.$screenContainer.querySelector("."+t.alertBox)&&(this.data.display="hide",this.hide())}},{key:"show",value:function(){this.element.style.opacity=1,this.element.style.display="inline-block",this.resetPosition()}},{key:"hide",value:function(){this.element.style.opacity=0,this.element.style.display="none"}}]),n}(qe);function zn(){var t=Qe()(['\n  <gp-time class="goldplay__control--timer">\n  <span gid="time" class="goldplay__control--timer-play">','</span>\n  <span gid="slash">','</span>\n  <span gid="total-time" class="goldplay__control--timer-total">',"</span>\n  </gp-time>\n  "]);return zn=function(){return t},t}function Xn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p()(t);if(e){var i=p()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}var Gn=function(t){c()(n,t);var e=Xn(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i()(this,n),t=e.call(this,r),v()(u()(t),"template",t.createTemplate(zn(),"time","slash","totalTime")),v()(u()(t),"data",{time:"00:00",totalTime:"",slash:"/"}),v()(u()(t),"options",{}),t.options=r,Object.assign(t.data,r.data),t.init(),t}return o()(n,[{key:"setTotalTime",value:function(t){var e=t.sourceData;this.data.totalTime=Ze.formatHHMMSS(e.duration)}},{key:"bindEvent",value:function(){var t=this;this.events.on(st.LoaderPlayListLoaded,(function(e){t.setTotalTime(e.loadData)}))}},{key:"updateTime",value:function(t){this.element.querySelector('[gid="time"]').innerHTML=t}},{key:"updateTotalTime",value:function(t){this.element.querySelector('[gid="total-time"]').innerHTML=t}}]),n}(qe);function Yn(){var t=Qe()(['\n  <gp-speed class="goldplay__speed-bar" title="','">\n  <gp-overbox class="goldplay-hoverbox goldplay__speed-bar--box">\n  ','\n  </gp-overbox>\n  <gp-button class="goldplay__speed-bar--link">\n  ',"\n  </gp-button>\n  </gp-speed>\n  "]);return Yn=function(){return t},t}function $n(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p()(t);if(e){var i=p()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}function qn(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return Kn(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Kn(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function Kn(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var Qn=function(t){c()(n,t);var e=$n(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i()(this,n),t=e.call(this,r),v()(u()(t),"template",t.createTemplate(Yn(),"title","speedListHTML|html","currentSpeedName")),v()(u()(t),"data",{title:"speed",currentSpeed:1,speedList:null,currentSpeedName:"倍速",speedListHTML:""}),v()(u()(t),"options",{}),t.options=r,t.speedList=t.options.player.options.speedList||N.c.speedList,t.updateSpeedListHTML(),Object.assign(t.data,r.data),t.init(),t.initProps(),t.showHideBar(),t}return o()(n,[{key:"initProps",value:function(){var t=this.options.cssName;this.$barBox=this.element.querySelector("."+t.speedBarBox)}},{key:"bindEvent",value:function(){var t=this,e=this.options.cssName,n=this.options.$controlBarContainer;pn(n).on("mouseover","."+e.speedBar,(function(){clearTimeout(r),t.showBarBoxHandle()}));var r;pn(n).on("mouseout","."+e.speedBar,(function(e){r=setTimeout((function(){!function(e){var n=t.element,r={y:t.$barBox.offsetTop,x:n.offsetLeft};return r.width=n.offsetWidth,r.height=t.$barBox.offsetHeight,e.pageX>r.x&&e.pageX<r.x+r.width&&e.pageY>r.y&&e.pageY<r.y+r.height}(e)?t.hideBarBoxHandle():clearTimeout(r)}),N.c.hideBarBoxTime)})),pn(this.element).on("click","[gp-node-li]",(function(e){var n=e.target,r=parseFloat(n.getAttribute("value"),10);if(r!==t.data.currentSpeed){t.data.currentSpeed=r;var i=t.speedList.filter((function(t){return t.value===r}));t.events.emit(st.PlayerSpeedTo,i[0]),t.updateSpeedListHTML()}}))}},{key:"showHideBar",value:function(){this.speedList.length<=0&&this.hide()}},{key:"resetBoxPosition",value:function(){var t=33+28*this.speedList.length,e=(this.$barBox.offsetWidth-this.element.offsetWidth)/2;this.$barBox.style.marginTop=-t+"px",this.$barBox.style.marginLeft=-e+"px"}},{key:"hideBarBoxHandle",value:function(){this.$barBox.style.visibility="hidden"}},{key:"showBarBoxHandle",value:function(){this.$barBox.style.visibility="visible"}},{key:"updateSpeedListHTML",value:function(t){var e=this.speedList;if(!(e.length<=0)){void 0===t&&(t=this.data.currentSpeed);var n,r=e.slice(0,e.length).reverse(),i=qn(r);try{for(i.s();!(n=i.n()).done;){var a=n.value;a.value===t?a.selected=!0:delete a.selected}}catch(t){i.e(t)}finally{i.f()}return this.data.speedListHTML=function(t){if(t){var e,n=["<ul>"],r=qn(t);try{for(r.s();!(e=r.n()).done;){var i=e.value,a="",o="";i.selected&&(a="gp-selected",o=" selected=".concat(i.selected)),n.push('\n    <li class="'.concat(a,'" gp-node-li value="').concat(i.value,'" ').concat(o,">").concat(i.name,"</li>\n    "))}}catch(t){r.e(t)}finally{r.f()}return n.push("</ul>"),n.join("")}}(r)}}}]),n}(qe);function Zn(){var t=Qe()(['\n  <gp-subtitle class="goldplay__subtitle">\n  </gp-subtitle>\n  ']);return Zn=function(){return t},t}function Jn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p()(t);if(e){var i=p()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}var tr=function(t){c()(n,t);var e=Jn(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i()(this,n),t=e.call(this,r),v()(u()(t),"template",t.createTemplate(Zn())),v()(u()(t),"options",{}),t.options=r,Object.assign(t.data,r.data),t.init(),t}return n}(qe);function er(){var t=Qe()(['\n  <gp-rate class="goldplay__rate-bar" title="','">\n  <gp-overbox class="goldplay-hoverbox goldplay__rate-bar--box">\n  ','\n  </gp-overbox>\n  <gp-button class="goldplay__rate-bar--link">\n  ',"\n  </gp-button>\n  </gp-rate>\n  "]);return er=function(){return t},t}function nr(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p()(t);if(e){var i=p()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}function rr(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return ir(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ir(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function ir(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var ar=function(t){c()(n,t);var e=nr(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i()(this,n),t=e.call(this,r),v()(u()(t),"rateList",[]),v()(u()(t),"defaultRate",{value:"600",name:"高清"}),v()(u()(t),"template",t.createTemplate(er(),"title","rateListHTML|html","currentRateName")),v()(u()(t),"data",{title:"stream rate",currentRate:"600",currentRateName:"高清",rateListHTML:""}),v()(u()(t),"options",{}),t.options=r,Object.assign(t.data,r.data),t.rateList=t.options.player.options.rateList||t.rateList,t.defaultRate=t.options.player.options.defaultRate||t.defaultRate,t.setDefaultRate(),t.updateRateListHTML(),t.init(),t.initProps(),t.showHideBar(),t}return o()(n,[{key:"initProps",value:function(){var t=this.options.cssName;this.$barBox=this.element.querySelector("."+t.rateBarBox)}},{key:"setDefaultRate",value:function(){var t=this;if(!(this.rateList.length<=0)){var e=this.rateList.find((function(e){return String(e.value)===String(t.defaultRate.value)}));e?(this.data.currentRateName=e.name,this.data.currentRate=e.value):(this.data.currentRateName=this.rateList[0].name,this.data.currentRate=this.rateList[0].value)}}},{key:"bindEvent",value:function(){var t=this,e=this.options.cssName,n=this.options.$controlBarContainer;pn(n).on("mouseover","."+e.rateBar,(function(){clearTimeout(r),t.showBarBoxHandle()}));var r;pn(n).on("mouseout","."+e.rateBar,(function(e){r=setTimeout((function(){!function(e){var n=t.element,r={y:t.$barBox.offsetTop,x:n.offsetLeft};return r.width=n.offsetWidth,r.height=t.$barBox.offsetHeight,e.pageX>r.x&&e.pageX<r.x+r.width&&e.pageY>r.y&&e.pageY<r.y+r.height}(e)?t.hideBarBoxHandle():clearTimeout(r)}),N.c.hideBarBoxTime)})),pn(this.element).on("click","[gp-node-li]",(function(e){var n=e.target.getAttribute("value");if(n!==t.data.currentRate){t.data.currentRate=n;var r=t.rateList.filter((function(t){return t.value===n}));t.events.emit(st.PlayerChangeRate,r[0]),t.data.currentRateName=r[0].name,t.updateRateListHTML(),t.hideBarBoxHandle()}}))}},{key:"showHideBar",value:function(){var t=this.rateList;t&&t.length<=0&&this.hide()}},{key:"resetBoxPosition",value:function(){var t=33+28*this.rateList.length,e=(this.$barBox.offsetWidth-this.element.offsetWidth)/2;this.$barBox.style.marginTop=-t+"px",this.$barBox.style.marginLeft=-e+"px"}},{key:"hideBarBoxHandle",value:function(){this.$barBox.style.visibility="hidden"}},{key:"showBarBoxHandle",value:function(){this.$barBox.style.visibility="visible"}},{key:"updateRateListHTML",value:function(t){var e=this.rateList;if(!(e.length<=0)){void 0===t&&(t=this.data.currentRate);var n,r=e.slice(0,e.length).reverse(),i=rr(r);try{for(i.s();!(n=i.n()).done;){var a=n.value;a.value===t?a.selected=!0:delete a.selected}}catch(t){i.e(t)}finally{i.f()}return this.data.rateListHTML=function(t){if(t){var e,n=["<ul>"],r=rr(t);try{for(r.s();!(e=r.n()).done;){var i=e.value,a="",o="";i.selected&&(a="gp-selected",o=" selected=".concat(i.selected)),n.push('\n    <li class="'.concat(a,'" gp-node-li value="').concat(i.value,'" ').concat(o,">").concat(i.name,"</li>\n    "))}}catch(t){r.e(t)}finally{r.f()}return n.push("</ul>"),n.join("")}}(r)}}}]),n}(qe);function or(){var t=Qe()(['\n  <gp-setting class="goldplay__setting-bar">\n  </gp-setting>\n  ']);return or=function(){return t},t}function sr(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p()(t);if(e){var i=p()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}var ur=function(t){c()(n,t);var e=sr(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i()(this,n),t=e.call(this,r),v()(u()(t),"template",t.createTemplate(or())),v()(u()(t),"options",{}),t.options=r,Object.assign(t.data,r.data),t.init(),t}return n}(qe);function lr(){var t=Qe()(['\n  <gp-button class="goldplay__control--fullpage" title="','" data-status="','">\n  ',"\n  </gp-button>\n  "]);return lr=function(){return t},t}function cr(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p()(t);if(e){var i=p()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}function hr(){var t=Qe()(['\n<svg xmlns="http://www.w3.org/2000/svg" style="display:','" width="20" height="20" viewBox="0 0 24 24">\n<path d="M3.5 6h17a.5.5 0 0 1 .5.5v11a.5.5 0 0 1-.5.5h-17a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5zM6 9v6h12V9H6z" fill="#f1f1f1"></path>\n</svg>\n']);return hr=function(){return t},t}function fr(){var t=Qe()(['\n<svg xmlns="http://www.w3.org/2000/svg" style="display:','" width="20" height="20" viewBox="0 0 24 24">\n  <path d="M2.5 4h19a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-19a.5.5 0 0 1-.5-.5v-15a.5.5 0 0 1 .5-.5zM5 7v10h14V7H5z" fill="#f1f1f1"></path>\n</svg>\n']);return fr=function(){return t},t}var dr=Oe.create(fr(),"fullpageHide"),pr=Oe.create(hr(),"fullpageExitHide"),yr=function(t){c()(n,t);var e=cr(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i()(this,n),t=e.call(this,r),v()(u()(t),"containerOriginStyle",""),v()(u()(t),"template",t.createTemplate(lr(),"title","status","icon|html")),v()(u()(t),"data",{fullpageHide:"",fullpageExitHide:"none",status:"",icon:dr,title:"fullpage"}),v()(u()(t),"options",{}),t.options=r,Object.assign(t.data,r.data),t.init(),t}return o()(n,[{key:"watch",value:function(){"fullpage"===this.data.status?(this.data.fullpageHide="none",this.data.fullpageExitHide="inline-block",this.data.title="exit fullspage",this.data.icon=pr):(this.data.fullpageHide="inline-block",this.data.fullpageExitHide="none",this.data.title="fullpage",this.data.icon=dr)}},{key:"initProps",value:function(){var t=this.options;this.$container=this.options.$container,this.$screenContainer=t.$screenContainer,this.$controlBarContainer=this.getComponent("controlBarContainer").element,this.originWidth=t.$container.offsetWidth,this.originHeight=t.$container.offsetHeight,this.containerOriginStyle=t.$container.getAttribute("style"),this.screenContainerOrginStyle=this.$screenContainer.getAttribute("style"),this.controlContainerOrginWidth=this.$controlBarContainer.style.width}},{key:"bindEvent",value:function(){var t=this,e=this.options.cssName,n=document,r=window;pn(this.$controlBarContainer).on("click","."+e.fullPage,(function(){var e=t.data.status;"fullscreen"===t.getComponent("fullScreen").data.status&&Q.exitFullscreen(),"fullpage"===e?t.exitFullPage():t.fullPage()})),this.eventsList.esckeyup=this.addEventListener(n,"keyup",(function(e){27===e.keyCode&&"fullpage"===t.data.status&&t.exitFullPage()})),this.eventsList.windowresize=this.addEventListener(r,"resize",(function(){if("fullpage"===t.data.status){var e=Q.getInnerWidthHeight();t.resizeTo(e.width,e.height),t.resetPosition()}}))}},{key:"fullPage",value:function(){this.data.status="fullpage";var t=this.options,e=this.options.cssName,n=Q.getInnerWidthHeight();this.saveOriginPosition(),t.$container.classList.add(e.containerFullPage),this.resizeTo(n.width,n.height),this.resetPosition(),scrollTo(0,0)}},{key:"saveOriginPosition",value:function(){var t=this.getComponent("progressBar");this.posterOriginStyle=this.getComponent("poster").element.getAttribute("style"),this.originScroll={scrollX:scrollX,scrollY:scrollY},this.progressBarOriginLeft=t.progressBarLeft,this.progressBarOriginWidth=t.progressBarWidth,this.progressBarPlayWidthRate=t.getProgressPlayLeftWidth().offsetWidth/this.progressBarOriginWidth,this.progressBarLoadWidthRate=t.getProgressLoadLeftWidth().offsetWidth/this.progressBarOriginWidth,this.progressBarLoadLeftRate=(t.getProgressLoadLeftWidth().offsetLeft-this.progressBarOriginLeft)/this.progressBarOriginWidth}},{key:"setProgressBarPosition",value:function(){var t=this.getComponent("progressBar"),e=t.progressBarWidth,n=t.progressBarLeft,r=e*this.progressBarPlayWidthRate,i=e*this.progressBarLoadWidthRate,a=e*this.progressBarLoadLeftRate;t.setProgressPosition(r),t.setProgressLoadLeftWidth(a+n,i),this.getComponent("progressBar").clearDragDotTop()}},{key:"resizeTo",value:function(t,e){var n=this.options,r=n.player,i=r.controlBarAutoHide?e:e-r.controlBarHeight;r.$screenContainer.style.width=t+"px",r.$screenContainer.style.height=i+"px",n.$container.style.width=t+"px",n.$container.style.height=e+"px"}},{key:"resetPosition",value:function(){var t=this.options;this.setProgressBarPosition(),t.player.resizeScreen(),this.getComponent("bigPlayButton").resetPosition(),this.getComponent("poster").resetPosition(),this.getComponent("waitingBar").resetPosition(),this.getComponent("controlBarContainer").resetPosition()}},{key:"exitFullPage",value:function(){this.data.status="exitfullpage";var t=this.options.cssName;this.saveOriginPosition(),this.$container.classList.remove(t.containerFullPage),this.resetScreen()}},{key:"resetScreen",value:function(){this.$container.setAttribute("style",this.containerOriginStyle),this.$screenContainer.setAttribute("style",this.screenContainerOrginStyle),this.$controlBarContainer.style.width=this.controlContainerOrginWidth,this.getComponent("poster").element.setAttribute("style",this.posterOriginStyle),scrollTo(this.originScroll.scrollX,this.originScroll.scrollY),this.resetPosition()}}]),n}(qe);function vr(){var t=Qe()(['\n  <gp-button class="goldplay__control--fullscreen" title="','" data-status="','">\n  ',"\n  </gp-button>\n  "]);return vr=function(){return t},t}function gr(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p()(t);if(e){var i=p()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}var mr='\n<svg xmlns="http://www.w3.org/2000/svg" gid="fullscreen" style="display:${\'fullscreenHide\'}" width="20" height="20" viewBox="0 0 24 24">\n<path d="M15 5.057V2h6.5a.5.5 0 0 1 .5.5V9h-2.943V5.057H15zm-6 0H5.057V9H2V2.5a.5.5 0 0 1 .5-.5H9v3.057zM15 22v-2.943h4.057V15H22v6.5a.5.5 0 0 1-.5.5H15zm-6 0H2.5a.5.5 0 0 1-.5-.5V15h3.057v4.057H9V22z" fill="#f1f1f1"></path>\n</svg>\n',br=function(t){c()(n,t);var e=gr(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i()(this,n),t=e.call(this,r),v()(u()(t),"template",t.createTemplate(vr(),"title","status","icon|html")),v()(u()(t),"data",{fullscreenHide:"inline-block",fullscreenExitHide:"none",status:"",icon:mr,title:"fullscreen"}),v()(u()(t),"options",{}),t.options=r,Object.assign(t.data,r.data),t.init(),t}return o()(n,[{key:"watch",value:function(){"fullscreen"===this.data.status?(this.data.fullscreenHide="none",this.data.fullscreenExitHide="inline-block",this.data.title="exit fullscreen",this.data.icon='\n<svg xmlns="http://www.w3.org/2000/svg" gid="fullscreenExit" style="display:${\'fullscreenExitHide\'}"  width="20" height="20" viewBox="0 0 24 24">\n<path d="M22 5.943V9h-6.5a.5.5 0 0 1-.5-.5V2h2.943v3.943H22zm-20 0h3.943V2H9v6.5a.5.5 0 0 1-.5.5H2V5.943zM22 15v2.943h-4.057V22H15v-6.5a.5.5 0 0 1 .5-.5H22zM2 15h6.5a.5.5 0 0 1 .5.5V22H5.943v-4.057H2V15z" fill="#f1f1f1"></path>\n</svg>\n'):(this.data.fullscreenHide="inline-block",this.data.fullscreenExitHide="none",this.data.title="fullscreen",this.data.icon=mr)}},{key:"initProps",value:function(){this.getComponent("fullPage").initProps.call(this)}},{key:"bindEvent",value:function(){var t=this,e=this.options.$container,n=this.options.cssName,r=document,i=window;this.eventsList.fullscreenchange=this.addEventListener(r,"fullscreenchange",(function(){if(document.fullscreenElement||document.webkitFullscreenElement)t.fullScreen();else{var r=t.getComponent("fullPage");"fullpage"===r.data.status?(e.classList.remove(n.containerFullScreen),t.data.status="exitfullscreen",r.fullPage()):t.exitFullScreen()}})),this.eventsList.windowresize=this.addEventListener(i,"resize",(function(){document.fullscreenElement&&(t.resizeTo(screen.width,screen.height-(window.outerHeight-window.innerHeight)),t.resetPosition())})),pn(this.$controlBarContainer).on("click","."+n.fullScreen,(function(){var e=t.data.status;t.saveOriginPosition(),"fullscreen"===e?Q.exitFullscreen():Q.Fullscreen()}))}},{key:"fullScreen",value:function(){this.data.status="fullscreen";var t=this.options,e=this.options.cssName,n={width:screen.width,height:screen.height-(outerHeight-innerHeight)};Q.isSafari()&&(n.height=n.height+38),t.$container.classList.add(e.containerFullScreen),this.resizeTo(n.width,n.height),this.resetPosition(),scrollTo(0,0)}},{key:"saveOriginPosition",value:function(){this.getComponent("fullPage").saveOriginPosition.call(this)}},{key:"resizeTo",value:function(t,e){this.getComponent("fullPage").resizeTo.call(this,t,e)}},{key:"resetPosition",value:function(){this.getComponent("fullPage").resetPosition.call(this)}},{key:"setProgressBarPosition",value:function(){this.getComponent("fullPage").setProgressBarPosition.call(this)}},{key:"exitFullScreen",value:function(){this.data.status="exitfullscreen";var t=this.options.cssName;this.saveOriginPosition(),this.options.$container.classList.remove(t.containerFullScreen),this.resetScreen(),this.saveOriginPosition()}},{key:"resetScreen",value:function(){this.getComponent("fullPage").resetScreen.call(this)}}]),n}(qe);function kr(){var t=Qe()(['\n  <gp-button class="goldplay__screen--bigplay" title="','" data-status="','">\n  ',"\n  </gp-button>\n  "]);return kr=function(){return t},t}function Pr(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p()(t);if(e){var i=p()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}function wr(){var t=Qe()(['<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\nwidth="','" height="','" viewBox="0 0 438.533 438.533" style="','" xml:space="preserve">\n<g>\n<path d="M409.133,109.203c-19.608-33.592-46.205-60.189-79.798-79.796C295.736,9.801,259.058,0,219.273,0\n c-39.781,0-76.466,9.801-110.063,29.407c-33.595,19.604-60.192,46.201-79.8,79.796C9.801,142.8,0,179.489,0,219.267\n s9.804,76.463,29.407,110.062c19.607,33.585,46.204,60.189,79.799,79.798c33.597,19.605,70.283,29.407,110.063,29.407\n s76.47-9.802,110.065-29.407c33.593-19.602,60.189-46.206,79.795-79.798c19.603-33.599,29.403-70.287,29.403-110.062\n C438.533,179.489,428.732,142.795,409.133,109.203z M328.904,234.966L173.588,326.33c-2.856,1.711-5.902,2.567-9.136,2.567\n c-3.045,0-6.09-0.764-9.135-2.286c-6.09-3.614-9.136-8.939-9.136-15.985V127.907c0-7.041,3.046-12.371,9.136-15.987\n c6.28-3.427,12.369-3.333,18.271,0.284l155.316,91.36c6.088,3.424,9.134,8.663,9.134,15.703\n C338.038,226.308,334.992,231.537,328.904,234.966z" fill="','">\n</g>\n</svg>\n']);return wr=function(){return t},t}var xr=Oe.create(wr(),"width","height","iconStyle","fillColor"),_r=function(t){c()(n,t);var e=Pr(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i()(this,n),t=e.call(this,r),v()(u()(t),"template",t.createTemplate(kr(),"title","status","icon|html")),v()(u()(t),"data",{titie:"click to play",iconStyle:"opacity:0.5",display:"hide",status:"",width:100,height:100,fillColor:"#999",icon:xr}),v()(u()(t),"options",{}),t.options=r,Object.assign(t.data,r.data),t.init(),t}return o()(n,[{key:"watch",value:function(){if("show"===this.data.display){var t=(this.element.parentNode.offsetHeight-this.data.height)/2;this.data.iconStyle="opacity:0.7;margin-top:".concat(t,"px")}}},{key:"resetPosition",value:function(){if("show"===this.data.display){var t=this.element.parentNode,e=t.offsetWidth,n=t.offsetHeight;!0===this.options.player.controlBarAutoHide&&(n-=this.options.player.controlBarHeight);var r=t.offsetTop,i=t.offsetLeft;this.element.style.width=e+"px",this.element.style.height=n+"px",this.element.style.top=r+"px",this.element.style.left=i+"px"}}},{key:"bindEvent",value:function(){var t=this,e=this.options.$screenContainer,n=this.options.cssName;pn(e).on("click","."+n.bigPlayButton,(function(){t.events.emit(st.PlayerOnPlay,t),t.events.emit(st.ControlBarPlay,t),t.hide()})),pn(e).on("mouseover","."+n.bigPlayButton,(function(){t.data.fillColor=t.options.bigPlayButtonColor||"#fff"})),pn(e).on("mouseout","."+n.bigPlayButton,(function(e){var n=t.element,r={y:n.offsetTop,x:n.offsetLeft};r.width=n.offsetWidth,r.height=n.offsetHeight,e.pageX>r.x&&e.pageX<r.x+r.width&&e.pageY>r.y&&e.pageY<r.y+r.height||(t.data.fillColor="#999")}))}},{key:"show",value:function(){var t=this;"show"!==this.data.display&&(this.data.display="show",this.element.style.opacity="1",setTimeout((function(){t.element.style.display="inline-block"}),1))}},{key:"hide",value:function(){"hide"!==this.data.display&&(this.element.style.opacity="0",this.data.display="hide",this.element.style.display="none")}}]),n}(qe);function Br(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p()(t);if(e){var i=p()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}var Tr=function(t){c()(n,t);var e=Br(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i()(this,n),(t=e.call(this,r)).options=Object.assign(t.options,r),t.componentsController=t.options.componentsController,t.init(),t}return o()(n,[{key:"render",value:function(){var t=this,e=L.createEl("gp-button-block");e.classList.add("goldplay__control--button-block"),n.componentList.forEach((function(n){var r=t.componentsController.getComponent(n);e.appendChild(r.element)})),this.element=e}}],[{key:"addCustomControl",value:function(t){n.componentList.push(t)}}]),n}(qe);v()(Tr,"componentList",["playButton","pauseButton","replayButton"]);var Er=Tr;function Sr(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p()(t);if(e){var i=p()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}var Rr=function(t){c()(n,t);var e=Sr(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i()(this,n),(t=e.call(this,r)).options=Object.assign(t.options,r),t.componentsController=t.options.componentsController,t.init(),t}return o()(n,[{key:"render",value:function(){var t=this,e=L.createEl("gp-control-sidebar");e.classList.add("goldplay__control--sidebar"),n.componentList.forEach((function(n){var r=t.componentsController.getComponent(n);e.appendChild(r.element)})),this.element=e}}],[{key:"addCustomControl",value:function(t,e){(e<0||e>n.componentList.length)&&(e=n.componentList.length),n.componentList.splice(e,0,t)}}]),n}(qe);v()(Rr,"componentList",["speedBar","rateBar","volumeBar","fullPage","fullScreen"]);var Lr=Rr;function Dr(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p()(t);if(e){var i=p()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}var Cr=function(t){c()(n,t);var e=Dr(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i()(this,n),(t=e.call(this,r)).options=Object.assign(t.options,r),t.componentsController=t.options.componentsController,t.init(),t}return o()(n,[{key:"render",value:function(){var t=this,e=L.createEl("gp-control-nearside");e.classList.add("goldplay__control--button-block"),n.componentList.forEach((function(n){var r=t.componentsController.getComponent(n);e.appendChild(r.element)})),this.element=e}}],[{key:"addCustomControl",value:function(t,e){(e<0||e>n.componentList.length)&&(e=n.componentList.length),n.componentList.splice(e,0,t)}}]),n}(qe);v()(Cr,"componentList",["playControl","timer"]);var Ar=Cr,Or={BaseComponent:qe,controlBarContainer:sn,bigPlayButton:_r,poster:rn,progressBar:bn,playButton:wn,pauseButton:En,replayButton:Ln,volumeBar:Un,waitingBar:Fn,alertBox:Vn,timer:Gn,speedBar:Qn,subtitle:tr,rateBar:ar,settingBar:ur,fullPage:yr,fullScreen:br,playControl:Er,sideControlBar:Lr,nearControlBar:Ar};function Mr(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p()(t);if(e){var i=p()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}var Ir=Ee,Ur=function(t){return t.substr(0,1).toUpperCase()+t.substr(1)},Nr=function(t){c()(n,t);var e=Mr(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i()(this,n),t=e.call(this,r),v()(u()(t),"allComponents",{}),v()(u()(t),"controlBarController",null),v()(u()(t),"options",{cssName:Ir}),t.options=Object.assign(t.options,r),t.options.componentsController=u()(t),t.initComponents(),t.$container=t.options.$container,t.$screenContainer=t.options.$screenContainer,t.$canvas=t.options.$canvas,t.$audioContainer=t.options.$audioContainer,t.$audio=t.options.$audio,t.options.$controlBarContainer=t.controlBarContainer.element,t.bindEvent(),t}return o()(n,[{key:"run",value:function(){for(var t in this.controlBarController.run(),Or)this[t]&&"function"==typeof this[t].registerMethod&&this[t].registerMethod()}},{key:"initComponents",value:function(){for(var t in Or){var e=Or[t];this.allComponents[t]||this.createComponent(e,t)}}},{key:"bindEvent",value:function(){var t=this;this.events.on(st.PlayerLoadedMetaData,(function(){t.poster.hide()})),this.events.on(st.AudioPlayerPlayFail,(function(){t.drawBigPlayButton(),t.getComponent("poster").hide(),t.events.emit(st.PlayerOnPause,t),t.events.emit(st.ControlBarPause,t)})),this.bindAlertBoxEvent(),this.bindWaitingBarEvent()}},{key:"bindWaitingBarEvent",value:function(){this.waitingBar.initProps(),this.waitingBar.bindEvent()}},{key:"drawBigPlayButton",value:function(){this.$screenContainer.prepend(this.bigPlayButton.element),this.bigPlayButton.show(),this.bigPlayButton.bindEvent(),this.bigPlayButton.resetPosition()}},{key:"setControlBarController",value:function(t){this.controlBarController=t}},{key:"getControlBarController",value:function(){return this.controlBarController||this.options.player.controlBarContainer}},{key:"bindAlertBoxEvent",value:function(){this.alertBox.initProps(),this.alertBox.bindEvent()}},{key:"drawPoster",value:function(){this.$screenContainer.prepend(this.poster.element),this.poster.data.display="show",this.poster.bindEvent(),this.poster.resetPosition()}},{key:"createComponent",value:function(t,e){var n=Ur(e);this["set"+n](new t(this.options)),this[e]=this["get"+n](),this.allComponents[e]||(this.allComponents[e]=this[e])}},{key:"getComponent",value:function(t){return this.allComponents[t]||Or[t]&&this.createComponent(Or[t],t),this.allComponents[t]}},{key:"resetAllComponents",value:function(){var t=this,e=Object.getOwnPropertyNames(this),n={};e.forEach((function(e){Or[e]&&(n[e]=t[e])})),this.allComponents=n}},{key:"getAllComponents",value:function(){return this.allComponents}}]),n}(A);for(var Hr in Nr.addComponet=function(t){var e=Ur(t);Nr.prototype["set"+e]=function(e){this[t]=e},Nr.prototype["get"+e]=function(){return this[t]}},Or)Nr.addComponet(Hr);var Fr=Nr;function jr(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p()(t);if(e){var i=p()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}var Wr=Ee,Vr=function(t){c()(n,t);var e=jr(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i()(this,n),t=e.call(this,r),v()(u()(t),"player",null),v()(u()(t),"loadData",null),v()(u()(t),"options",{cssName:Wr}),t.options=Object.assign(t.options,r),t.player=t.options.player,t.loadData=t.player.loadData,t.componentsController=t.player.componentsController,t.$screenContainer=t.player.$screenContainer,t.initComponents(),t}return o()(n,[{key:"initComponents",value:function(){var t=this.componentsController;Object.assign(this,t.getAllComponents()),this.container=this.controlBarContainer}},{key:"run",value:function(){this.timer.setTotalTime(this.loadData),this.drawLayout(),this.bindEvent(),this.player.autoPlay?this.events.emit(st.ControlBarPlay):this.events.emit(st.ControlBarPause)}},{key:"bindEvent",value:function(){this.bindContainerEvent(),this.bindTimerEvent(),this.bindPlayEvent(),this.bindProgressEvent(),this.bindSpeedEvent(),this.bindRateEvent(),this.bindVolumeEvent(),this.bindFullPage(),this.bindFullScreen()}},{key:"bindContainerEvent",value:function(){this.container.initProps(),this.container.bindEvent()}},{key:"bindTimerEvent",value:function(){this.timer.initProps(),this.timer.bindEvent()}},{key:"bindSpeedEvent",value:function(){this.speedBar.bindEvent(),this.speedBar.resetBoxPosition()}},{key:"bindRateEvent",value:function(){this.rateBar.bindEvent(),this.rateBar.resetBoxPosition()}},{key:"bindFullPage",value:function(){this.fullPage.initProps(),this.fullPage.bindEvent()}},{key:"bindFullScreen",value:function(){this.fullScreen.initProps(),this.fullScreen.bindEvent()}},{key:"bindPlayEvent",value:function(){var t=this;this.events.on(st.ControlBarPlay,(function(){"pause"!==t.pauseButton.data.status&&(t.pauseButton.data.status="pause"),t.replayButton.hide(),t.playButton.hide(),t.pauseButton.show(),t.bigPlayButton.hide()})),this.events.on(st.ControlBarPause,(function(){"pause"!==t.player.status&&(t.pauseButton.data.status="pause"),t.playButton.show(),t.pauseButton.hide()})),this.events.on(st.PlayerEnd,(function(){t.replayButton.show(),t.pauseButton.hide(),t.playButton.hide()})),[st.PlayerWait,st.PlayerSeeking,st.PlayerReset,st.PlayerChangeRate,st.PlayerChangeSrc].forEach((function(e){t.events.on(e,(function(){t.waitingBar.showWaiting()}))})),this.events.on(st.PlayerSeekEnd,(function(){t.waitingBar.hideWaiting()})),this.events.on(st.PlayerPlay,(function(){t.waitingBar.hideWaiting(),t.events.emit(st.ControlBarPlay,t)})),this.events.on(st.PlayerPause,(function(){t.events.emit(st.ControlBarPause,t)})),this.events.on(st.PlayerPlaying,(function(){t.waitingBar.hideWaiting()})),this.events.on(st.PlayerOnSeek,(function(e){e<1e3*t.loadData.sourceData.duration&&t.events.emit(st.ControlBarPauseLoading)})),this.events.on(st.ControlBarPauseLoading,(function(){"pauseloading"!==t.pauseButton.data.status&&(t.pauseButton.data.status="pauseloading"),t.replayButton.hide(),t.playButton.hide(),t.pauseButton.show()})),pn(this.options.$container).on("click","."+Wr.playButton,(function(){"play"!==t.player.status&&t.events.emit(st.PlayerOnPlay,t)})),pn(this.options.$container).on("click","."+Wr.pauseButton,(function(){"pause"!==t.player.status&&t.events.emit(st.PlayerOnPause,t)})),pn(this.options.$container).on("click","."+Wr.replayButton,(function(){t.events.emit(st.PlayerOnSeek,t.player.startTime)}))}},{key:"bindProgressEvent",value:function(){this.progressBar.initProps(),this.progressBar.bindEvent()}},{key:"bindVolumeEvent",value:function(){this.volumeBar.initProps(),this.volumeBar.initVolumeSize(),this.volumeBar.bindEvent()}},{key:"drawLayout",value:function(){var t=this.options.$container,e=this.container.element;t.append(e)}},{key:"destroy",value:function(){this.removeEventListenerGlobal(),this.container.destroy()}},{key:"removeEventListenerGlobal",value:function(){this.progressBar.progressDragEvent&&this.progressBar.progressDragEvent.removeEventListenerAll(),this.volumeBar.volumeDragEvent&&this.volumeBar.volumeDragEvent.removeEventListenerAll(),this.fullPage.removeEventListenerAll(),this.fullScreen.removeEventListenerAll()}}]),n}(A),zr=n(44),Xr=n.n(zr);function Gr(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p()(t);if(e){var i=p()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}var Yr=function(t){c()(n,t);var e=Gr(n);function n(t){var r;return i()(this,n),r=e.call(this,t),v()(u()(r),"isLast",!1),r.type=t.type,r.libPath=t.libPath,r.player=t.player,r.init(),r}return o()(n,[{key:"init",value:function(){"ts"==this.type&&this.initNornalWorker(),this.bindEvent(),this.loadjs()}},{key:"initNornalWorker",value:function(){this.processor=this.initWorker()}},{key:"initWorker",value:function(){var t=this,e=Xr()(128);return e.onmessage=function(e){var n=e.data,r=n.type,i=n.data;switch(r){case"dataProcessorReady":t.onDataProcessorReady();break;case"decoded":t.onDecoded(i);break;case"demuxedAAC":t.onDemuxedAAC(i);break;case"partEnd":t.onPartEnd(i);break;case"resetEnd":t.onResetEnd();break;case"maxPTS":t.onMaxPTS(i);break;case"flushEnd":t.onFlushEnd(i)}},e}},{key:"bindEvent",value:function(){var t=this;this.events.on(st.DemuxStartDemux,this.onStartDemux.bind(this)),this.events.on(st.DemuxLast,(function(){t.isLast=!0})),this.events.on(st.DecodeFlush,(function(){t.flush()}))}},{key:"flush",value:function(){this.processor.postMessage({type:"flush"})}},{key:"loadjs",value:function(){this.processor.postMessage({type:"loadwasm",libPath:this.libPath})}},{key:"reset",value:function(){this.isLast=!1,this.processor.terminate(),this.initNornalWorker(),this.loadjs()}},{key:"onFlushEnd",value:function(t){this.events.emit(st.DecodeFlushEnd,t)}},{key:"onMaxPTS",value:function(t){this.events.emit(st.PlayerMaxPTS,t.maxAudioPTS,t.maxVideoPTS)}},{key:"onDemuxedAAC",value:function(t){this.events.emit(st.DemuxAAC,t)}},{key:"onDataProcessorReady",value:function(){this.player.seeking||this.player.reseting?this.events.emit(st.ProcessorResetEnd):this.events.emit(st.DataProcessorReady)}},{key:"onStartDemux",value:function(t){this.player.reseting||(this.logger.info("onStartDemux","postMessage to demux"),t&&t.arrayBuffer?this.processor.postMessage({type:"startDemux",data:t.arrayBuffer,isLast:this.isLast},[t.arrayBuffer.buffer]):this.logger.error("onStartDemux","data is null","data:",t))}},{key:"onDecoded",value:function(t){this.player.reseting||this.events.emit(st.DecodeDecoded,t)}},{key:"onPartEnd",value:function(t){this.events.emit(st.DecodeApppendEnd,t)}},{key:"onResetEnd",value:function(){this.events.emit(st.ProcessorResetEnd)}},{key:"destroy",value:function(){this.processor&&this.processor.terminate()}}]),n}(U);function $r(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p()(t);if(e){var i=p()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}var qr=function(t){c()(n,t);var e=$r(n);function n(t){var r;return i()(this,n),r=e.call(this,t),v()(u()(r),"currentIndex",null),v()(u()(r),"retryTime",0),v()(u()(r),"dataReady",{audioReady:!1,imageReady:!1}),v()(u()(r),"hasInit",!1),v()(u()(r),"loadDataStatus","loading"),v()(u()(r),"duration",0),v()(u()(r),"tsNumber",0),r.loadData=t.loadData,r.imagePlayer=t.imagePlayer,r.audioPlayer=t.audioPlayer,r.player=t.player,r.bindEvent(),r}return o()(n,[{key:"bindEvent",value:function(){var t=this;this.events.on(st.LoadDataRead,(function(e){t.onRead(e)})),this.events.on(st.DemuxVideo,(function(e,n){t.onVideoDemuxed(e,n)})),this.events.on(st.DemuxAAC,(function(e){t.onAACDemuxed(e)})),this.events.on(st.DecodeDecoded,(function(e){t.onDecoded(e)})),this.events.on(st.DecodeApppendEnd,(function(e){t.onAppendEnd(e)})),this.events.on(st.ImagePlayerReady,(function(){t.logger.info("bindevent","Events.ImagePlayerReady"),t.checkDataReady("imageReady")})),this.events.on(st.AudioPlayerDataReady,(function(){t.logger.info("bindevent","Events.AudioPlayerDataReady"),t.player.receiveAACTime=null,t.checkDataReady("audioReady")})),this.events.on(st.AudioPlayerWait,(function(){t.dataReady.audioReady=!1,t.events.emit(st.PlayerWait,"audioPlayer")})),this.events.on(st.ImagePlayerWait,(function(){t.dataReady.imageReady=!1,t.events.emit(st.PlayerWait,"imagePlayer")})),this.events.on(st.ImagePlayerEnd,(function(){t.logger.info("bindevent","........imageplayer end"),t.events.emit(st.PlayerEnd)})),this.events.on(st.PlayerWait,(function(){t.logger.warn("player status wait"),t.player.status="wait","loadend"===t.loadDataStatus&&(t.loadDataStatus="loading",t.loadNext())})),this.events.on(st.PlayerLoadNext,(function(){"loadend"===t.loadDataStatus&&(t.loadDataStatus="loading",t.loadNext())})),this.events.on(st.DecodeFlushEnd,(function(e){t.logger.info("flushend>>>>>>>>>>>>>>>",e),t.imagePlayer.maxPTS=e}))}},{key:"checkDataReady",value:function(t){var e=this.dataReady;e[t]=!0;for(var n=Object.keys(e),r=0,i=0;i<n.length&&e[n[i]];i++)r++;r==n.length&&this.events.emit(st.StreamDataReady)}},{key:"setBaseInfo",value:function(t){this.duration=t.duration,this.tsNumber=t.tsNumber}},{key:"reset",value:function(){this.dataReady={audioReady:!1,imageReady:!1},this.currentIndex=null,this.loadDataStatus="loading"}},{key:"startLoad",value:function(t){this.logger.info("startLoad","index:",t),this.currentIndex=t,this.player.currentIndex=t,this.events.emit(st.LoadDataReadBufferByNo,t)}},{key:"loadNext",value:function(){this.player.reseting||(this.currentIndex>=this.tsNumber?this.logger.info("loadNext","load end","currentIndex",this.currentIndex,"tsNumber:",this.tsNumber):(this.currentIndex+=1,this.player.currentIndex=this.currentIndex,this.logger.info("loadNext","load next ts","tsno:",this.currentIndex),this.events.emit(st.LoadDataReadBufferByNo,this.currentIndex)))}},{key:"onDecoded",value:function(t){var e=this;t.forEach((function(t){e.player.reseting||t.pts>=e.player.currentTime&&e.imagePlayer.push(t)}))}},{key:"onAppendEnd",value:function(t){return t?(this.logger.info("onAppendEnd","events.decodeFlush",t),void this.events.emit(st.DecodeFlush)):(this.logger.info("onAppendEnd","start load next ts condition",this.checkBuffer(),this.currentIndex),this.checkBuffer()&&null!==this.currentIndex?(this.logger.info("onAppendEnd","load next ts. currentIndex:",this.currentIndex),void this.loadNext()):(this.loadDataStatus="loadend",void this.logger.info("onAppendEnd","load ts stop")))}},{key:"onAACDemuxed",value:function(t){var e=this;this.player.reseting||(t.length||this.audioPlayer.send({}),t.forEach((function(t){(t.PTS>=e.player.currentTime||t.audioEnd)&&(!e.player.receiveAACTime&&e.player.seeking&&(e.player.receiveAACTime=Date.now()),e.audioPlayer.send(t))})))}},{key:"onVideoDemuxed",value:function(t){this.player.reseting||this.events.emit(st.DecodeStartDecode,t)}},{key:"checkBuffer",value:function(){var t=this.player,e=t.currentTime;return!((t.buffer()[1]||0)-e>=t.maxBufferLength)}},{key:"onRead",value:function(t){this.player.reseting?console.error("onRead reseting"):t&&t.arrayBuffer&&t.no===this.currentIndex?(this.retryTime=0,this.logger.warn("onRead","get stream data"),t.no===this.tsNumber&&(this.logger.info("onRead","the last ts"),this.events.emit(st.DemuxLast)),this.events.emit(st.DemuxStartDemux,t)):this.logger.error("onRead","load ts failred","tsno:",this.currentIndex)}}]),n}(U);function Kr(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p()(t);if(e){var i=p()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}var Qr=function(t){c()(n,t);var e=Kr(n);function n(t){var r;return i()(this,n),r=e.call(this,t),v()(u()(r),"maxBufferLength",0),v()(u()(r),"duration",0),v()(u()(r),"pool",[]),v()(u()(r),"start",0),v()(u()(r),"end",0),v()(u()(r),"offset",0),v()(u()(r),"fps",25),r.maxBufferLength=t.maxBufferLength,r}return o()(n,[{key:"push",value:function(t){var e=this.pool,n=e.length;0===n&&(this.offset=t.pts,this.start=t.pts,this.fps=t.fps);var r=this.insertSort(e,t);e[r-1]&&(e[r-1].duration=e[r].pts-e[r-1].pts),e[r+1]&&(e[r].duration=e[r+1].pts-e[r].pts),this.end=this.pool[n].pts+this.pool[n].duration,this.duration=this.end-this.start}},{key:"insertSort",value:function(t,e){var n=t.length;if(0===n)return t.push(e),0;for(var r=0;r<n;r++)if(e.pts<t[r].pts){for(var i=n;i>r;)t[i]=t[i-1],i--;return t[r]=e,r}return t.push(e),t.length-1}},{key:"reset",value:function(){this.duration=0,this.pool=[],this.start=0,this.end=0,this.offset=0}},{key:"findByIndex",value:function(t){var e=this.buffer.length;return t<e?(this.currentIndex=t,this.buffer[t]):(this.logger.error("input index ".concat(t,"is not found, current maxIndex is ").concat(e-1)),null)}},{key:"find",value:function(t){var e=this.pool,n=e.length;if(this.isBuffered(t)&&0!==n){var r=this.findIndex(t);if(-1!==r){var i=e[r];return this.checkBuffer(t),i}}}},{key:"findIndex",value:function(t){return this.pool.findIndex((function(e){var n=parseInt(e.pts);return t>=n&&t<n+e.duration}))}},{key:"isBuffered",value:function(t){return t>=this.start&&t<this.end}},{key:"checkBuffer",value:function(t){if(this.duration>this.maxBufferLength){if(t>this.start){var e=this.findIndex(t),n=this.pool.splice(0,e);n.forEach((function(t){null})),n=null,this.start=this.pool[0].pts,this.duration=this.end-this.start}return!1}return this.events.emit(st.PlayerLoadNext),!0}},{key:"buffer",value:function(){return{start:this.start,end:this.end}}}]),n}(U),Zr=n(72),Jr=n.n(Zr),ti=n(60),ei=n.n(ti);function ni(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p()(t);if(e){var i=p()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}var ri=function(t){c()(n,t);var e=ni(n);function n(t){var r;return i()(this,n),r=e.call(this),v()(u()(r),"canvas",null),r.setCanvas(t.canvas),r.setRender(),r}return o()(n,[{key:"setCanvas",value:function(t){this.canvas=t}},{key:"setRender",value:function(t){this.render=Jr.a.attach(t||this.canvas)}},{key:"clear",value:function(){this.render.clear()}},{key:"drawFrame",value:function(t){var e,n,r,i,a,o=Date.now(),s=t.buf_y,u=t.buf_u,l=t.buf_v,c=t.width,h=t.height,f=c/2,d=h/2;e={bytes:s,stride:t.stride_y},n={bytes:u,stride:t.stride_u},r={bytes:l,stride:t.stride_v},i=ei.a.format({width:c,height:h,chromaWidth:f,chromaHeight:d}),a=ei.a.frame(i,e,n,r),this.render.drawFrame(a);var p=Date.now();p-o>10&&this.logger.warn("drawFrame","reandertime:",p-o)}}]),n}(U);function ii(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p()(t);if(e){var i=p()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}var ai=function(t){c()(n,t);var e=ii(n);function n(t){var r;return i()(this,n),r=e.call(this,t),v()(u()(r),"status","pause"),v()(u()(r),"_currentTime",0),v()(u()(r),"maxPTS",null),v()(u()(r),"ready",!1),v()(u()(r),"firstRender",!1),r.imageData=new Qr({events:t.events,maxBufferLength:t.maxBufferLength}),r.screen=new ri({canvas:t.canvas}),r.playHandler=null,r.player=t.player,r.debug=t.debug||!1,r}return o()(n,[{key:"setScreenRender",value:function(t){this.screen.setCanvas(t),this.screen.setRender(t)}},{key:"clear",value:function(){this.screen.clear()}},{key:"play",value:function(t){"play"!==this.status&&(this.status="play",this.render(t))}},{key:"pause",value:function(){"pause"!==this.status&&(this.status="pause",clearTimeout(this.playHandler),this.playHandler=null)}},{key:"checkBuffer",value:function(){return this.imageData.checkBuffer(this.currentTime)}},{key:"push",value:function(t){this.player.reseting||(this.imageData.push(t),this.end-this.player.currentTime>N.d.READYBUFFERLENGTH&&!this.ready&&(this.ready=!0,this.status="ready",this.events.emit(st.ImagePlayerReady)),this.events.emit(st.ImagePlayerBuffeUpdate))}},{key:"find",value:function(t){return this.imageData.find(t)}},{key:"buffer",value:function(){return this.imageData.buffer()}},{key:"isBuffered",value:function(t){return this.imageData.isBuffered(t)}},{key:"render",value:function(t){if(!(t<this.imageData.offset)){var e=this.find(t);return e?(this.firstRender||(this.firstRender=!0,this.events.emit(st.PlayerLoadedMetaData,e.width,e.height)),this.screen.drawFrame(e),this.currentTime=e.pts,this.events.emit(st.ImagePlayerRenderEnd,t,e.duration),e):this.maxPTS&&t>=this.maxPTS+this.fragDuration?(this.status="end",void this.events.emit(st.ImagePlayerEnd,this.maxPTS)):(this.logger.warn("Events.ImagePlayerWait",t,this.start,this.end,this.maxPTS),this.logger.warn("render","not yuv data"),this.status="wait",this.ready=!1,this.events.emit(st.ImagePlayerWait,"image","this"),!1)}}},{key:"reset",value:function(){this.status="pause",this.ready=!1,this.imageData.reset(),this.maxPTS=null,this.currentTime=0}},{key:"currentTime",set:function(t){this._currentTime=t},get:function(){return this._currentTime}},{key:"offset",get:function(){return this.imageData.offset}},{key:"fragDuration",get:function(){return Math.ceil(1e3/this.imageData.fps)}},{key:"start",get:function(){return this.imageData.start}},{key:"end",get:function(){return this.imageData.end}},{key:"duration",get:function(){return this.imageData.duration}}]),n}(U);function oi(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p()(t);if(e){var i=p()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}var si=new WeakMap,ui=new WeakMap,li=new WeakMap,ci=new WeakMap,hi=new WeakMap;function fi(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p()(t);if(e){var i=p()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}var di=function(t){c()(n,t);var e=fi(n);function n(t,r){var a;return i()(this,n),a=e.call(this,t,r),v()(u()(a),"libPath",null),a.options.processURL=r.processURL,a.libPath=r.libPath,!1!==a.options.needInit&&a.init(),a}return o()(n,null,[{key:"getComponent",value:function(t){return Or[t]}},{key:"registerComponent",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"right",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1;if("string"!=typeof t||!t)throw new Error('Illegal component name, "'.concat(t,'"; must be a non-empty string.'));var i=Object.prototype.isPrototypeOf.call(qe,e.prototype);if(!i)throw new Error('Illegal component, "'.concat(t,'"; must be a BaseComponent subclass.'));Or[t]=e,Fr.addComponet(t),"left"===n?Ar.addCustomControl(t,r):Lr.addCustomControl(t,r)}}]),n}(function(t){c()(n,t);var e=oi(n);function n(t){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return i()(this,n),r=e.call(this),v()(u()(r),"mode",N.c.mode),v()(u()(r),"$container",null),v()(u()(r),"componentsController",null),v()(u()(r),"controlBarController",null),v()(u()(r),"controlBarHeight",50),v()(u()(r),"alertError",null),v()(u()(r),"dataController",null),v()(u()(r),"demuxer",null),v()(u()(r),"decoder",null),v()(u()(r),"preload",!0),v()(u()(r),"startTime",0),v()(u()(r),"screenWidth",null),v()(u()(r),"screenHeight",null),v()(u()(r),"options",{}),si.set(u()(r),{writable:!0,value:N.c.libPath}),v()(u()(r),"readyStatus",{dataProcessor:!1,firstData:!1,audioPlayer:!1}),v()(u()(r),"reseting",!1),ui.set(u()(r),{writable:!0,value:0}),li.set(u()(r),{writable:!0,value:!1}),ci.set(u()(r),{writable:!0,value:1}),hi.set(u()(r),{writable:!0,value:!1}),v()(u()(r),"maxBufferLength",N.d.MAXBUFFERLENGTH),v()(u()(r),"seekSegmentNo",-1),v()(u()(r),"status","init"),v()(u()(r),"loader",null),v()(u()(r),"currentIndex",null),v()(u()(r),"startIndex",1),v()(u()(r),"loadData",null),v()(u()(r),"paused",!1),v()(u()(r),"autoPlay",!0),v()(u()(r),"duration",0),v()(u()(r),"tsNumber",0),t||r.logger.error("Please pass in a dom object as the display container"),r.el=t,Object.assign(r.options,a),r.options.sourceURL=r.options.sourceURL||r.options.source,r.options.streamList=r.options.streamList||[],r.options.events=T(),r.maxBufferLength=void 0!==a.maxBufferLength?a.maxBufferLength:r.maxBufferLength,r.autoPlay=void 0!==a.autoPlay?a.autoPlay:r.autoPlay,r.controlBarAutoHide=void 0!==a.controlBarAutoHide?a.controlBarAutoHide:r.controlBarAutoHide,k()(u()(r),si,void 0!==a.libPath?a.libPath:m()(u()(r),si)),r.preload=void 0===a.preload?r.preload:a.preload,r.startTime=void 0===a.startTime?r.startTime:a.startTime,r.originStartTime=r.startTime,r.playbackRate=void 0===a.playbackRate?r.playbackRate:a.playbackRate,r}return o()(n,[{key:"setAlertError",value:function(){this.options.alertError=this.alertError=M.getInstance({player:this,component:this.componentsController.alertBox,events:this.options.events})}},{key:"setDataController",value:function(){this.dataController=Pt.getInstance({player:this,events:this.options.events})}},{key:"setLoadData",value:function(){this.dataController.setLoadData({player:this,events:this.options.events}),this.loadData=this.dataController.loadData}},{key:"setComponentsController",value:function(){this.componentsController=Fr.getInstance({$container:this.$container,$screenContainer:this.$screenContainer,$canvas:this.$canvas,$audioContainer:this.$audioContainer,$audio:this.$audio,loadData:this.loadData,bigPlayButtonColor:this.bigPlayButtonColor,player:this,events:this.options.events})}},{key:"setControlBarController",value:function(){var t=Object.assign({},this.options,{$container:this.$container,$screenContainer:this.$screenContainer,controlBarAutoHide:this.controlBarAutoHide,player:this});this.controlBarController=Vr.getInstance(t)}},{key:"setLoadController",value:function(){this.loaderController=dt.getInstance(this.options.type,{player:this,events:this.options.events})}},{key:"setProcessorController",value:function(){this.processController=new Yr({type:"ts",libPath:m()(this,si),events:this.options.events,player:this})}},{key:"setStreamController",value:function(){this.streamController=new qr({events:this.options.events,loadData:this.loadData,imagePlayer:this.imagePlayer,audioPlayer:this.audioPlayer,player:this})}},{key:"setImagerPlayer",value:function(){this.imagePlayer=new ai({events:this.options.events,canvas:this.$canvas,maxBufferLength:this.maxBufferLength,player:this})}},{key:"setAudioPlayer",value:function(){this.audioPlayer=new Te({player:this,events:this.options.events,audioNode:this.$audio})}},{key:"setAction",value:function(){this.action=new Bt({player:this,screen:this.screen,imagePlayer:this.imagePlayer,loadData:this.loadData,audioPlayer:this.audioPlayer,events:this.options.events})}},{key:"init",value:function(){this.controlBarHeight=this.options.controlBarHeight||this.controlBarHeight,this.options.httpWorker=Xr()(94,{name:"httpWorker"}),this.currentTime=this.startTime,this.addEl(),this.setDataController(),this.setLoadData(),this.setComponentsController(),this.setLoadController(),this.setControlBarController(),this.componentsController.setControlBarController(this.controlBarController),this.setAlertError(),this.setProcessorController(),this.setImagerPlayer(),this.setAudioPlayer(),this.setAction(),this.setStreamController(),this.componentsController.drawPoster(),this.preload&&this.run(),this.bindEvent()}},{key:"bindEvent",value:function(){var t=this;this.events.on(st.PlayerOnPlay,(function(){t.play()})),this.events.on(st.PlayerOnPause,(function(){t.pause()})),this.events.on(st.PlayerOnVolume,(function(e){t.volume=e})),this.events.on(st.DataProcessorReady,(function(){t.logger.info("bindEvent","decoder ready"),t.checkReady("dataProcessor")})),this.events.on(st.AudioPlayerReady,(function(){t.logger.info("bindEvent","audioPlayer ready"),t.seeking||t.checkReady("audioPlayer")})),this.events.on(st.PlayerReady,(function(){t.logger.info("bindEvent","player ready"),t.onReady()})),this.events.on(st.PlayerSpeedTo,(function(e){t.changeSpeed(e)})),this.events.on(st.PlayerChangeRate,(function(e){t.changeRate(e)})),this.events.on(st.PlayerWait,(function(){t.onWait()})),this.events.on(st.PlayerPlay,(function(){t.onPlay()})),this.events.on(st.LoaderPlayListLoaded,(function(e){"function"==typeof t.options.afterLoadPlaylist&&t.options.afterLoadPlaylist(t.laodData.sourceData);var n=e.loadData.sourceData;t.duration=n.duration,t.tsNumber=n.length,t.streamController.setBaseInfo({duration:t.duration,tsNumber:t.tsNumber}),t.dataController.startLoad(t.startTime),t.setStartTime(t.originStartTime)})),this.events.on(st.LoadDataFirstLoaded,(function(e){t.logger.info("bindEvent","first data ready"),t.startIndex=e.no,t.streamController.currentIndex=e.no,t.checkReady("firstData")})),this.events.on(st.StreamDataReady,(function(){t.logger.info("bindEvent","dataReady"),t.onDataReady()})),this.events.on(st.PlayerLoadedMetaData,(function(e,n){t.setCanvas(),t.resizeScreen(e,n)})),this.events.on(st.PlayerEnd,(function(){t.status="end"})),this.events.on(st.ImagePlayerBuffeUpdate,(function(){var e=t.buffer();t.events.emit(st.PlayerbufferUpdate,e)})),this.events.on(st.PlayerOnSeek,(function(e){t.seek(Math.floor(e))})),this.events.on(st.PlayerAlert,(function(e){t.alertError.show(e)})),this.events.on(st.PlayerThrowError,(function(e){I.a.apply(t,e)}))}},{key:"reset",value:function(t){this.action&&this.action.reset(t)}},{key:"switchPlaylist",value:function(t,e){this.loaderController.switchPlaylist(t,e)}},{key:"changeSpeed",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.playbackRate=t.value||1}},{key:"setStartTime",value:function(t){this.startTime=t}},{key:"changeRate",value:function(t){this.pause(),this.events.emit(st.ControlBarPauseLoading,this),this.setStartTime((this.currentTime-5e3)/1e3),this.changing=!0,this.seeking=!1,this.imagePlayer.firstRender=!1,this.readyStatus={dataProcessor:!1,firstData:!1,audioPlayer:!1},this.reset(!0),this.switchPlaylist(t.url)}},{key:"changeSrc",value:function(t,e){this.pause(),this.events.emit(st.ControlBarPauseLoading,this),this.events.emit(st.PlayerChangeSrc,this),this.changing=!0,this.seeking=!1,this.imagePlayer.firstRender=!1,this.readyStatus={dataProcessor:!1,firstData:!1,audioPlayer:!1},this.currentTime=this.startTime,this.imagePlayer.clear(),this.reset(!0),this.switchPlaylist(t,e)}},{key:"setCanvas",value:function(){var t=Le.createCanvas(this);if(L.isElement(this.$canvas)){if(this.$canvas.width&&this.$canvas.height)return this.imagePlayer.setScreenRender(t),this.$canvas.replaceWith(t),void(this.$canvas=t)}else this.$screen.appendChild(t),this.$canvas=t}},{key:"destroy",value:function(){this.controlBarController&&(this.controlBarController.destroy(),delete this.controlBarController),this.$container&&(this.el.removeChild(this.$container),delete this.$container),this.processController.destroy(),this.loaderController.destroy()}},{key:"run",value:function(){this.loaderController.run()}},{key:"checkReady",value:function(t){var e=this.readyStatus;if(t&&"string"==typeof t){e[t]=!0;for(var n=Object.keys(e),r=0;r<n.length;r++)if(!e[n[r]])return!1;return this.logger.info("checkReady","player ready"),this.events.emit(st.PlayerReady),!0}return this.logger.error("checkReady","check ready","type is no correct, type:",t),!1}},{key:"addEl",value:function(){var t,e,n,r;this.el?(t=Le.createContainer(this),this.el.appendChild(t),this.$container=t,e=Le.createScreenContainer(this),this.$screen=e,t.appendChild(e),this.$screenContainer=e,this.setCanvas(),r=Le.createAudio(this),this.$audio=r,(n=Le.createAudioContainer(this)).appendChild(r),this.$audioContainer=n,t.appendChild(n)):this.logger.error("addEl","not found el.","el:",this.options.el)}},{key:"onWait",value:function(){this.logger.info("onWait","wait,wait,wait")}},{key:"onPlay",value:function(){this.logger.info("onPlay","play, play, play")}},{key:"onReady",value:function(){this.changing||this.componentsController.run(),this.changing&&this.logger.info("onReady","change ready","startIndex:",this.startIndex),this.streamController.startLoad(this.startIndex)}},{key:"onDataReady",value:function(){this.changing&&(this.changing=!1,this.play()),(this.seeking||this.autoPlay&&!this.paused)&&this.play()}},{key:"buffer",value:function(){var t=this.imagePlayer.buffer(),e=this.audioPlayer.buffer(),n=Math.max(t.start,e.start),r=Math.min(t.end,e.end);return n<r?[n,r]:[0,0]}},{key:"play",value:function(){this.logger.info("play",this.status),"playing"!==this.status&&(this.logger.info("start play"),this.status="playing",this.paused=!1,this.action.play(this.currentTime),this.events.emit(st.PlayerPlay,this))}},{key:"on",value:function(t,e){this.events.on("Player."+t,e)}},{key:"off",value:function(t,e){this.events.off("Player."+t,e)}},{key:"once",value:function(t,e){this.events.once("Player."+t,e)}},{key:"pause",value:function(){"pause"!=this.status&&(this.logger.info("pause"),this.status="pause",this.action.pause(),this.paused=!0,this.events.emit(st.PlayerPause,this))}},{key:"seek",value:function(t){t<this.startTime||(t>=1e3*this.duration?this.logger.info("seek","seek to time:",t):(this.seekTime=Date.now(),this.seeking=!0,this.currentTime=t,this.action.seek(t)))}},{key:"resizeScreen",value:function(t,e){L.adaptSizeElement(t,e,this.$screenContainer,this.$canvas)}},{key:"muted",get:function(){return m()(this,hi)},set:function(t){k()(this,hi,!!t)}},{key:"playbackRate",set:function(t){k()(this,ci,t)},get:function(){return m()(this,ci)}},{key:"seeking",set:function(t){k()(this,li,t),t?this.events.emit(st.PlayerSeeking):this.events.emit(st.PlayerSeekEnd)},get:function(){return m()(this,li)}},{key:"currentTime",get:function(){return m()(this,ui)},set:function(t){k()(this,ui,t)}},{key:"volume",get:function(){return this.audioPlayer.volume},set:function(t){this.audioPlayer.volume=t}}]),n}(U));e.default=di},function(t,e){t.exports=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}},function(t,e){t.exports=function(t){return-1!==Function.toString.call(t).indexOf("[native code]")}},function(t,e,n){!function(){"use strict";var e=n(49),r=n(90);function i(t){var e=t.getContext("2d"),n=null,i=null,a=null;return this.drawFrame=function(o){var s=o.format;t.width===s.displayWidth&&t.height===s.displayHeight||(t.width=s.displayWidth,t.height=s.displayHeight),null!==n&&n.width==s.width&&n.height==s.height||function(t,r){for(var i=(n=e.createImageData(t,r)).data,a=t*r*4,o=0;o<a;o+=4)i[o+3]=255}(s.width,s.height),r.convertYCbCr(o,n.data);var u,l,c,h=s.cropWidth!=s.displayWidth||s.cropHeight!=s.displayHeight;h?(i||(l=s.cropWidth,c=s.cropHeight,(i=document.createElement("canvas")).width=l,i.height=c,a=i.getContext("2d")),u=a):u=e,u.putImageData(n,-s.cropLeft,-s.cropTop,s.cropLeft,s.cropTop,s.cropWidth,s.cropHeight),h&&e.drawImage(i,0,0,s.displayWidth,s.displayHeight)},this.clear=function(){e.clearRect(0,0,t.width,t.height)},this}i.prototype=Object.create(e.prototype),t.exports=i}()},function(t,e,n){!function(){"use strict";var e=n(91);
/**
	 * Basic YCbCr->RGB conversion
	 *
	 * @author Brion Vibber <brion@pobox.com>
	 * @copyright 2014-2019
	 * @license MIT-style
	 *
	 * @param {YUVFrame} buffer - input frame buffer
	 * @param {Uint8ClampedArray} output - array to draw RGBA into
	 * Assumes that the output array already has alpha channel set to opaque.
	 */t.exports={convertYCbCr:function(t,n){var r=0|t.format.width,i=0|t.format.height,a=0|e(t.format.width/t.format.chromaWidth),o=0|e(t.format.height/t.format.chromaHeight),s=t.y.bytes,u=t.u.bytes,l=t.v.bytes,c=0|t.y.stride,h=0|t.u.stride,f=0|t.v.stride,d=r<<2,p=0,y=0,v=0,g=0,m=0,b=0,k=0,P=0,w=0,x=0,_=0,B=0,T=0,E=0,S=0,R=0,L=0,D=0;if(1==a&&1==o)for(k=0,P=d,D=0,R=0;R<i;R+=2){for(v=(y=R*c|0)+c|0,g=D*h|0,m=D*f|0,S=0;S<r;S+=2)w=0|u[g++],B=(409*(x=0|l[m++])|0)-57088|0,T=(100*w|0)+(208*x|0)-34816|0,E=(516*w|0)-70912|0,_=298*s[y++]|0,n[k]=_+B>>8,n[k+1]=_-T>>8,n[k+2]=_+E>>8,k+=4,_=298*s[y++]|0,n[k]=_+B>>8,n[k+1]=_-T>>8,n[k+2]=_+E>>8,k+=4,_=298*s[v++]|0,n[P]=_+B>>8,n[P+1]=_-T>>8,n[P+2]=_+E>>8,P+=4,_=298*s[v++]|0,n[P]=_+B>>8,n[P+1]=_-T>>8,n[P+2]=_+E>>8,P+=4;k+=d,P+=d,D++}else for(b=0,R=0;R<i;R++)for(L=0,p=R*c|0,g=(D=R>>o)*h|0,m=D*f|0,S=0;S<r;S++)w=0|u[g+(L=S>>a)],B=(409*(x=0|l[m+L])|0)-57088|0,T=(100*w|0)+(208*x|0)-34816|0,E=(516*w|0)-70912|0,_=298*s[p++]|0,n[b]=_+B>>8,n[b+1]=_-T>>8,n[b+2]=_+E>>8,b+=4}}}()},function(t,e){!function(){"use strict";
/**
   * Convert a ratio into a bit-shift count; for instance a ratio of 2
   * becomes a bit-shift of 1, while a ratio of 1 is a bit-shift of 0.
   *
   * @author Brion Vibber <brion@pobox.com>
   * @copyright 2016
   * @license MIT-style
   *
   * @param {number} ratio - the integer ratio to convert.
   * @returns {number} - number of bits to shift to multiply/divide by the ratio.
   * @throws exception if given a non-power-of-two
   */t.exports=function(t){for(var e=0,n=t>>1;0!=n;)n>>=1,e++;if(t!==1<<e)throw"chroma plane dimensions must be power of 2 ratio to luma plane dimensions; got "+t;return e}}()},function(t,e,n){!function(){"use strict";var e=n(49),r=n(93);function i(t){var e,n,a=this,o=i.contextForCanvas(t);if(null===o)throw new Error("WebGL unavailable");function s(t,e){var n=o.createShader(t);if(o.shaderSource(n,e),o.compileShader(n),!o.getShaderParameter(n,o.COMPILE_STATUS)){var r=o.getShaderInfoLog(n);throw o.deleteShader(n),new Error("GL shader compilation for "+t+" failed: "+r)}return n}var u,l,c,h,f,d,p,y,v,g,m=new Float32Array([-1,-1,1,-1,-1,1,-1,1,1,-1,1,1]),b={},k={},P={};function w(t){return b[t]||(b[t]=o.createTexture()),b[t]}function x(t,e,n,r){var a=w(t);if(o.activeTexture(o.TEXTURE0),i.stripe){var s=!b[t+"_temp"],u=w(t+"_temp");o.bindTexture(o.TEXTURE_2D,u),s?(o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.NEAREST),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.NEAREST),o.texImage2D(o.TEXTURE_2D,0,o.RGBA,e/4,n,0,o.RGBA,o.UNSIGNED_BYTE,r)):o.texSubImage2D(o.TEXTURE_2D,0,0,0,e/4,n,o.RGBA,o.UNSIGNED_BYTE,r);var l=b[t+"_stripe"],c=!l;c&&(l=w(t+"_stripe")),o.bindTexture(o.TEXTURE_2D,l),c&&(o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.NEAREST),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.NEAREST),o.texImage2D(o.TEXTURE_2D,0,o.RGBA,e,1,0,o.RGBA,o.UNSIGNED_BYTE,function(t){if(P[t])return P[t];for(var e=t,n=new Uint32Array(e),r=0;r<e;r+=4)n[r]=255,n[r+1]=65280,n[r+2]=16711680,n[r+3]=4278190080;return P[t]=new Uint8Array(n.buffer)}(e)))}else o.bindTexture(o.TEXTURE_2D,a),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.LINEAR),o.texImage2D(o.TEXTURE_2D,0,o.LUMINANCE,e,n,0,o.LUMINANCE,o.UNSIGNED_BYTE,r)}function _(t,e,r){var i=b[t];o.useProgram(n);var a=k[t];a||(o.activeTexture(o.TEXTURE0),o.bindTexture(o.TEXTURE_2D,i),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.LINEAR),o.texImage2D(o.TEXTURE_2D,0,o.RGBA,e,r,0,o.RGBA,o.UNSIGNED_BYTE,null),a=k[t]=o.createFramebuffer()),o.bindFramebuffer(o.FRAMEBUFFER,a),o.framebufferTexture2D(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,i,0);var s=b[t+"_temp"];o.activeTexture(o.TEXTURE1),o.bindTexture(o.TEXTURE_2D,s),o.uniform1i(d,1);var p=b[t+"_stripe"];o.activeTexture(o.TEXTURE2),o.bindTexture(o.TEXTURE_2D,p),o.uniform1i(f,2),o.bindBuffer(o.ARRAY_BUFFER,u),o.enableVertexAttribArray(l),o.vertexAttribPointer(l,2,o.FLOAT,!1,0,0),o.bindBuffer(o.ARRAY_BUFFER,c),o.enableVertexAttribArray(h),o.vertexAttribPointer(h,2,o.FLOAT,!1,0,0),o.viewport(0,0,e,r),o.drawArrays(o.TRIANGLES,0,m.length/2),o.bindFramebuffer(o.FRAMEBUFFER,null)}function B(t,n,r){o.activeTexture(n),o.bindTexture(o.TEXTURE_2D,b[t]),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.LINEAR),o.uniform1i(o.getUniformLocation(e,t),r)}function T(t,e){var n=s(o.VERTEX_SHADER,t),r=s(o.FRAGMENT_SHADER,e),i=o.createProgram();if(o.attachShader(i,n),o.attachShader(i,r),o.linkProgram(i),!o.getProgramParameter(i,o.LINK_STATUS)){var a=o.getProgramInfoLog(i);throw o.deleteProgram(i),new Error("GL program linking failed: "+a)}return i}return a.drawFrame=function(s){var b=s.format,k=!e||t.width!==b.displayWidth||t.height!==b.displayHeight;if(k&&(t.width=b.displayWidth,t.height=b.displayHeight,a.clear()),e||function(){if(i.stripe){n=T(r.vertexStripe,r.fragmentStripe),o.getAttribLocation(n,"aPosition"),c=o.createBuffer();var t=new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]);o.bindBuffer(o.ARRAY_BUFFER,c),o.bufferData(o.ARRAY_BUFFER,t,o.STATIC_DRAW),h=o.getAttribLocation(n,"aTexturePosition"),f=o.getUniformLocation(n,"uStripe"),d=o.getUniformLocation(n,"uTexture")}e=T(r.vertex,r.fragment),u=o.createBuffer(),o.bindBuffer(o.ARRAY_BUFFER,u),o.bufferData(o.ARRAY_BUFFER,m,o.STATIC_DRAW),l=o.getAttribLocation(e,"aPosition"),p=o.createBuffer(),y=o.getAttribLocation(e,"aLumaPosition"),v=o.createBuffer(),g=o.getAttribLocation(e,"aChromaPosition")}(),k){var P=function(t,e,n){var r=b.cropLeft/n,i=(b.cropLeft+b.cropWidth)/n,a=(b.cropTop+b.cropHeight)/b.height,s=b.cropTop/b.height,u=new Float32Array([r,a,i,a,r,s,r,s,i,a,i,s]);o.bindBuffer(o.ARRAY_BUFFER,t),o.bufferData(o.ARRAY_BUFFER,u,o.STATIC_DRAW)};P(p,0,s.y.stride),P(v,0,s.u.stride*b.width/b.chromaWidth)}x("uTextureY",s.y.stride,b.height,s.y.bytes),x("uTextureCb",s.u.stride,b.chromaHeight,s.u.bytes),x("uTextureCr",s.v.stride,b.chromaHeight,s.v.bytes),i.stripe&&(_("uTextureY",s.y.stride,b.height),_("uTextureCb",s.u.stride,b.chromaHeight),_("uTextureCr",s.v.stride,b.chromaHeight)),o.useProgram(e),o.viewport(0,0,t.width,t.height),B("uTextureY",o.TEXTURE0,0),B("uTextureCb",o.TEXTURE1,1),B("uTextureCr",o.TEXTURE2,2),o.bindBuffer(o.ARRAY_BUFFER,u),o.enableVertexAttribArray(l),o.vertexAttribPointer(l,2,o.FLOAT,!1,0,0),o.bindBuffer(o.ARRAY_BUFFER,p),o.enableVertexAttribArray(y),o.vertexAttribPointer(y,2,o.FLOAT,!1,0,0),o.bindBuffer(o.ARRAY_BUFFER,v),o.enableVertexAttribArray(g),o.vertexAttribPointer(g,2,o.FLOAT,!1,0,0),o.drawArrays(o.TRIANGLES,0,m.length/2)},a.clear=function(){o.viewport(0,0,t.width,t.height),o.clearColor(0,0,0,0),o.clear(o.COLOR_BUFFER_BIT)},a.clear(),a}i.stripe=-1!==navigator.userAgent.indexOf("Windows"),i.contextForCanvas=function(t){var e={preferLowPowerToHighPerformance:!0,powerPreference:"low-power",failIfMajorPerformanceCaveat:!0,preserveDrawingBuffer:!0};return t.getContext("webgl",e)||t.getContext("experimental-webgl",e)},i.isAvailable=function(){var t,e=document.createElement("canvas");e.width=1,e.height=1;try{t=i.contextForCanvas(e)}catch(t){return!1}if(t){var n=t.TEXTURE0,r=t.createTexture(),a=new Uint8Array(16),o=i.stripe?1:4,s=i.stripe?t.RGBA:t.LUMINANCE,u=i.stripe?t.NEAREST:t.LINEAR;return t.activeTexture(n),t.bindTexture(t.TEXTURE_2D,r),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,u),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,u),t.texImage2D(t.TEXTURE_2D,0,s,o,4,0,s,t.UNSIGNED_BYTE,a),!t.getError()}return!1},i.prototype=Object.create(e.prototype),t.exports=i}()},function(t,e){t.exports={vertex:"precision lowp float;\n\nattribute vec2 aPosition;\nattribute vec2 aLumaPosition;\nattribute vec2 aChromaPosition;\nvarying vec2 vLumaPosition;\nvarying vec2 vChromaPosition;\nvoid main() {\n    gl_Position = vec4(aPosition, 0, 1);\n    vLumaPosition = aLumaPosition;\n    vChromaPosition = aChromaPosition;\n}\n",fragment:"// inspired by https://github.com/mbebenita/Broadway/blob/master/Player/canvas.js\n\nprecision lowp float;\n\nuniform sampler2D uTextureY;\nuniform sampler2D uTextureCb;\nuniform sampler2D uTextureCr;\nvarying vec2 vLumaPosition;\nvarying vec2 vChromaPosition;\nvoid main() {\n   // Y, Cb, and Cr planes are uploaded as LUMINANCE textures.\n   float fY = texture2D(uTextureY, vLumaPosition).x;\n   float fCb = texture2D(uTextureCb, vChromaPosition).x;\n   float fCr = texture2D(uTextureCr, vChromaPosition).x;\n\n   // Premultipy the Y...\n   float fYmul = fY * 1.1643828125;\n\n   // And convert that to RGB!\n   gl_FragColor = vec4(\n     fYmul + 1.59602734375 * fCr - 0.87078515625,\n     fYmul - 0.39176171875 * fCb - 0.81296875 * fCr + 0.52959375,\n     fYmul + 2.017234375   * fCb - 1.081390625,\n     1\n   );\n}\n",vertexStripe:"precision lowp float;\n\nattribute vec2 aPosition;\nattribute vec2 aTexturePosition;\nvarying vec2 vTexturePosition;\n\nvoid main() {\n    gl_Position = vec4(aPosition, 0, 1);\n    vTexturePosition = aTexturePosition;\n}\n",fragmentStripe:"// extra 'stripe' texture fiddling to work around IE 11's poor performance on gl.LUMINANCE and gl.ALPHA textures\n\nprecision lowp float;\n\nuniform sampler2D uStripe;\nuniform sampler2D uTexture;\nvarying vec2 vTexturePosition;\nvoid main() {\n   // Y, Cb, and Cr planes are mapped into a pseudo-RGBA texture\n   // so we can upload them without expanding the bytes on IE 11\n   // which doesn't allow LUMINANCE or ALPHA textures\n   // The stripe textures mark which channel to keep for each pixel.\n   // Each texture extraction will contain the relevant value in one\n   // channel only.\n\n   float fLuminance = dot(\n      texture2D(uStripe, vTexturePosition),\n      texture2D(uTexture, vTexturePosition)\n   );\n\n   gl_FragColor = vec4(fLuminance, fLuminance, fLuminance, 1);\n}\n"}},function(t,e,n){"use strict";n.r(e);var r=n(3),i=n.n(r),a=n(4),o=n.n(a),s=n(0),u=n.n(s),l=n(61),c=n.n(l),h=n(11),f=n.n(h),d=n(18),p=n.n(d),y=n(28),v=n.n(y),g=n(10),m=n(23);function b(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return k(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return k(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function k(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var P=g.a.get("HTTP.js",{level:2}),w=function(){var t=v()(p.a.mark((function t(e){var n;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e instanceof Blob)){t.next=5;break}return t.next=3,new Response(e).arrayBuffer();case 3:return n=t.sent,t.abrupt("return",new Uint8Array(n,0));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();var x=function(t){if(t)return Object.entries(t).reduce((function(t,e,n){var r=c()(e,2),i=r[0],a=r[1];return t+(0===n?i+"="+encodeURIComponent(a):"&"+i+"="+encodeURIComponent(a))}),"")};function _(t,e){var n=("function"==typeof t.clone?t.clone():void 0)||t,r=function(t,e){var n={body:e,headers:function(t){return t.headers.entries?function(t){var e,n=Object.create(Object.getPrototypeOf(t.headers)),r=b(t.headers.entries());try{for(r.s();!(e=r.n()).done;){var i=c()(e.value,2),a=i[0],o=i[1];n[a]=o}}catch(t){r.e(t)}finally{r.f()}return n}(t):function(t){var e={},n=t.headers.__headers__;for(var r in n)e[r]=n[r].join("");return e}(t)}(t),response:t,status:t.status,statusText:t.statusText};return t.ok?Promise.resolve(n):Promise.reject(n)};return t[e]().then((function(t){return r(n,t)}))}function B(t,e){var n=t.headers.get("content-type"),r=t.clone().body.getReader(),i=0,a=i,o=setInterval((function(){var t=50*(i-a);t<=1||(P.info("HTTP>handleResponse","".concat(a," | ").concat(i),"".concat(t.toFixed(2)," Bytes/s")),self.postMessage({type:"notice",method:"fetch",noticeType:"speed",data:{speed:t,intervalValue:20,lastReceived:a,bytesReceived:i}}),a=i)}),20);return r.read().then((function a(s){return s.done?(clearInterval(o),function(){if("ts"===e||"video"===e)return _(t,"blob");if(n.includes("json"))return _(t,"json");if(n.includes("text"))return _(t,"text");if(n.includes("form"))return _(t,"formData");if(n.includes("video")||n.includes("image")||n.includes("octet-stream"))return _(t,"blob");try{return _(t,"text")}catch(e){return Object(m.a)(e,"[HTTP>handleResponse:unknow content-type]",n,t),Promise.resolve(t)}}()):(i+=s.value.length,r.read().then(a))}))}var T=null,E=(T||(T=new(function(){function t(e){i()(this,t),u()(this,"options",{"content-type":"application/json;charset=UTF-8",cache:"no-cache",mode:"cors"}),Object.assign(this.options,e)}var e;return o()(t,[{key:"setOptions",value:function(t){var e=Object.assign(this.options,t);e.url=function(t){var e=t.url,n=t.params;return n?e+"?"+x(n):e}(e),e.method=e.method||"get",e.headers=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.headers,n=void 0===e?{}:e,r=t.method,i=void 0===r?"get":r,a=t.username,o=t.password,s=t.token,u=new Headers(n);if(a||o){if(!a)throw new TypeError("username required for basic authentication");if(!o)throw new TypeError("password required for basic authentication");var l="object"===("undefined"==typeof win?"undefined":f()(win))&&win.btoa?btoa:function(t){return t};u.set("Authorization","Basic "+l(a+":"+o))}return s&&u.set("Authorization","Bearer "+s),"get"===i||u.get("content-type")||u.set("content-type","application/json"),u}(e),e.body=function(t){var e=t.headers.get("content-type");if(e)return e.includes("json")?JSON.stringify(t.body):e.includes("x-www-form-urlencoded")?x(t.body):t.body}(e),delete e.username,delete e.password,delete e.token,this.options=e}},{key:"request",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;if(t)return this.setOptions(Object.assign({url:t},e)),fetch(this.options.url,this.options).then((function(t){return B(t,n)}));P.error("[HTTP>request]","url is undefined","url:",t,"options:",e)}},{key:"fetch",value:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(){var t=v()(p.a.mark((function t(e){var n,r,i,a,o=arguments;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=o.length>1&&void 0!==o[1]?o[1]:{},r=o.length>2?o[2]:void 0,i=o.length>3?o[3]:void 0,e){t.next=6;break}return P.wran("[HTTP>fetch]","url is undefined","url:",e,"options:",n),t.abrupt("return");case 6:return this.setOptions(Object.assign({url:e},n)),P.info("[HTTP>fetch]","http fetch","url:",e,"options:",n),t.next=10,fetch(e,n);case 10:(a=t.sent).ok?a.text().then((function(t){self.postMessage({type:"invoke",method:"fetch",fileType:i,name:r,data:t})})):self.postMessage({result:"failed"});case 12:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}())},{key:"get",value:(e=v()(p.a.mark((function t(e){var n,r,i,a,o,s=arguments;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=s.length>1&&void 0!==s[1]?s[1]:{},r=s.length>2?s[2]:void 0,i=s.length>3?s[3]:void 0,n.method="get",P.info("[HTTP>get]","http get","url:",e,"options:",n,"name:",r,"fileType:",i),o={type:"invoke",method:"get",fileType:i,name:r,url:e},t.prev=6,t.next=9,this.request.call(this,e,n,i);case 9:a=t.sent,t.next=15;break;case 12:t.prev=12,t.t0=t.catch(6),P.error("[HTTP>get]","networks error","url:",e,"options:",n,"name:",r,"fileType:",i,"ex:",t.t0);case 15:if(!a||!a.body){t.next=24;break}if(o.data=a.body,"ts"!==i&&"video"!==i){t.next=21;break}return t.next=20,w(o.data);case 20:o.arrayBuffer=t.sent;case 21:o.arrayBuffer?self.postMessage(o,[o.arrayBuffer.buffer]):self.postMessage(o),t.next=27;break;case 24:o.type="error",o.data=a,self.postMessage(o);case 27:case"end":return t.stop()}}),t,this,[[6,12]])}))),function(t){return e.apply(this,arguments)})}]),t}())({})),T);e.default=function(t){t.onmessage=function(t){var e=t.data,n=e.type,r=e.method;switch(n){case"invoke":E[r].call(E,e.url,e.options,e.name,e.fileType)}}}},function(t,e){t.exports=function(t){if(Array.isArray(t))return t}},function(t,e){t.exports=function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!e||n.length!==e);r=!0);}catch(t){i=!0,a=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}}},function(t,e,n){var r=n(98);t.exports=function(t,e){if(t){if("string"==typeof t)return r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}}},function(t,e){t.exports=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}},function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";n.r(e);var r,i=n(3),a=n.n(i),o=n(4),s=n.n(o),u=n(9),l=function(){function t(e){a()(this,t),this.decode=e,this.result=[]}return s()(t,[{key:"openDecode",value:function(){var t=this,e=Module.addFunction((function(e,n,r,i,a,o,s,u,l){var c=HEAPU8.subarray(e,e+i*u),h=HEAPU8.subarray(n,n+a*u/2),f=HEAPU8.subarray(r,r+o*u/2),d={stride_y:i,stride_u:a,stride_v:o,width:s,height:u,buf_y:new Uint8Array(c),buf_u:new Uint8Array(h),buf_v:new Uint8Array(f),pts:l};t.result.push(d)}));Module._openDecoder(e,1)}},{key:"decodeData",value:function(t,e){var n=t.length,r=Module._malloc(n);Module.HEAPU8.set(t,r),Module._decodeData(r,n,e),Module._free(r)}},{key:"flush",value:function(){for(Module._flushDecoder();this.checkData();)this.decode.getDecodeYUV()}},{key:"closeDecode",value:function(){Module._closeDecoder()}},{key:"getYUV",value:function(){var t=null;return this.result.length>0&&(t=this.result.shift()),t}},{key:"checkData",value:function(){return this.result.length>0}}]),t}(),c=function(){function t(e){a()(this,t),this.decode=e}return s()(t,[{key:"openDecode",value:function(){return _web_decoder_open()}},{key:"closeDecode",value:function(t){_web_decoder_close(t)}},{key:"decodeData",value:function(t,e,n){var r=t.length||0;Module.ccall("web_decoder_decode_frame","number",["number","array","number","number"],[n,t,r,e])}},{key:"flush",value:function(t){var e=this.decode;if(_web_decoder_decode_frame)for(;;){if(_web_decoder_decode_frame(t,null,0,0)<0||!_web_got_frame(t))break;e.getDecodeYUV(t)}}},{key:"getYUV",value:function(t){var e=_web_get_stride_y(t),n=_web_get_stride_u(t),r=_web_get_stride_v(t),i=_web_get_width(t),a=_web_get_height(t),o=_web_get_frame_y(t),s=_web_get_frame_u(t),l=_web_get_frame_v(t),c=parseInt(_web_got_frame_pts(t)*u.a*1e3),h=HEAPU8.subarray(o,o+e*a),f=HEAPU8.subarray(s,s+n*a/2),d=HEAPU8.subarray(l,l+r*a/2);return{stride_y:e,stride_u:n,stride_v:r,width:i,height:a,buf_y:new Uint8Array(h),buf_u:new Uint8Array(f),buf_v:new Uint8Array(d),pts:c}}},{key:"checkData",value:function(t){return _web_got_frame(t)}}]),t}(),h=function(){function t(){a()(this,t),this.p=null,this.ptsList=[],this.ptsOffset=0,this.fps=0,this.lastDuration=0,this.previousPTS=0,this.status=!1,this.yuvArray=[],this.decodeTool=null}return s()(t,[{key:"loadWASM",value:function(t){var e=t.data.libPath;self.Module={locateFile:function(t){return e+t}},self.importScripts(e+"libffmpeg.js"),self.Module.onRuntimeInitialized=function(){console.log("wasm loaded"),Module._web_decoder_open?self.decode.decodeTool=new c(self.decode,this.event):self.decode.decodeTool=new l(self.decode,this.event),self.decode.openDecode(),self.decode.onWasmLoaded()}}},{key:"openDecode",value:function(){try{this.status||(this.p=this.decodeTool.openDecode(),this.status=!0),console.log("opendecode")}catch(t){console.error(t)}}},{key:"closeDecode",value:function(){this.status&&(this.decodeTool.closeDecode(this.p),this.status=!1)}},{key:"push",value:function(t){var e=this;t.forEach((function(t){var n=t.PTS,r=t.data_byte,i=t.partEnd,a=t.lastTS,o=e.ptsList;e.insertSort(o,parseInt(n*u.a*1e3)),e.decodeTool.decodeData(r,n,e.p),e.decodeTool.checkData(e.p)&&e.getDecodeYUV(e.p,i,a)}))}},{key:"getDecodeYUV",value:function(t,e,n){if(!this.reseting){var r=0;this.fps||(this.fps=this.getFPS());var i=this.decodeTool.getYUV(t),a=this.ptsList.shift();if(i.pts=a,this.previousPTS&&a?(r=parseInt(a-this.previousPTS),this.lastDuration=r):r=this.lastDuration,i.duration=r,i.fps=this.fps,a)this.previousPTS=a,this.yuvArray.push(i),this.yuvArray.length>10&&(self.postMessage({type:"decoded",data:this.yuvArray}),this.yuvArray=[]);e&&(this.yuvArray.length&&(self.postMessage({type:"decoded",data:this.yuvArray}),this.yuvArray=[]),self.postMessage({type:"partEnd",data:n}))}}},{key:"reset",value:function(){this.reseting=!0,this.ptsList=[],this.ptsOffset=0,this.previousPTS=0,this.fps=0,this.yuvArray=[],this.closeDecode(),this.openDecode(),self.postMessage({type:"resetEnd",data:Date.now()}),this.reseting=!1}},{key:"flush",value:function(){this.decodeTool.flush(this.p),this.yuvArray.length&&(self.postMessage({type:"decoded",data:this.yuvArray}),this.yuvArray=[]),this.closeDecode(),self.postMessage({type:"flushEnd",data:this.previousPTS})}},{key:"getFPS",value:function(){var t=this.ptsList;return t.length>=2?Math.round(1e3/(t[1]-t[0])):null}},{key:"onWasmLoaded",value:function(){self.postMessage({type:"dataProcessorReady"})}},{key:"insertSort",value:function(t,e){var n=t.length;if(0!==n){for(var r=0;r<n;r++)if(e<t[r]){for(var i=n;i>r;)t[i]=t[i-1],i--;return void(t[r]=e)}t.push(e)}else t.push(e)}}]),t}(),f=n(0),d=n.n(f);!function(t){t.ERROR="ERROR",t.INFO="INFO",t.DATA="DATA",t.DEMUX_DATA="DEMUX_DATA",t.DONE="DONE"}(r||(r={}));var p=Object.create||function(t){var e=function(){};return e.prototype=t,new e},y=Object.keys||function(t){for(var e in t)Object.prototype.hasOwnProperty.call(t,e);return e},v=Function.prototype.bind||function(t){var e=this;return function(){return e.apply(t,arguments)}};let g,m=10;class b{constructor(){this._events&&Object.prototype.hasOwnProperty.call(this,"_events")||(this._events=p(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0}static listenerCount(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):_.call(t,e)}emit(t,...e){var n,r,i,a,o,s,u="error"===t;if(s=this._events)u=u&&null==s.error;else if(!u)return!1;if(u){if(arguments.length>1&&(n=arguments[1]),n instanceof Error)throw n;var l=new Error('Unhandled "error" event. ('+n+")");throw l.context=n,l}if(!(r=s[t]))return!1;var c="function"==typeof r;switch(i=arguments.length){case 1:!function(t,e,n){if(e)t.call(n);else for(var r=t.length,i=B(t,r),a=0;a<r;++a)try{i[a].call(n)}catch(t){console.error(t)}}(r,c,this);break;case 2:!function(t,e,n,r){if(e)t.call(n,r);else for(var i=t.length,a=B(t,i),o=0;o<i;++o)try{a[o].call(n,r)}catch(t){console.error(t)}}(r,c,this,arguments[1]);break;case 3:!function(t,e,n,r,i){if(e)t.call(n,r,i);else for(var a=t.length,o=B(t,a),s=0;s<a;++s)try{o[s].call(n,r,i)}catch(t){console.error(t)}}(r,c,this,arguments[1],arguments[2]);break;case 4:!function(t,e,n,r,i,a){if(e)t.call(n,r,i,a);else for(var o=t.length,s=B(t,o),u=0;u<o;++u)try{s[u].call(n,r,i,a)}catch(t){console.error(t)}}(r,c,this,arguments[1],arguments[2],arguments[3]);break;default:for(a=new Array(i-1),o=1;o<i;o++)a[o-1]=arguments[o];!function(t,e,n,r){if(e)t.apply(n,r);else for(var i=t.length,a=B(t,i),o=0;o<i;++o)try{a[o].apply(n,r)}catch(t){console.error(t)}}(r,c,this,a)}return!0}on(t,e){return function(t,e,n){var r,i,a;if("function"!=typeof n)throw new TypeError('"listener" argument must be a function');(i=t._events)?(i.newListener&&(t.emit("newListener",e,n.listener?n.listener:n),i=t._events),a=i[e]):(i=t._events=p(null),t._eventsCount=0);if(a){if("function"==typeof a?a=i[e]=[a,n]:a.push(n),!a.warned&&(r=void 0===(o=t)._maxListeners?b.defaultMaxListeners:o._maxListeners)&&r>0&&a.length>r){a.warned=!0;class n extends Error{}let r=new n("Possible Dispatcher memory leak detected. "+a.length+' "'+String(e)+'" listeners added. Use emitter.setMaxListeners() to increase limit.');r.name="MaxListenersExceededWarning",r.emitter=t,r.type=e,r.count=a.length,"object"==typeof console&&console.warn&&console.warn("%s: %s",r.name,r.message)}}else a=i[e]=n,++t._eventsCount;var o;return t}(this,t,e)}once(t,e){if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');return this.on(t,function(t,e,n){var r={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},i=v.call(w,r);return i.listener=n,r.wrapFn=i,i}(this,t,e)),this}off(t,e){return P.call(this,t,e)}removeAllListeners(t){var e,n,r;if(!(n=this._events))return this;if(!n.off)return 0===arguments.length?(this._events=p(null),this._eventsCount=0):n[t]&&(0==--this._eventsCount?this._events=p(null):delete n[t]),this;if(0===arguments.length){var i,a=y(n);for(r=0;r<a.length;++r)"off"!==(i=a[r])&&this.removeAllListeners(i);return this.removeAllListeners("off"),this._events=p(null),this._eventsCount=0,this}if("function"==typeof(e=n[t]))this.off(t,e);else if(e)for(r=e.length-1;r>=0;r--)this.off(t,e[r]);return this}listeners(t){return x(this,t,!0)}rawListeners(t){return x(this,t,!1)}listenerCount(){return b.listenerCount.apply(this,arguments)}}try{var k={};Object.defineProperty&&Object.defineProperty(k,"x",{value:0}),g=0===k.x}catch(t){g=!1}function P(t,e){var n,r,i,a,o;if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');if(!(r=this._events))return this;if(!(n=r[t]))return this;if(n===e||n.listener===e)0==--this._eventsCount?this._events=p(null):(delete r[t],r.off&&this.emit("off",t,n.listener||e));else if("function"!=typeof n){for(i=-1,a=n.length-1;a>=0;a--)if(n[a]===e||n[a].listener===e){o=n[a].listener,i=a;break}if(i<0)return this;0===i?n.shift():function(t,e){for(var n=e,r=n+1,i=t.length;r<i;n+=1,r+=1)t[n]=t[r];t.pop()}(n,i),1===n.length&&(r[t]=n[0]),r.off&&this.emit("off",t,o||e)}return this}function w(){if(!this.fired)switch(this.target.off(this.type,this.wrapFn),this.fired=!0,arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:for(var t=new Array(arguments.length),e=0;e<t.length;++e)t[e]=arguments[e];this.listener.apply(this.target,t)}}function x(t,e,n){var r=t._events;if(!r)return[];var i=r[e];return i?"function"==typeof i?n?[i.listener||i]:[i]:n?function(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}(i):B(i,i.length):[]}function _(t){var e=this._events;if(e){var n=e[t];if("function"==typeof n)return 1;if(n)return n.length}return 0}function B(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t[r];return n}g?Object.defineProperty(b,"defaultMaxListeners",{enumerable:!0,get:function(){return m},set:function(t){if("number"!=typeof t||t<0||t!=t)throw new TypeError('"defaultMaxListeners" must be a positive number');m=t}}):b.defaultMaxListeners=m;class T extends b{}var E=Object.prototype.toString;function S(t){return!!t&&"object"==typeof t}function R(t){return"number"==typeof t&&!isNaN(t)}function L(t){return S(t)&&"[object arraybuffer]"===E.call(t).toLowerCase()}class D{constructor(){this.list_=[]}get byteLength(){if(!R(this.byteLength_)){let t=0;for(let e,n=0;n<this.list_.length;n++)e=this.list_[n],t+=e.byteLength;this.byteLength_=t}return this.byteLength_}get bytes(){const{bufferList:t}=this;let e=null;return t.length>0&&(e=0===t.length?t[0]:this.toNewBytes()),e}get empty(){return 0===this.list_.length}get bufferList(){return this.list_}clear(){let t=this.list_.length;t>0&&this.list_.splice(0,t),this.byteLength_=null}toNewBytes(){let t=null,e=0;for(;null===t;)try{e++,t=new Uint8Array(this.byteLength)}catch(t){if(e>50)throw t}for(let e=0,n=0;e<this.list_.length;e++){let r=this.list_[e];t.set(r,n),n+=r.byteLength}return t}append(t){t instanceof D?this.list_=this.list_.concat(t.bufferList):this.list_.push(t),this.byteLength_=null}cut(t,e=!0){let n=null;if(t>0&&!this.empty){let r=this.list_,i=0,a=0;for(;r.length>0;){let o=r.shift();if(0!==a){let a=t-i;if(o.byteLength>=a){e&&n.set(o.subarray(0,a),i),o=o.subarray(a),o.byteLength>0&&r.unshift(o);break}e&&n.set(o,i),i+=o.byteLength;break}if(o.byteLength>=t){e&&(n=o.subarray(0,t)),o.byteLength>t&&(o=o.subarray(t),r.unshift(o));break}if(e){try{n=new Uint8Array(t)}catch(e){throw`alloc_memory_error@ cache buffer: ${t} ${e.message}`}n.set(o,0)}i+=o.byteLength,a++}this.byteLength_=null}return n}}class C{constructor(){this.map_={}}push(t,e){Object.prototype.hasOwnProperty.call(this.map_,t)?this.map_[t].push(e):this.map_[t]=[e]}get(t){let e=this.map_[t];return e?e.slice():null}getAll(){let t=[];for(let e in this.map_)t.push.apply(t,this.map_[e]);return t}remove(t,e){let n=this.map_[t];if(n)for(let t=0;t<n.length;++t)n[t]==e&&(n.splice(t,1),--t)}clear(){this.map_={}}forEach(t){for(let e in this.map_)t(e,this.map_[e])}}class A{constructor(t,e,n){this.target=t,this.type=e,this.listener=n,this.target.addEventListener?this.target.addEventListener(e,n,!1):this.target.on&&this.target.on(e,n,!1)}off(){this.target.removeEventListener?this.target.removeEventListener(this.type,this.listener,!1):this.target.off&&this.target.off(this.type,this.listener,!1),this.target=null,this.listener=null}}class O{constructor(){this.bindingMap_=new C}destroy(){this.removeAll(),this.bindingMap_=null}on(t,e,n){if(!this.bindingMap_)return;let r=new A(t,e,n);return this.bindingMap_.push(e,r),this}once(t,e,n){this.on(t,e,function(r){this.off(t,e),n(r)}.bind(this))}off(t,e){if(!this.bindingMap_)return;let n=this.bindingMap_.get(e)||[];for(let r=0;r<n.length;++r){let i=n[r];i.target==t&&(i.off(),this.bindingMap_.remove(e,i))}}removeAll(){if(!this.bindingMap_)return;let t=this.bindingMap_.getAll();for(let e=0;e<t.length;++e)t[e].off();this.bindingMap_.clear()}}let M;M="undefined"==typeof window?self:window;let I=M.console;const U="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"undefined"!=typeof importScripts;let N=new class extends b{constructor(){super(),this._enable=!1}get enable(){return this._enable}set enable(t){this._enable=t,this.MSG_NAME="__log__"}log(...t){U?N.emit(this.MSG_NAME,"log",[...t].join("")):this._enable&&I.log.call(I,">>>",...t)}debug(...t){U?N.emit(this.MSG_NAME,"debug",[...t].join("")):this._enable&&I.debug&&I.debug.call(I,">>>",...t)}assert(...t){if(this._enable&&I.assert){let e=t[0],n=Array.prototype.slice.call(t,1);n.unshift(">>>"),I.assert.call(I,e,...n)}}warn(...t){U?N.emit(this.MSG_NAME,"warn",[...t].join("")):this._enable&&I.warn.call(I,">>>",...t)}error(...t){U?N.emit(this.MSG_NAME,"error",[...t].join("")):this._enable&&I.error.call(I,">>>",...t)}};class H extends b{constructor(){super()}pipe(t){return this.on("reset",(function(){t.reset()})),this.on("data",(function(e){t.push(e)})),this.on("done",(function(e){t.flush(e)})),t}unpipe(){return this.removeAllListeners("reset"),this.removeAllListeners("data"),this.removeAllListeners("done"),this}push(t,e){this.emit("data",t)}flush(t){this.emit("done",t)}reset(){this.emit("reset")}}class F extends H{constructor(t={}){super(),t.debug&&(N.enable=!0),this.ctx_=new T,this.options_=t,this.cache_buffer_=new D}listenEndStream_(){this.eventManager_=new O,this.eventManager_.on(this.endStream,"data",t=>{this.emit(r.DEMUX_DATA,t)}).on(this.endStream,"done",t=>{this.emit(r.DONE,t)}).on(this.ctx_,"error",t=>{this.emit(r.ERROR,t)})}constraintPushData_(t){let e=null;return L(t)||S(n=t)&&"[object uint8array]"===E.call(n).toLowerCase()?(e=L(t)?new Uint8Array(t):t,e):(N.error("Data pushed is not an ArrayBuffer or Uint8Array: "+t),e);var n}reset(){}destroy(){this.unpipe(),this.endStream.unpipe(),this.eventManager_.removeAll()}}var j;!function(t){t[t.WORKER_EXCEPTION=0]="WORKER_EXCEPTION",t[t.WORKER_MSG_EXCEPTION=1]="WORKER_MSG_EXCEPTION",t[t.TS_SYNC_BYTE=2]="TS_SYNC_BYTE",t[t.FLV_HEAD_SIGNATURE=3]="FLV_HEAD_SIGNATURE",t[t.FLV_NOT_EXPECTED_ADJACENT_DATA=4]="FLV_NOT_EXPECTED_ADJACENT_DATA"}(j||(j={}));var W=j;function V(t){let e=0;return ArrayBuffer.isView(t)&&(e=t.byteOffset,t=t.buffer),new DataView(t,e)}class z{constructor(){}readUint8(t,e){return V(t).getUint8(e)}readUint16(t,e,n=!1){return V(t).getUint16(e,n)}readUint32(t,e,n=!1){return V(t).getUint32(e,n)}}class X extends z{constructor(t){super(),this.table_id=t[0],this.section_syntax_indicator=t[1]>>7,this.section_length=(15&t[1])<<8|t[2],this.transport_stream_id=this.readUint16(t,3),this.version_number=t[5]>>1&31,this.current_next_indicator=t[5]&&1,this.section_number=t[6],this.last_section_number=t[7],this.network_PID=0;var e,n=0,r=this.section_length-4-5;for(this.pmtTable=[];n<r;n+=4)0==(e=this.readUint16(t,8+n))?(this.network_PID=(31&t[10+n])<<8|t[11+n],N.log("packet->network_PID %0x /n/n",this.network_PID)):this.pmtTable.push({programNum:e,program_map_PID:(31&t[10+n])<<8|t[11+n]});var i=this.section_length+3;this.CRC_32=(255&t[i-4])<<24|(255&t[i-3])<<16|(255&t[i-2])<<8|255&t[i-1]}}class G extends z{constructor(t){if(super(),this.table_id=t[0],this.section_syntax_indicator=t[1]>>7,this.section_length=(15&t[1])<<8|t[2],this.program_number=this.readUint16(t,3),this.version_number=t[5]>>1&31,this.current_next_indicator=t[5]&&1,this.section_number=t[6],this.last_section_number=t[7],this.PCR_PID=(31&t[8])<<8|t[9],this.program_info_length=(15&t[10])<<8|t[11],this.program_info_length<0)return;if(this.program_info_length>2){let e=0;for(;e<this.program_info_length;){e+=t[13+e]}}var e=12+this.program_info_length,n=this.section_length-this.program_info_length-9-4,r=e+n;if(e>=r)return void N.warn(`es_section_pos < es_section_end ${e}, ${r}`);this.pes_table=[];let i=0;for(;i<n;){let n=t[e+i],r=8191&this.readUint16(t,e+i+1),a=4095&this.readUint16(t,e+i+3);if(this.pes_table.push({streamType:n,PID:r}),a>2){let n=0,r=e+i+5;for(;n<a;){n+=t[r+n]}}i+=a+5}var a=this.section_length+3;this.CRC_32=(255&t[a-4])<<24|(255&t[a-3])<<16|(255&t[a-2])<<8|255&t[a-1]}parse(){}}class Y extends z{constructor(t){super(),this.table_id=t[0],this.section_syntax_indicator=t[1]>>7,this.section_length=(15&t[1])<<8|t[2],this.transport_stream_id=this.readUint16(t,3),this.version_number=t[5]>>1&31,this.current_next_indicator=1&t[5],this.section_number=t[6],this.last_section_number=t[7],this.original_network_id=this.readUint16(t,8);let e=this.section_length-8-4;this.service_table=[];let n=0;for(;n<e;){let e=0,r={service_id:this.readUint16(t,11),EIT_schedule_flag:2&t[13],EIT_present_following_flag:1&t[13],running_status:t[14]>>5,free_CA_mode:t[14]>>4&1,descriptors_loop_length:(15&t[14])<<8|t[15],provider_name:"",name:""};for(;e<r.descriptors_loop_length;){let n=16+e,i=t[n],a=t[n+1];switch(i){case 72:{let e=[],i=t[n+3],a=0,o=0,s=n+4;for(a=0;a<i;a++)e.push(String.fromCharCode(t[s])),s+=1;r.provider_name=e.join("");let u=[],l=t[s];for(s+=1,o=0;o<l;o++)u.push(String.fromCharCode(t[s])),s+=1;r.name=u.join("")}break;default:N.warn("sdt section unhandled descriptor_tag "+i)}e+=2+a}this.service_table.push(r),n+=5+r.descriptors_loop_length}}}class ${}class q{constructor(t){this.context=t,this.metadata=new $,this.pat_table=[],this.pes_streams=[]}get currentProgramPID(){let t=[];for(let e=0;e<this.pat_table.length;e++)t.push(this.pat_table[e].pid);return t.length>0?t[0]:-1}reset(){this.metadata=new $,this.pat_table.splice(0,this.pat_table.length),this.pes_streams.splice(0,this.pes_streams.length)}parse(t){0===t.PID?this._parsePat(t):1===t.PID||2===t.PID||3<=t.PID&&t.PID<=15||(17===t.PID?this._parseSdt(t):t.PID===this.currentProgramPID&&this._parsePmt(t))}findTrack(t){let e=null,n=this.pes_streams;for(let r=0;r<n.length;r++)if(n[r].id===t){e=n[r];break}return e}_parsePat(t){let e;if(t.payload_unit_start_indicator){let n=t.payload[0];e=t.payload.subarray(n+1)}else e=t.payload;let n=new X(e);for(var r=0;r<n.pmtTable.length;r++)this._add_pid_to_pmt(n.pmtTable[r].programNum,n.pmtTable[r].program_map_PID);return n}_add_pid_to_pmt(t,e){let n=this.pat_table;(function(t){for(let e,r=0;r<n.length;r++)if(e=n[r],e.id===t)return{idx:r,item:e};return null})(t)||n.push({id:t,pid:e})}_parsePmt(t){let e;if(t.payload_unit_start_indicator){let n=t.payload[0];e=t.payload.subarray(n+1)}else e=t.payload;let n=new G(e);for(var r=0;r<n.pes_table.length;r++)this._add_pes_stream(n.pes_table[r],n);return n}_add_pes_stream(t,e){let n=this.pes_streams;(function(t){for(let e,r=0;r<n.length;r++)if(e=n[r],e.id===t)return{idx:r,item:e};return null})(t.PID)||n.push({id:t.PID,stream_type:t.streamType,pcr_pid:e.PCR_PID,duration:0,sps:[],pps:[],pixelRatio:[1,1],timescale:9e4,width:0,height:0})}_parseSdt(t){let e;if(t.payload_unit_start_indicator){let n=t.payload[0];e=t.payload.subarray(n+1)}else e=t.payload;let n=new Y(e);return n.service_table.length>0&&(this.metadata.service_name=n.service_table[0].name,this.metadata.service_provider=n.service_table[0].provider_name),n}}class K extends H{constructor(t,e){super(),this.context=t,this.PSI=e,this.videoTrack=null,this.audioTrack=null,this.captionTrack=null}push(t){let e=t;for(let t,n=0;n<e.length;n++)switch(t=e[n],t.type){case"video":this._complexVideo(t);break;case"audio":this._complexAudio(t);break;case"caption":this._complexCaption(t)}}flush(){this.emit("done"),this._clearStream()}reset(){this._clearStream()}_clearStream(){this.videoTrack=null,this.audioTrack=null,this.captionTrack=null}_complexVideo(t){let e=this.PSI.findTrack(t.trackId);e&&(e.type="video",e.gops=t,e.firstDTS=t[0][0].dts,e.firstPTS=t[0][0].pts,e.duration=Number.POSITIVE_INFINITY,this.videoTrack=e,this.emit("data",{videoTrack:this.videoTrack}))}_complexAudio(t){let e=this.PSI.findTrack(t.trackId);e&&(e.type="audio",e.frames=t,e.firstPTS=e.firstDTS=t[0].dts,e.duration=Number.POSITIVE_INFINITY,this.audioTrack=e,this.emit("data",{audioTrack:this.audioTrack}))}_complexCaption(){}}const Q={mac:!1,iphone:!1,android:!1},Z={version:!1,CHROME:!1,SAFARI:!1,FIREFOX:!1,IE11:!1,IE:!1,EDGE:!1,WECHAT:!1};let J=navigator.userAgent.toLowerCase();var tt=/(edge)\/([\w.]+)/.exec(J)||/(opr)[/]([\w.]+)/.exec(J)||/(chrome)[ /]([\w.]+)/.exec(J)||/(firefox)[ /]([\w.]+)/.exec(J)||/(iemobile)[/]([\w.]+)/.exec(J)||/(version)(applewebkit)[ /]([\w.]+).*(safari)[ /]([\w.]+)/.exec(J)||/(webkit)[ /]([\w.]+).*(version)[ /]([\w.]+).*(safari)[ /]([\w.]+)/.exec(J)||/(webkit)[ /]([\w.]+)/.exec(J)||/(opera)(?:.*version|)[ /]([\w.]+)/.exec(J)||/(msie) ([\w.]+)/.exec(J)||J.indexOf("trident")>=0&&/(rv)(?::| )([\w.]+)/.exec(J)||J.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(J)||[],et=/(ipad)/.exec(J)||/(ipod)/.exec(J)||/(windows phone)/.exec(J)||/(iphone)/.exec(J)||/(kindle)/.exec(J)||/(silk)/.exec(J)||/(android)/.exec(J)||/(win)/.exec(J)||/(mac)/.exec(J)||/(linux)/.exec(J)||/(cros)/.exec(J)||/(playbook)/.exec(J)||/(bb)/.exec(J)||/(blackberry)/.exec(J)||[],nt={version:void 0},rt={browser:tt[5]||tt[3]||tt[1]||"",version:tt[2]||tt[4]||"0",versionNumber:tt[4]||tt[2]||"0",platform:et[0]||""};if(rt.browser){nt[rt.browser]=!0;let t=rt.versionNumber.split(".");nt.version={major:parseInt(rt.versionNumber,10),string:rt.version},t.length>1&&(nt.version.minor=parseInt(t[1],10)),t.length>2&&(nt.version.build=parseInt(t[2],10))}Z.version=nt.version,Z.CHROME=!!nt.chrome,Z.SAFARI=!!nt.safari&&!Z.CHROME,Z.FIREFOX=!!nt.firefox,Z.IE11=/rv:11/.test(J),Z.IE=!!nt.msie||Z.IE11,Z.EDGE=!!nt.edge,Z.WECHAT=/(wechat)|(micromessenger)/.test(J),Q.mac=!!rt.platform.mac,Q.iphone=!!rt.platform.iphone,Q.android=!!rt.platform.android;var it=Z,at=Q;const ot=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];const st=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];class ut extends b{constructor(){super()}push(t){let e,n,r,i,a,{pts:o,dts:s,payload:u}=t,l=u,c=0,h=0;for(;c+5<l.length;){if(255!==l[c]||240!=(246&l[c+1])){c++;continue}if(n=2*(1&~l[c+1]),e=(3&l[c+3])<<11|l[c+4]<<3|(224&l[c+5])>>5,i=1024*(1+(3&l[c+6])),a=9e4*i/st[(60&l[c+2])>>>2],r=c+e,l.byteLength<r)return;let t={pts:o+h*a,dts:s+h*a,sampleCount:i,audioObjectType:1+(l[c+2]>>>6&3),channelCount:(1&l[c+2])<<2|(192&l[c+3])>>>6,sampleRate:st[(60&l[c+2])>>>2],samplingFrequencyIndex:(60&l[c+2])>>>2,sampleSize:16,data:l.subarray(c+7+n,r)};if(this.emit("frame",t),l.byteLength===r)return l=void 0,void this.emit("done");h++,l=l.subarray(r)}}}class lt extends H{constructor(t){super(),this.PSI=t,this.trackId=null,this.codec=new ut,this.codec.on("frame",t=>{this.frames.push(t),this.frames.byteLength+=t.data.byteLength,this.frames.trackId=this.trackId}),this._newFrames()}push(t){15===t.stream_type&&(this.trackId=t.pid,this.codec.push({dts:t.pes.DTS,pts:t.pes.PTS,payload:t.pes.data_byte}))}flush(){if(this.frames.length>0){let t=this.frames.length,e=this.frames[0],n=this.frames[t-1],r=n.sampleRate*n.sampleCount/9e4;this.frames.firstDTS=e.dts,this.frames.firstPTS=e.pts,this.frames.duration=1===t?r:r+(n.pts-e.pts),this._updateTrackMeta(e),this.emit("data",this.frames),this.reset(),this.emit("done")}}reset(){this.trackId=null,this._newFrames()}_newFrames(){this.frames=[],this.frames.type="audio",this.frames.byteLength=0,this.frames.duration=0,this.frames.firstDTS=0,this.frames.firstPTS=0}_updateTrackMeta(t){let e=this.PSI.findTrack(this.trackId),n=((t,e,n)=>{let r,i,a=t;if(!(e>ot.length-1))return it.FIREFOX?e>=6?(t=5,i=new Array(4),r=e-3):(t=2,i=new Array(2),r=e):at.android?(t=2,i=new Array(2),r=e):(t=5,i=new Array(4),e>=6?r=e-3:(1===n&&(t=2,i=new Array(2)),r=e)),i[0]=t<<3,i[0]|=(14&e)>>1,i[1]|=(1&e)<<7,i[1]|=n<<3,5===t&&(i[1]|=(14&r)>>1,i[2]=(1&r)<<7,i[2]|=8,i[3]=0),{config:i,sampleRate:ot[e],channelCount:n,codec:"mp4a.40."+t,realCodec:"mp4a.40."+a};N.error("invalid sampling index:"+e)})(t.audioObjectType,t.samplingFrequencyIndex,t.channelCount);e.config=n.config,e.sampleRate=n.sampleRate,e.inputTimeScale=e.inputTimeScale||e.timescale,e.timescale=n.sampleRate,e.channelCount=n.channelCount,e.codec=n.codec,e.realCodec=n.realCodec,e.isAAC=!0}}function ct(t,e=0,n=1){let r=0,i=0,a=0,o="",s=0;for(let a=e;a<e+n;a++)r=Math.floor(a/8),i=7-a%8,s=t[r]>>i&1,o+=s;return a=parseInt(o,2),a}function ht(t,e=0){let n=[],r=8*t.byteLength,i=!1,a=0,o=0,s=0,u="";for(let u=e;u<r;u++)if(a=Math.floor(u/8),o=7-u%8,s=t[a]>>o&1,!i){if(0!==s){i=!0,e=u;break}n.push(0)}let l=n.length+1;for(let n=e;n<e+l;n++)a=Math.floor(n/8),o=7-n%8,s=t[a]>>o&1,u+=s;return{bitLength:n.length+l,value:parseInt(u,2)-1}}var ft={readUEV:ht,readSEV:function(t,e=0){let n=ht(t,e),r=n.value,i=Math.pow(-1,r+1)*Math.ceil(r/2);return{bitLength:n.bitLength,value:i}},readBit:ct,readByte:function(t,e=0){return ct(t,e,8)}};let dt=0;function pt(t,e){let n,r=8,i=8;for(var a=0;a<e;a++)0!=i&&(n=ft.readUEV(t,dt),dt+=n.bitLength,i=(r+n.value+256)%256),r=t[a]}class yt extends z{constructor(t){switch(super(),this.forbidden_zero_bit=t[0]>>7,this.ref_idc=t[0]>>5&3,this.unit_type=31&t[0],this.data=function(t){let e,n=t.byteLength,r=[],i=1,a=new Uint8Array(0);for(;i<n-2;)0===t[i]&&0===t[i+1]&&3===t[i+2]?(r.push(i+2),i+=2):i++;if(0===r.length)return t;e=n-r.length;try{a=new Uint8Array(e)}catch(t){throw"epsb alloc mem error "+e}let o=0;for(i=0;i<e;o++,i++)o===r[0]&&(o++,r.shift()),a[i]=t[o];return a}(t.subarray(1)),this.rawData=t,this.unit_type){case 1:break;case 2:case 3:case 4:case 5:break;case 7:this.sps=function(t){dt=0;let e,n,r,i,a,o,s,u=t[0],l=t[1],c=t[2],h=t.subarray(3),f=0,d=[1,1],p=1,y=0,v=!0,g=ft.readUEV(h,dt);if(dt+=g.bitLength,100==u||110==u||122==u||244==u||44==u||83==u||86==u||118==u||128==u){let t=ft.readUEV(h,dt);dt+=t.bitLength,3==t.value&&(dt+=1);let e=ft.readUEV(h,dt);dt+=e.bitLength;let n=ft.readUEV(h,dt);if(dt+=n.bitLength,dt+=1,f=ft.readBit(h,dt),dt+=1,f)for(let e=0;e<(3!=t.value?8:12);e++){let t=ft.readBit(h,dt);dt+=1,t&&pt(h,e<6?16:64)}}let m=ft.readUEV(h,dt);dt+=m.bitLength;let b=ft.readUEV(h,dt),k=b.value;if(dt+=b.bitLength,0===k)e=ft.readUEV(h,dt),dt+=e.bitLength;else if(1===k){dt+=1,n=ft.readSEV(h,dt),dt+=n.bitLength,r=ft.readSEV(h,dt),dt+=r.bitLength,i=ft.readUEV(h,dt),dt+=i.bitLength;for(let t,e=0;e<i.value;e++)t=ft.readSEV(h,dt),dt+=t.bitLength}let P=ft.readUEV(h,dt);dt+=P.bitLength,dt+=1;let w=ft.readUEV(h,dt);dt+=w.bitLength;let x=ft.readUEV(h,dt);dt+=x.bitLength;let _=ft.readBit(h,dt);dt+=1,_||(dt+=1),dt+=1;let B=ft.readBit(h,dt);dt+=1;let T=0,E=0,S=0,R=0;if(B){let t=ft.readUEV(h,dt);dt+=t.bitLength,T=t.value;let e=ft.readUEV(h,dt);dt+=e.bitLength,E=e.value;let n=ft.readUEV(h,dt);dt+=n.bitLength,S=n.value;let r=ft.readUEV(h,dt);dt+=r.bitLength,R=r.value}let L=ft.readBit(h,dt);if(dt+=1,L){let t=ft.readBit(h,dt);if(dt+=1,t){const t=ft.readByte(h,dt);switch(dt+=8,t){case 1:d=[1,1];break;case 2:d=[12,11];break;case 3:d=[10,11];break;case 4:d=[16,11];break;case 5:d=[40,33];break;case 6:d=[24,11];break;case 7:d=[20,11];break;case 8:d=[32,11];break;case 9:d=[80,33];break;case 10:d=[18,11];break;case 11:d=[15,11];break;case 12:d=[64,33];break;case 13:d=[160,99];break;case 14:d=[4,3];break;case 15:d=[3,2];break;case 16:d=[2,1];break;case 255:{let t=ft.readByte(h,dt);dt+=8;let e=ft.readByte(h,dt);dt+=8;let n=ft.readByte(h,dt);dt+=8;let r=ft.readByte(h,dt);dt+=8,d=[t<<8|e,n<<8|r];break}}d&&(p=d[0]/d[1]),255===t&&(dt+=16,dt+=16)}let e=ft.readBit(h,dt);dt+=1,e&&(dt+=1);let n=ft.readBit(h,dt);if(dt+=1,n){a=ft.readBit(h,dt,3),dt+=3,dt+=1;let t=ft.readBit(h,dt);dt+=1,t&&(dt+=24)}let r=ft.readBit(h,dt);if(dt+=1,r){let t=ft.readUEV(h,dt);dt+=t.bitLength;let e=ft.readUEV(h,dt);dt+=e.bitLength}let i=ft.readBit(h,dt);dt+=1,i&&(o=ft.readBit(h,dt,32),dt+=32,s=ft.readBit(h,dt,32),dt+=32,v=!!ft.readBit(h,dt),dt+=1,y=s/(2*o))}return{payload:h,profile_idc:u,profile_compatibility:l,level_idc:c,sps_id:g.value,log2_max_frame_num_minus4:b.value,pic_order_cnt_type:k,log2_max_pic_order_cnt_lsb_minus4:e?e.value:0,width:Math.ceil((16*(w.value+1)-2*T-2*E)*p),height:(2-_)*(x.value+1)*16-2*S-2*R,pixelRatio:d,video_format:a,fps:y,fixedFPS:v}}(this.data);break;case 8:this.pps=function(t){let e,n,r=0,i=t,a=[],o=0;r+=ft.readUEV(i,r).bitLength,r+=ft.readUEV(i,r).bitLength,r+=1,r+=1;let s=ft.readUEV(i,r);if(r+=s.bitLength,s.value>0){let t=ft.readUEV(i,r);r+=t.bitLength;let u,l=0;switch(t.value){case 0:for(l=0;l<=t.value;l++)u=ft.readUEV(i,r),r+=u.bitLength;break;case 2:for(l=0;l<=t.value;l++)u=ft.readUEV(i,r),r+=u.bitLength,u=ft.readUEV(i,r),r+=u.bitLength;break;case 3:case 4:case 5:r+=1,e=ft.readUEV(i,r),r+=e.bitLength;break;case 6:{n=ft.readUEV(i,r),r+=n.bitLength;let t=Math.ceil(Math.log2(s.value+1));for(o=0;o<=n.value;o++)a.push(ft.readBit(i,r,t)),r+=t}}}return r+=ft.readUEV(i,r).bitLength,r+=ft.readUEV(i,r).bitLength,r+=1,r+=1,r+=ft.readSEV(i,r).bitLength,r+=ft.readSEV(i,r).bitLength,r+=ft.readSEV(i,r).bitLength,r+=1,r+=1,r+=1,{sliceGroupNum:s.value+1}}(this.data);break;case 6:this.sei=(this.data,{});break;case 9:this.primary_pic_type=this.data[0]>>5}}}class vt extends b{constructor(){super(),this.cachedBytes=null}push(t){let e,n=this,r=0,i=0,a=0,{pts:o,dts:s,payload:u,naluSizeLength:l}=t;if(this.cachedBytes){try{e=new Uint8Array(this.cachedBytes.byteLength+u.byteLength)}catch(t){throw`h264 alloc mem error ${this.cachedBytes.byteLength}/${u.byteLength}`}e.set(this.cachedBytes),e.set(u,this.cachedBytes.byteLength)}else e=u;if(l){let t=0,r=0,i=0;do{r=0;for(let n=0;n<l;n++)r|=e[t+n]<<8*(l-n-1);t+=l,i=t+r,i>e.length&&(i=e.length);let a=e.subarray(t,i),u=new yt(a);u.pts=o,u.dts=s,n.emit("nalu",u),t=i}while(t<e.length)}else{let t=e.byteLength-1,u=0;do{if(0!==e[t])break;u++,t--}while(t>0);u>=3&&(e=e.subarray(0,t+1));do{let t=e[r]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3],l=e.length-r>=4?t:-1,c=0,h=r===e.length-1;if(l>>8==1?c=3:1===l&&(c=4),3===c||4===c||h){let t=i+a,l=h&&u>=3;if(r>i&&(!h||l)){let a=e.subarray(t,l?r+1:r),u=new yt(a);u.pts=o,u.dts=s,n.emit("nalu",u),i=r}h&&(u<3?(this.cachedBytes=e.subarray(i),this.cachedBytes.pts=o,this.cachedBytes.dts=s,this.cachedBytes.startCodeLength=a):this.cachedBytes=null),r===i&&(a=c),r+=c||1}else r++}while(r<e.length)}if(this.cachedBytes){let t=new yt(this.cachedBytes.subarray(this.cachedBytes.startCodeLength));t.pts=this.cachedBytes.pts,t.dts=this.cachedBytes.dts,this.emit("nalu",t),this.cachedBytes=null}this.emit("done")}reset(){this.cachedBytes=null}}class gt extends H{constructor(t){super(),this.PSI=t,this.trackId=null,this.currentFrame=[],this.codec=new vt,this._newGop(),this._newGops(),this.codec.on("nalu",t=>{if(7===t.unit_type){let e=this.PSI.findTrack(this.trackId),n=(t=>{let e="avc1.",n=[t.profile_idc,t.profile_compatibility,t.level_idc];for(let t=0;t<n.length;t++){let r=n[t].toString(16);r.length<2&&(r="0"+r),e+=r}return{codec:e}})(t.sps);e.codec=n.codec,e.width=t.sps.width,e.height=t.sps.height,e.profileIdc=t.sps.profile_idc,e.profileCompatibility=t.sps.profile_compatibility,e.levelIdc=t.sps.level_idc,e.pixelRatio=t.sps.pixelRatio,e.sps=[t.rawData]}else if(8===t.unit_type){this.PSI.findTrack(this.trackId).pps=[t.rawData]}this._grouping(t)})}push(t){const{stream_type:e,pes:n,pid:r}=t;if(27===e||36===e){this.trackId=r;let t={pts:n.PTS,dts:n.DTS,payload:n.data_byte};this.codec.push(t)}}flush(){this.currentFrame.length>0&&((!this.currentFrame.duration||this.currentFrame.duration<=0)&&(this.currentFrame.duration=this.prevFrame.duration||0),this._pushFrameIntoGop(),this.currentFrame=[]),this.gop.length>0&&this._pushGopIntoGroup()}reset(){this.codec.reset(),this.currentFrame=[],this._newGop(),this._newGops()}_grouping(t){9===t.unit_type?(this.currentFrame.length>0&&(this.currentFrame.duration=t.dts-this.currentFrame.dts,this.gop.length>0&&this.currentFrame.keyframe&&(this.gop.trackId=this.trackId,this._pushGopIntoGroup()),this.currentFrame.keyframe||this.gop.length>0?this._pushFrameIntoGop():N.warn("h264 codec drop frame")),this.prevFrame=this.currentFrame,this.currentFrame=[],this.currentFrame.keyframe=!1,this.currentFrame.byteLength=0,this.currentFrame.naluCount=0,this.currentFrame.pts=t.pts,this.currentFrame.dts=t.dts):(5===t.unit_type&&(this.currentFrame.keyframe=!0),this.currentFrame.byteLength+=t.rawData.byteLength,this.currentFrame.naluCount++,this.currentFrame.push(t)),this.currentFrame.duration=t.dts-this.currentFrame.dts}_newGop(){this.gop=[],this.gop.duration=0,this.gop.naluCount=0,this.gop.byteLength=0}_pushFrameIntoGop(){this.gop.push(this.currentFrame),this.gop.duration+=this.currentFrame.duration,this.gop.byteLength+=this.currentFrame.byteLength,this.gop.naluCount+=this.currentFrame.naluCount}_newGops(){this.gops=[],this.gops.type="video",this.gops.duration=0,this.gops.naluCount=0,this.gops.byteLength=0,this.gops.frameLength=0,this.gops.firstDTS=0}_pushGopIntoGroup(){let t=this.gop[0];this.gops.trackId=this.trackId,this.gops.duration+=this.gop.duration,this.gops.byteLength+=this.gop.byteLength,this.gops.naluCount+=this.gop.naluCount,this.gops.frameLength+=this.gop.length,this.gops.firstDTS=t.dts,this.gops.firstPTS=t.pts,this.gops.push(this.gop),this.emit("data",this.gops),this._newGop(),this._newGops(),this.emit("done")}}class mt extends H{constructor(t,e,n={}){super(),this.context=t,this.PSI=e,this.options=n,this.tracks=[],this.adtsStream=new lt(e),this.avcStream=new gt(e),this.streams=[this.adtsStream,this.avcStream],n.decodeCodec&&(this.avcStream.on("data",t=>{let e=n.config.stubTime;if(R(e)){let n=(t.firstPTS+t.duration)/9e4;if(n<e)return void N.warn(`drop avc gop, start/end/stubTime(${t.firstPTS}/${n}/${e})`)}this.tracks.push(t),this.emit("data",this.tracks),this.tracks=[],this.adtsStream.flush()}),this.adtsStream.on("data",t=>{let e=n.config.stubTime;if(R(e)){let n=(t.firstPTS+t.duration)/9e4;if(n<e)return void N.warn(`drop adts, start/end/stubTime(${t.firstPTS}/${n}/${e})`)}this.tracks.push(t),this.emit("data",this.tracks),this.tracks=[]}))}push(t){const{options:e,adtsStream:n,avcStream:r}=this;let{stream_type:i}=t;if(e.decodeCodec)switch(i){case 27:case 36:r.push(t);break;case 15:n.push(t);break;default:N.warn("ts elementary encounter unknown stream type "+i)}else this.emit("data",t)}flush(){let{streams:t,tracks:e}=this;for(let e=0;e<this.streams.length;e++){t[e].flush()}e.length>0&&this.emit("data",e),this.emit("done"),e.splice(0,e.length)}reset(){this.tracks=[];for(let t=0;t<this.streams.length;t++){this.streams[t].reset()}this.emit("reset")}}class bt extends z{constructor(t){super(),this.start_code_prefix=this.readUint16(t,0)<<8|t[2],this.stream_id=t[3],this.packet_length=this.readUint16(t,4),this.data_alignment_indicator=4&t[6],this.copyright=2&t[6],this.PTS_DTS_flags=t[7]>>6,this.ESCR_flag=32&t[7],this.ES_rate_flag=16&t[7],this.trick_mode_flag=8&t[7],this.additional_copy_info_flag=4&t[7],this.CRC_flag=2&t[7],this.extension_flag=1&t[7],this.header_data_length=t[8],this.PTS=0,2==(2&this.PTS_DTS_flags)&&(this.PTS=this.calcTimestamp_(t,9)),this.DTS=this.PTS,1==(1&this.PTS_DTS_flags)&&(this.DTS=this.calcTimestamp_(t,14)),this.data_byte=t.subarray(9+this.header_data_length)}calcTimestamp_(t,e){return 536870912*(14&t[e])+(t[e+1]<<22)+(t[e+2]>>1<<15)+(t[e+3]<<7)+(t[e+4]>>1)}valid(){let t=this.start_code_prefix;return 0===t[0]&&0===t[1]&&1===t[2]}}class kt extends H{constructor(t,e){super(),this.context=t,this.PSI=e,this.PID=null,this.cache_buffer=new D}push(t){const e=this;t.PID>255&&t.PID<8191&&(-1==this.PSI.currentProgramPID?e._pushPacket(t):this.PSI.currentProgramPID!==t.PID&&(1===t.payload_unit_start_indicator&&e._assembleOnePES(),e._pushPacket(t)))}flush(){this._assembleOnePES(),this.emit("done")}reset(){this._clearCached(),this.emit("reset")}_clearCached(){this.PID=null,this.cache_buffer.clear()}_pushPacket(t){let e=this.cache_buffer.empty;e&&0===t.payload_unit_start_indicator||(e&&(this.PID=t.PID),this.cache_buffer.append(t.payload))}_assembleOnePES(){const t=this;if(!this.cache_buffer.empty){let e;try{e=this.cache_buffer.toNewBytes()}catch(t){throw"pes alloc mem err "+this.cache_buffer.byteLength}let n=new bt(e),r=this.PSI.findTrack(this.PID);if(r){let e={pid:r.id,stream_type:r.stream_type,pcr_pid:r.pcr_pid,pes:n};t.emit("data",e)}t._clearCached()}}}class Pt extends z{constructor(t){if(super(),this.sync_byte=t[0],this.transport_error_indicator=t[1]>>7,this.payload_unit_start_indicator=t[1]>>6&1,this.transport_priority=t[1]>>>5&1,this.PID=8191&this.readUint16(t,1),this.tsc=t[3]>>6,this.afc=t[3]>>4&3,this.continuity_counter=15&t[3],this.has_payload=1&this.afc,this.has_adaptation=2&this.afc,this.has_payload)if(this.has_adaptation){let e=t[4];this.payload=t.subarray(5+e)}else this.payload=t.subarray(4)}valid(){return 71===this.sync_byte&&1===this.has_payload}}class wt extends F{constructor(t={}){super(t),this.psi_=new q(this.ctx_),this.pesStream_=new kt(this.ctx_,this.psi_),this.elementaryStream_=new mt(this.ctx_,this.psi_,t),this.complexStream_=new K(this.ctx_,this.psi_),this.pipe(this.pesStream_),this.pesStream_.pipe(this.elementaryStream_),this.elementaryStream_.pipe(this.complexStream_),super.listenEndStream_()}get endStream(){let t=this.elementaryStream_;return this.options_.decodeCodec&&(t=this.complexStream_),t}push(t,e){const{done:n}=e,{options_:r,ctx_:i,cache_buffer_:a,psi_:o}=this;let s=super.constraintPushData_(t),u=a.byteLength,l=null;for(r.config=e,N.log(`hls demux received ${s.byteLength} bytes, cache ${u} bytes. ${n?"chunk done":""}`),a.append(s);a.byteLength>=188;){let t=a.cut(188);if(t){let e=new Pt(t);if(!e.valid()){let n=`Encounter invalid ts packet, packet_length(${t.length}), cache_length(${this.cache_buffer_.byteLength}), has_payload(${e.has_payload}), data(${t})`;N.error(n),this.reset(),i.emit("error",W.TS_SYNC_BYTE,n,{startByte:l,endByte:l+t.byteLength});break}o.parse(e),this.emit("data",e),l+=t.byteLength}}a.empty&&n&&this.emit("done")}reset(){this.cache_buffer_.clear(),this.emit("reset")}}var xt,_t;!function(t){t[t.HEAD=0]="HEAD",t[t.BODY=1]="BODY"}(xt||(xt={})),function(t){t[t.SCRIPT_DATA=18]="SCRIPT_DATA",t[t.VIDEO=9]="VIDEO",t[t.AUDIO=8]="AUDIO"}(_t||(_t={}));var Bt,Tt,Et,St;!function(t){t[t.AAC=10]="AAC"}(Bt||(Bt={})),function(t){t[t.MONO=0]="MONO",t[t.STEREO=1]="STEREO"}(Tt||(Tt={}));!function(t){t[t.SEQUENCE_HEAD=0]="SEQUENCE_HEAD",t[t.AAC_RAW=1]="AAC_RAW"}(Et||(Et={}));!function(t){t[t.SEQUENCE_HEAD=0]="SEQUENCE_HEAD",t[t.NALU=1]="NALU",t[t.SEQUENCE_END=2]="SEQUENCE_END"}(St||(St={}));const Rt=new vt,Lt=[];Rt.on("nalu",t=>{Lt.push(t)});var Dt;!function(t){t[t.AVC=7]="AVC"}(Dt||(Dt={}));var Ct=function(){function t(e){a()(this,t),d()(this,"previousPes",null),d()(this,"maxAudioPTS",0),d()(this,"maxVideoPTS",0),e?(this.init(),this.dataArray=[],this.videoArray=[],this.audioArray=[],this.decode=e):console.error("class TsDemux need pass decode parmas")}return s()(t,[{key:"init",value:function(){var t=this;try{this.demuxer=new wt({enableWorker:!1,debug:!1,onlyDemuxElementary:!0}),this.demuxer.on(r.DEMUX_DATA,(function(e){e instanceof Array?(t.dataArray.push(e),t.demuxed(t.dataArray),t.dataArray=[]):t.dataArray.push(e)})),this.demuxer.on(r.DONE,(function(e){var n={};t.demuxed(t.dataArray),t.dataArray=[],t.previousPes.partEnd=!0,t.previousPes.lastTS=t.isLast,t.isLast?(t.maxPTS=Math.min(t.maxAudioPTS,t.maxVideoPTS),n.audioEnd=!0,t.audioQueue(n),self.postMessage({type:"demuxedAAC",data:t.audioArray}),t.audioArray=[],self.postMessage({type:"maxPTS",data:{maxAudioPTS:t.maxAudioPTS,maxVideoPTS:t.maxVideoPTS}})):(self.postMessage({type:"demuxedAAC",data:t.audioArray}),t.audioArray=[]),t.decode.push(t.videoArray),t.videoArray=[],t.previousPes=null}))}catch(t){console.error("init demuxer failed.")}}},{key:"push",value:function(t){this.demuxer.push(t,{done:!0})}},{key:"demuxed",value:function(t){var e=this;t.forEach((function(t){e.tsDemuxed(t)}))}},{key:"tsDemuxed",value:function(t){var e=t.stream_type,n=t.pes||{};switch(e){case 36:this.videoQueue(n);break;case 3:case 15:case 17:n.PTS=Math.round(n.PTS*u.a*1e3),this.maxAudioPTS=Math.max(n.PTS,this.maxAudioPTS),this.audioQueue(n)}}},{key:"audioQueue",value:function(t){this.audioArray.push(t)}},{key:"videoQueue",value:function(t){this.previousPes=t,this.maxVideoPTS=Math.max(this.maxVideoPTS,t.PTS),this.videoArray.push(t)}},{key:"destroy",value:function(){this.demuxer.destroy()}}]),t}();self.decode=new h,self.demuxer=new Ct(self.decode);e.default=function(t){t.onmessage=function(e){var n=e.data,r=n.type,i=n.data,a=n.isLast;switch(r){case"startDemux":t.demuxer.isLast=a,t.demuxer.push(i);break;case"loadwasm":t.decode.loadWASM(e);break;case"flush":t.decode.flush()}}}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){t.exports=n(163)},function(t,e,n){t.exports=n(86).default}])}));